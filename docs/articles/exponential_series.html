<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Masked Data Likelihood Model: Components with Exponentially Distributed Lifetimes Arranged In Series Configuration â€¢ likelihood.model.series.md</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Masked Data Likelihood Model: Components with Exponentially Distributed Lifetimes Arranged In Series Configuration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">likelihood.model.series.md</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/exponential_series.html">Masked Data Likelihood Model: Components with Exponentially Distributed Lifetimes Arranged In Series Configuration</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Masked Data Likelihood Model: Components with Exponentially Distributed Lifetimes Arranged In Series Configuration</h1>
            
      

      <div class="d-none name"><code>exponential_series.Rmd</code></div>
    </div>

    
    
<p>The R package <code>likelihood.md.series.system</code> is a framework
for estimating the parameters of latent component lifetimes from
<em>masked data</em> in a series system.</p>
<div class="section level2">
<h2 id="expo">Exponentially Distributed Component Lifetimes<a class="anchor" aria-label="anchor" href="#expo"></a>
</h2>
<p>Consider a series system in which the components have exponentially
distributed lifetimes. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
component of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
has a lifetime distribution given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>âˆ¼</mo><mo>EXP</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
    T_{i j} \sim \operatorname{EXP}(\lambda_j)
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">j=1,\ldots,m</annotation></semantics></math>.
Thus,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi><mo>=</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>Î»</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î»</mi><mi>m</mi></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\lambda = \bigl(\lambda_1,\ldots,\lambda_m\bigr)</annotation></semantics></math>.
The random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">T_{i j}</annotation></semantics></math>
has a reliability, pdf, and hazard function given respectively by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><msub><mi>Î»</mi><mi>j</mi></msub><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><msub><mi>Î»</mi><mi>j</mi></msub><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>â‹…</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>Î»</mi><mi>j</mi></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    \label{eq:expo_reliability}
    R_j(t|\lambda_j)   &amp;= \exp(-\lambda_j t),\\
    \label{eq:expo_pdf}
    f_j(t|\lambda_j)   &amp;= \lambda_j \exp(-\lambda_j t),\\
    \label{eq:expo_haz}
    h_j(\cdot|\lambda_j) &amp;= \lambda_j
\end{align}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>
is the lifetime and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mi>j</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda_j &gt; 0</annotation></semantics></math>
is the failure rate of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
component.</p>
The lifetime of the series system composed of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components with exponentially distributed lifetimes has a reliability
function given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><msub><mi>t</mi><mi>i</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:sys_expo_reliability_function}
R_{T_i}(t_i|\boldsymbol{\lambda}) = \exp \biggl(-\sum_{j=1}^{m}{\lambda_j} t_i\biggr)
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>.
A series system with exponentially distributed lifetimes is also
exponentially distributed.
<p>The series systemâ€™s failure rate function is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>â‹…</mo><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:expo_sys_failure_rate}
h(\cdot|\boldsymbol{\lambda}) = \sum_{j=1}^{m} \lambda_j
\end{equation}</annotation></semantics></math> whose proof follows from
Theorem .</p>
<p>We see that the failure rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›Œ</mi><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>Î»</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\lambda }= \sum_{j=1}^n \lambda</annotation></semantics></math>
is <em>constant</em>, consistent with the the exponential distribution
being the only continuous distribution that has a constant failure
rate.</p>
The pdf of the series system is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo>exp</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><msub><mi>t</mi><mi>i</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:expo_sys_pdf}
f_{T_i}(t_i|\boldsymbol{\lambda}) = \biggl( \sum_{j=1}^{m} {\lambda_j} \biggr) \exp
    \biggl(-\sum_{j=1}^{m}{\lambda_j} t_i\biggr)
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t_i &gt; 0</annotation></semantics></math>
is the lifetime of the system.
The conditional probability that component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is the cause of a system failure at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><msub><mi>K</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><msub><mi>K</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msub><mi>Î»</mi><mi>k</mi></msub><mrow><munderover><mo>âˆ‘</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:expo_prob_K_given_S}
f_{K_i|T_i}(k|t,\boldsymbol{\lambda}) = f_{K_i}(k|\boldsymbol{\lambda}) =
    \frac{\lambda_k}{\sum_{p=1}^{m} \lambda_p}
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">k \in \{1,\ldots,m\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>.
Due to the constant failure rates of the components,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
are mutually independent. The joint pdf of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><msub><mi>K</mi><mi>i</mi></msub><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î»</mi><mi>k</mi></msub><mo>exp</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><mi>t</mi><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:expo_joint_k_s}
f_{K_i,T_i}(k,t|\boldsymbol{\lambda}) = \lambda_k \exp \biggl(-\sum_{j=1}^{m}{\lambda_j} t\biggr)
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">k \in \{1,\ldots,m\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>.
</div>
<div class="section level2">
<h2 id="likelihood-model">Likelihood Model<a class="anchor" aria-label="anchor" href="#likelihood-model"></a>
</h2>
<p>In this study, the system is a series system with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components. The true DGP for the system lifetime is in the exponential
series system family, i.e., the component lifetimes are exponentially
and independently distributed and we denote the true parameter value by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p>The principle object of study is $, which in the case of the
exponential series system family consists of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
rate (scale) parameters for each component lifetime,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›Œ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î»</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î»</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\lambda }= (\lambda_1, \ldots, \lambda_m)'</annotation></semantics></math>.</p>
<p>We are interested in estimating the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
from masked data. The masking comes in two independent forms:</p>
<ul>
<li><p>Censored system failure times, e.g., right-censoring. The system
failure time is the minimum of the component lifetimes, and it is
right-censored if the system failure time does not occur during the
observation period,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mo>min</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Ï„</mi><mi>i</mi></msub><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
  T_i = \min\{\tau_i, T_{i 1}, \ldots, T_{i m}\},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ï„</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math>
is the right-censoring time for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
observation and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{i 1},\ldots,T_{i m}</annotation></semantics></math>
are the component lifetimes for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
system.</p></li>
<li><p>The cause of failure, the failed component, is masked. This
masking comes in the form of a candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ’</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{C}_i</annotation></semantics></math>
that, on average, conveys information about the component cause of
failure.</p></li>
</ul>
<p>The candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ’</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{C}_i</annotation></semantics></math>
is a random variable that is a subset of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1,\ldots,m\}</annotation></semantics></math>.
The true DGP for the candidate set model has a general form that may be
denoted by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><mi>j</mi><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>T</mi><mi>m</mi></msub><mo>,</mo><mi>Î¸</mi><mo>,</mo><mtext mathvariant="normal">other factors</mtext><mo stretchy="false" form="postfix">}</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
    \Pr\{\mathcal{C}_i=c_i|T_1=j,\ldots,T_m,\theta,\text{other factors}\}.
</annotation></semantics></math></p>
<p>This is a pretty complicated looking model, and we are not even
interested in the DGP for candidate sets, except to the extent that it
affects the sampling distribution of the MLE for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p>In theory, given some candidate set model, we could construct a joint
likelihood function for the full model and jointly estimate the
parameters of both the candidate set model and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
In practice, however, this could be a very challenging task unless we
make some simplifying assumptions about the DGP for candidate sets.</p>
<div class="section level3">
<h3 id="candidate-set-models">Candidate set models<a class="anchor" aria-label="anchor" href="#candidate-set-models"></a>
</h3>
<p>In every model we consider, we assume that the candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ’</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{C}_i</annotation></semantics></math>
is only a function of the component lifetimes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{i 1},\ldots,T_{i m}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
and the right-censoring time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ï„</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math>.
That is, the candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ’</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{C}_i</annotation></semantics></math>
is independent of any other factors (or held constant for the duration
of the experiment), like ambient temperature, and these factors also
have a neglible effect on the series system lifetime and thus we can
ignore them.</p>
<div class="section level4">
<h4 id="reduced-likelihood-model">Reduced likelihood model<a class="anchor" aria-label="anchor" href="#reduced-likelihood-model"></a>
</h4>
<p>In the Bernoulli candidate set model, we make the following
assumptions about how candidate sets are generated:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>:
The index of the failed component is in the candidate set, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>K</mi><mi>i</mi></msub><mo>âˆˆ</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\Pr\{K_i \in \mathcal{C}_i\} = 1</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mo>arg</mo><msub><mo>min</mo><mi>j</mi></msub><mo stretchy="false" form="prefix">{</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>:</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">K_i = \arg\min_j \{ T_{i j} : j = 1,\ldots,m\}</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>:
The probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
is equally probable when the failed component varies over the components
in the candidate set, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>Î¸</mi><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mi>â€²</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Pr\{\mathcal{C}_i=c_i|K_i=j,T_i=t_i,\theta\} = \Pr\{C_i=c_i|K_i=j',T_i=t_i\}</annotation></semantics></math>
for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>,</mo><mi>j</mi><mi>â€²</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">j,j' \in c_i</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>:
The masking probabilities are conditionally independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>,
i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Pr\{\mathcal{C}_i=c_i|K_i=j,T_i=t_i\}</annotation></semantics></math>
is not a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p></li>
</ul>
<p>Using these simplifying assumptions, we can arrive at a reduced
likelihood function that only depends on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
and the observed data and as long as our candidate set satisfies
conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>,
our reduced likelihood function obtains the same MLEs as the full
likelihood function.</p>
<p>We see that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
    \Pr\{\mathcal{C}_i=c_i,|K_i=j,T_i=t_i\} = g(c_i,t_i),
</annotation></semantics></math> since the probability cannot depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
by condition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>
and cannot depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
by condition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>.
Thus, we can write the likelihood function as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>f</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
    L(\theta) = \prod_{i=1}^n f_{T_i}(t_i|\theta) g(c_i,t_i).
</annotation></semantics></math></p>
<p>We show that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(c_i,t_i)</annotation></semantics></math>
is proportional to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Î¸</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>âˆ</mo><mrow><mi>l</mi><mo>=</mo><mi>j</mi><mo>,</mo><mi>l</mi><mo>â‰ </mo><mi>j</mi></mrow><mi>m</mi></munderover><msub><mi>R</mi><mi>l</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Î¸</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
    g(c_i,t_i) \propto \sum_{j \in c_i} f_j(t_i|\theta_j) \prod_{l=j,l \neq j}^m R_l(t_i|\theta_l),
</annotation></semantics></math> and thus</p>
<p>Note, however, that different ways in which the conditions are met
will yield MLEs with different sampling distributions, e.g., more or
less efficient estimators.</p>
</div>
<div class="section level4">
<h4 id="bernoulli-candidate-set-model-1">Bernoulli candidate set model #1<a class="anchor" aria-label="anchor" href="#bernoulli-candidate-set-model-1"></a>
</h4>
<p>This is a special case of the reduced likelihood model. In this
model, we satisfy conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>,
but we include each of the non-failed components with a fixed
probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; p &lt; 1</annotation></semantics></math>.</p>
In the simplest case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">p = 0.5</annotation></semantics></math>,
and candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_i</annotation></semantics></math>
has a probability given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>âŠ†</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mrow><mi>j</mi><mo>âˆ‰</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></mrow><mi>.</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\Pr\{\mathcal{C}_i=c_i|K_i=j,T_i=t_i\} =
\begin{cases}
        (1/2)^{m-1} &amp; \text{if $j \in c_i$ and $c_i \subseteq \{1,\ldots,m\}$} \\
        0 &amp; \text{if $j \notin c_i$}.
\end{cases}
</annotation></semantics></math>
</div>
<div class="section level4">
<h4 id="bernoulli-candidate-set-model-2">Bernoulli candidate set model #2<a class="anchor" aria-label="anchor" href="#bernoulli-candidate-set-model-2"></a>
</h4>
<p>Now, we remove condition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>.
We still assume conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>,
but we allow
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
to depend on the failed component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>,
i.e.,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>Î¸</mi><mo stretchy="false" form="postfix">}</mo><mo>â‰ </mo><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mi>â€²</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">
    \Pr\{\mathcal{C}_i=c_i|K_i=j,T_i=t_i,\theta\} \neq \Pr\{C_i=c_i|K_i=j',T_i=t_i\}
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>,</mo><mi>j</mi><mi>â€²</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">j,j' \in c_i</annotation></semantics></math>.</p>
<p>In this case, we can write the likelihood function as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>f</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mi>Î¸</mi><mo stretchy="false" form="postfix">)</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><munder><mo>âˆ</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>âˆˆ</mo><msub><mi>ğ’</mi><mi>i</mi></msub></mrow></munder><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
    L(\theta) = \prod_{i=1}^n f_{T_i}(t_i|\theta) \prod_{j=1}^m \Pr\{K_i=j|T_i=t_i\} \prod_{c_i \in \mathcal{C}_i} g(c_i,t_i,j).
</annotation></semantics></math></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>The most straightforward series system to estimate is the series
system with exponentially distributed component lifetimes.</p>
<p>Suppose an exponential series system with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components is parameterized by the following R code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,     <span class="co"># component 1 failure rate</span></span>
<span>           <span class="fl">1.1</span>,   <span class="co"># 3</span></span>
<span>           <span class="fl">0.95</span>,  <span class="co"># 5</span></span>
<span>           <span class="fl">1.15</span>,  <span class="co"># 6</span></span>
<span>           <span class="fl">1.1</span><span class="op">)</span>   <span class="co"># 7</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span></code></pre></div>
<p>So, in our study,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1.1</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.15</mn><mo>,</mo><mn>1.1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\theta = (1, 1.1, 0.95, 1.15, 1.1)'</annotation></semantics></math>.
The component assigned to index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
has an exponentially distributed lifetime with a failure rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î¸</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>,
e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¸</mi><mn>2</mn></msub><mo>=</mo><mn>1.1</mn></mrow><annotation encoding="application/x-tex">\theta_2 = 1.1</annotation></semantics></math>
is the failure rate of the component indexed by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>.</p>
<p>Letâ€™s simulate generating the lifetimes of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">m = 5</annotation></semantics></math>
components for this series system:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span> <span class="co"># set seed for reproducibility</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">7500</span></span>
<span><span class="va">comp_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="va">n</span>,ncol<span class="op">=</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="va">comp_times</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">comp_times</span> <span class="op">&lt;-</span> <span class="fu">md_encode_matrix</span><span class="op">(</span><span class="va">comp_times</span>,<span class="st">"t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comp_times</span>,n<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7,500 Ã— 5</span></span></span>
<span><span class="co">#&gt;      t1     t2    t3     t4    t5</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  2.95 1.67   0.777 0.047<span style="text-decoration: underline;">6</span> 0.380</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  1.10 2.20   2.59  3.27   0.626</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  1.20 0.095<span style="text-decoration: underline;">6</span> 3.74  1.80   2.13 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  1.44 0.046<span style="text-decoration: underline;">0</span> 0.123 0.522  0.102</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 7,496 more rows</span></span></span></code></pre></div>
<p>Next, we use the function
<code>md_series_lifetime_right_censoring</code> to decorate the masked
data with the right-censor-censoring time chosen by the probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>T</mi><mi>i</mi></msub><mo>&gt;</mo><mi>Ï„</mi><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mn>0.75</mn></mrow><annotation encoding="application/x-tex">\Pr\{T_i &gt; \tau\} = 0.75</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>,<span class="va">n</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">comp_times</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/md_series_lifetime_right_censoring.html">md_series_lifetime_right_censoring</a></span><span class="op">(</span><span class="va">tau</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span>,n<span class="op">=</span><span class="fl">4</span>,drop_latent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Latent variables:  t1 t2 t3 t4 t5 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7,500 Ã— 2</span></span></span>
<span><span class="co">#&gt;        t delta</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0.047<span style="text-decoration: underline;">6</span> TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 0.262  FALSE</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0.095<span style="text-decoration: underline;">6</span> TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 0.046<span style="text-decoration: underline;">0</span> TRUE </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 7,496 more rows</span></span></span></code></pre></div>
<div class="section level3">
<h3 id="masked-component-cause-of-failure">Masked component cause of failure<a class="anchor" aria-label="anchor" href="#masked-component-cause-of-failure"></a>
</h3>
<p>We simulate candidate sets using the Bernoulli candidate model with
an appropriate set of parameters to satisfy conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">.3</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/md_bernoulli_cand_c1_c2_c3.html">md_bernoulli_cand_c1_c2_c3</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>,<span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">]</span>,n<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; Latent variables:  q1 q2 q3 q4 q5 t1 t2 t3 t4 t5 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7,500 Ã— 5</span></span></span>
<span><span class="co">#&gt;      q1    q2    q3    q4    q5</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   0.3   0.3   0.3   1     0.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>   0     0     0     0     0  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>   0.3   1     0.3   0.3   0.3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   0.3   1     0.3   0.3   0.3</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 7,496 more rows</span></span></span></code></pre></div>
<p>Now, to generate candidate sets, we sample from these
probabilities:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/md_cand_sampler.html">md_cand_sampler</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">md_boolean_matrix_to_charsets</span><span class="op">(</span><span class="va">data</span>,drop_set<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,drop_latent<span class="op">=</span><span class="cn">TRUE</span>,n<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; Latent variables:  q1 q2 q3 q4 q5 t1 t2 t3 t4 t5 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7,500 Ã— 3</span></span></span>
<span><span class="co">#&gt;        t delta x        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 0.047<span style="text-decoration: underline;">6</span> TRUE  {1, 4}   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 0.262  FALSE {}       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 0.095<span style="text-decoration: underline;">6</span> TRUE  {1, 2, 5}</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 0.046<span style="text-decoration: underline;">0</span> TRUE  {1, 2, 4}</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 0.029<span style="text-decoration: underline;">0</span> TRUE  {4}      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 0.160  TRUE  {3, 5}   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 7,494 more rows</span></span></span></code></pre></div>
<p>We see that after dropping latent (unobserved) columns, we only have
the right censoring time, right censoring indicator, and the candidate
sets. (Note that this time we showed the candidate sets in a more
friendly way using <code>md_boolean_matrix_to_charsets</code>.)</p>
</div>
</div>
<div class="section level2">
<h2 id="likelihood-model-1">Likelihood Model<a class="anchor" aria-label="anchor" href="#likelihood-model-1"></a>
</h2>
<p>The likelihood model is a statistical model that describes the
distribution of the observed data as a function of the parameters of
interest.</p>
<p>We construct a likelihood model for the masked data model with
exponentially distributed component lifetimes with the following
code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mle">Maximum likelihood estimation<a class="anchor" aria-label="anchor" href="#mle"></a>
</h2>
The log-likelihood for our masked data model when we assume Conditions ,
, and is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î»</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>Î´</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>log</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>Î»</mi><mi>j</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo>âˆ’</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>s</mi><mi>i</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:}
\ell(\lambda) =
    \sum_{i=1}^{n} (1-\delta_i) \log \biggl(\sum_{j \in c_i} \lambda_j \biggr) -
    \biggl( \sum_{i=1}^{n} s_i \biggr)
    \biggl( \sum_{j=1}^{m} \lambda_j \biggr).
\end{equation}</annotation></semantics></math><p>The set of solutions to the MLE equations must be stationary points,
i.e., a point at which the score function of type
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>â„</mi><mi>m</mi></msup><mo>â†¦</mo><msup><mi>â„</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^m \mapsto \mathbb{R}^m</annotation></semantics></math>
is zero. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
component of the output of the score function is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î»</mi><mi>p</mi></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>Î»</mi><mi>j</mi></msub><msup><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msub><mn>1</mn><mrow><mo stretchy="false" form="prefix">{</mo><mi>p</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>Î´</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow></msub><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>s</mi><mi>i</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:score_expo_j}
\frac{\partial \ell}{\partial \lambda_p} = 
  \sum_{i=1}^{n} \biggl( \sum_{j \in c_i} \lambda_j \biggr)^{-1}
  1_{\{p \in c_i \text{ and } \delta_i = 0\}} - \sum_{i=1}^{n} s_i.
\end{equation}</annotation></semantics></math></p>
<p>We may find an MLE by solving the maximum likelihood equation , i.e.,
a set of (stationary) points satisfying
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î»</mi><mi>j</mi></msub></mrow></mfrac><msub><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">|</mo><msub><mover><mi>Î»</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi></msub></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
\frac{\partial \ell}{\partial \lambda_j}\Biggr|_{\hat\lambda_j} = 0
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">j=1,\ldots,m</annotation></semantics></math>.
We approximate a solution to this problem by using the iterative
Newton-Raphson method as described in Section .</p>
<p>The Newton-Raphson method needs the observed information matrix,
which is a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î»</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
of type
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>â„</mi><mi>m</mi></msup><mo>â†¦</mo><msup><mi>â„</mi><mrow><mi>m</mi><mo>Ã—</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^m \mapsto \mathbb{R}^{m \times m}</annotation></semantics></math>.
The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(j,k)</annotation></semantics></math>-th
element of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î»</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">J(\lambda)</annotation></semantics></math>
is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î»</mi><mi>j</mi></msub><mi>âˆ‚</mi><msub><mi>Î»</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>Î»</mi><mi>j</mi></msub><msup><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mrow><mo>âˆ’</mo><mn>2</mn></mrow></msup><msub><mn>1</mn><mrow><mo stretchy="false" form="prefix">{</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>Î´</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:info_expo}
\frac{\partial^2 \ell}{\partial \lambda_j \partial \lambda_k} = 
  \sum_{i=1}^{n} \biggl( \sum_{j \in c_i} \lambda_j \biggr)^{-2}
  1_{\{j,k \in c_i \text{ and } \delta_i = 0\}}.
\end{equation}</annotation></semantics></math></p>
<div class="section level3">
<h3 id="log-likelihood-of-theta-given-masked-data">Log-likelihood of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
given masked data<a class="anchor" aria-label="anchor" href="#log-likelihood-of-theta-given-masked-data"></a>
</h3>
<p>The reduced log-likelihood function (the log of the kernel of the
likelihood function) is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>âˆ’</mo><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î¸</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>Î´</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>Î¸</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell(\theta|\text{data}) =
    -\left(\sum_{i=1}^{n} t_i\right)
    \left(\sum_{j=1}^{m} \theta_j\right) +
    \sum_{i=1}^{n} (1-\delta_i)\log\left(\sum_{j \in c_i} \theta_j\right).
</annotation></semantics></math></p>
<p>We compute the log-likelihood function using generic dispatch:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>The returned function <code>ll(df, par)</code> evaluates the
log-likelihood at parameter <code>par</code> given data <code>df</code>.
For example, at the true parameter value:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ll</span><span class="op">(</span><span class="va">data</span>, <span class="va">theta</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1485</span></span></code></pre></div>
<p>Note that the implementation uses minimally sufficient statistics,
which improves computational efficiency.</p>
<p>The log-likelihood function contains the maximum amount of
information about parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
given the sample of masked data <code>data</code> satisfying conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>.</p>
<p>Suppose we do not know that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1.1</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.15</mn><mo>,</mo><mn>1.1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\theta = (1, 1.1, 0.95, 1.15, 1.1)'</annotation></semantics></math>.
With the log-likelihood, we may estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat\theta</annotation></semantics></math>
by solving
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><msub><mo>argmax</mo><mrow><mi>Î¸</mi><mo>âˆˆ</mo><mi>Î©</mi></mrow></msub><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\hat{\theta} = \operatorname{argmax}_{\theta \in \Omega} \ell(\theta),
</annotation></semantics></math> i.e., finding the point that
<em>maximizes</em> the log-likelihood on the observed sample
<code>data</code>. This is known as <em>maximum likelihood
estimation</em> (MLE). We typically solve for the MLE by solving
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>âˆ‡</mi><mo>â„“</mo><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>Î¸</mi><mo>=</mo><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover></mrow></msub><mo>=</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
\nabla \ell|_{\theta=\hat{\theta}} = 0.
</annotation></semantics></math></p>
<p>A popular choice is gradient ascent, which is an iterative method
based on the update rule
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î¸</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mi>Î¸</mi><mi>n</mi></msup><mo>+</mo><mi>Î·</mi><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Î¸</mi><mi>n</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\theta^{(n+1)} = \theta^n + \eta \ell(\theta^n),
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î·</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
is the learning rate.</p>
<p>We can also obtain the score (gradient) function via generic
dispatch:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/score.html" class="external-link">score</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>The score at the true parameter should be close to zero (at the MLE,
it is exactly zero):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">grad</span><span class="op">(</span><span class="va">data</span>, <span class="va">theta</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -28.488  12.506  -9.824 -24.504 -12.322</span></span></code></pre></div>
<p>The <code>likelihood.model</code> framework provides analytical score
and Hessian implementations when available, falling back to numerical
differentiation otherwise.</p>
<p>In what follows, we use <a href="https://github.com/queelius/algebraic.mle" class="external-link">algebraic.mle</a> to
help solve the MLE equations and display various properties of the
solution.</p>
<p>To solve the MLE equation, we use the generic <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code>
function, which dispatches to <code>fit.likelihood_model</code> for any
object with <code>"likelihood_model"</code> in its class. The
<code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> function returns a solver that uses
<code>optim</code> internally with the BFGS method by default.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the solver from the model using generic dispatch</span></span>
<span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Solve for MLE with initial guess</span></span>
<span><span class="va">theta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">data</span>, par <span class="op">=</span> <span class="va">theta0</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span></code></pre></div>
<p>The result is an <code>mle</code> object from the
<code>algebraic.mle</code> package with rich accessor methods:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print summary with confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum likelihood estimator of type mle_likelihood_model is normally distributed.</span></span>
<span><span class="co">#&gt; The estimates of the parameters are given by:</span></span>
<span><span class="co">#&gt; [1] 0.9545 1.1430 0.9440 1.1085 1.0881</span></span>
<span><span class="co">#&gt; The standard error is  0.04314 0.04496 0.04247 0.04481 0.04465 .</span></span>
<span><span class="co">#&gt; The asymptotic 95% confidence interval of the parameters are given by:</span></span>
<span><span class="co">#&gt;          2.5% 97.5%</span></span>
<span><span class="co">#&gt; param1 0.8700 1.039</span></span>
<span><span class="co">#&gt; param2 1.0549 1.231</span></span>
<span><span class="co">#&gt; param3 0.8607 1.027</span></span>
<span><span class="co">#&gt; param4 1.0207 1.196</span></span>
<span><span class="co">#&gt; param5 1.0005 1.176</span></span>
<span><span class="co">#&gt; The MSE of the individual components in a multivariate estimator is:</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]       [,4]       [,5]</span></span>
<span><span class="co">#&gt; [1,]  0.0018608 -0.0002202 -0.0002258 -0.0002585 -0.0002654</span></span>
<span><span class="co">#&gt; [2,] -0.0002202  0.0020211 -0.0002331 -0.0002648 -0.0002360</span></span>
<span><span class="co">#&gt; [3,] -0.0002258 -0.0002331  0.0018034 -0.0002185 -0.0002453</span></span>
<span><span class="co">#&gt; [4,] -0.0002585 -0.0002648 -0.0002185  0.0020078 -0.0002316</span></span>
<span><span class="co">#&gt; [5,] -0.0002654 -0.0002360 -0.0002453 -0.0002316  0.0019936</span></span>
<span><span class="co">#&gt; The log-likelihood is  -1483 .</span></span>
<span><span class="co">#&gt; The AIC is  2976 .</span></span></code></pre></div>
<p>We can access specific components of the MLE:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Point estimate</span></span>
<span><span class="va">theta.hat</span> <span class="op">&lt;-</span> <span class="va">estimate</span><span class="op">$</span><span class="va">theta.hat</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"MLE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">theta.hat</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; MLE: 0.9545 1.143 0.944 1.109 1.088</span></span>
<span></span>
<span><span class="co"># Standard errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"SE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">sigma</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; SE: 0.0019 -2e-04 -2e-04 -3e-04 -3e-04 -2e-04 0.002 -2e-04 -3e-04 -2e-04 -2e-04 -2e-04 0.0018 -2e-04 -2e-04 -3e-04 -3e-04 -2e-04 0.002 -2e-04 -3e-04 -2e-04 -2e-04 -2e-04 0.002</span></span>
<span></span>
<span><span class="co"># Log-likelihood at MLE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Log-likelihood:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">loglike</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Log-likelihood: -1483</span></span></code></pre></div>
<p>Recall that the true parameter is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1.1</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.15</mn><mo>,</mo><mn>1.1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\theta = (1, 1.1, 0.95, 1.15, 1.1)'</annotation></semantics></math>.</p>
<p>Due to sampling variability, different runs of the experiment will
result in different outcomes, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>
has a sampling distribution. We see that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mo>â‰ </mo><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\hat{\theta} \neq \theta</annotation></semantics></math>,
but it is reasonably close. We may measure this sampling variability
using the variance-covariance matrix, bias, mean squared error (MSE),
and confidence intervals.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
