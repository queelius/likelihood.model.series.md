<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Masked Data Likelihood Model: Components with Exponentially Distributed Lifetimes Arranged In Series Configuration â€¢ likelihood.model.series.md</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Masked Data Likelihood Model: Components with Exponentially Distributed Lifetimes Arranged In Series Configuration">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">likelihood.model.series.md</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/queelius/likelihood.model.series.md/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Masked Data Likelihood Model: Components with Exponentially Distributed Lifetimes Arranged In Series Configuration</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/likelihood.model.series.md/blob/HEAD/vignettes/exponential_series.Rmd" class="external-link"><code>vignettes/exponential_series.Rmd</code></a></small>
      <div class="d-none name"><code>exponential_series.Rmd</code></div>
    </div>

    
    
<p>The R package <code>likelihood.model.series.md</code> is a framework
for estimating the parameters of latent component lifetimes from
<em>masked data</em> in a series system.</p>
<div class="section level2">
<h2 id="expo">Exponentially Distributed Component Lifetimes<a class="anchor" aria-label="anchor" href="#expo"></a>
</h2>
<p>Consider a series system in which the components have exponentially
distributed lifetimes. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
component of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
has a lifetime distribution given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>âˆ¼</mo><mo>EXP</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
    T_{i j} \sim \operatorname{EXP}(\lambda_j)
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">j=1,\ldots,m</annotation></semantics></math>.
Thus,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î»</mi><mo>=</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msub><mi>Î»</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î»</mi><mi>m</mi></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\lambda = \bigl(\lambda_1,\ldots,\lambda_m\bigr)</annotation></semantics></math>.
The random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">T_{i j}</annotation></semantics></math>
has a reliability, pdf, and hazard function given respectively by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><msub><mi>Î»</mi><mi>j</mi></msub><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>âˆ’</mo><msub><mi>Î»</mi><mi>j</mi></msub><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo>â‹…</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>Î»</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>Î»</mi><mi>j</mi></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    \label{eq:expo_reliability}
    R_j(t|\lambda_j)   &amp;= \exp(-\lambda_j t),\\
    \label{eq:expo_pdf}
    f_j(t|\lambda_j)   &amp;= \lambda_j \exp(-\lambda_j t),\\
    \label{eq:expo_haz}
    h_j(\cdot|\lambda_j) &amp;= \lambda_j
\end{align}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>
is the lifetime and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mi>j</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\lambda_j &gt; 0</annotation></semantics></math>
is the failure rate of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
component.</p>
The lifetime of the series system composed of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components with exponentially distributed lifetimes has a reliability
function given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><msub><mi>t</mi><mi>i</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:sys_expo_reliability_function}
R_{T_i}(t_i|\boldsymbol{\lambda}) = \exp \biggl(-\sum_{j=1}^{m}{\lambda_j} t_i\biggr)
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>.
A series system with exponentially distributed lifetimes is also
exponentially distributed.
<p>The series systemâ€™s failure rate function is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>â‹…</mo><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:expo_sys_failure_rate}
h(\cdot|\boldsymbol{\lambda}) = \sum_{j=1}^{m} \lambda_j
\end{equation}</annotation></semantics></math> whose proof follows from
the series system failure rate theorem.</p>
<p>We see that the system failure rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub><mo>=</mo><msubsup><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>Î»</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_{\text{sys}} = \sum_{j=1}^m \lambda_j</annotation></semantics></math>
is <em>constant</em>, consistent with the exponential distribution being
the only continuous distribution that has a constant failure rate.</p>
The pdf of the series system is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo>exp</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><msub><mi>t</mi><mi>i</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:expo_sys_pdf}
f_{T_i}(t_i|\boldsymbol{\lambda}) = \biggl( \sum_{j=1}^{m} {\lambda_j} \biggr) \exp
    \biggl(-\sum_{j=1}^{m}{\lambda_j} t_i\biggr)
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t_i &gt; 0</annotation></semantics></math>
is the lifetime of the system.
The conditional probability that component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is the cause of a system failure at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><msub><mi>K</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>t</mi><mo>,</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>f</mi><msub><mi>K</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msub><mi>Î»</mi><mi>k</mi></msub><mrow><munderover><mo>âˆ‘</mo><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>p</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:expo_prob_K_given_S}
f_{K_i|T_i}(k|t,\boldsymbol{\lambda}) = f_{K_i}(k|\boldsymbol{\lambda}) =
    \frac{\lambda_k}{\sum_{p=1}^{m} \lambda_p}
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">k \in \{1,\ldots,m\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>.
Due to the constant failure rates of the components,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
are mutually independent. The joint pdf of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mrow><msub><mi>K</mi><mi>i</mi></msub><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><mi>t</mi><mo stretchy="false" form="prefix">|</mo><mi>ğ›Œ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>Î»</mi><mi>k</mi></msub><mo>exp</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><mi>t</mi><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:expo_joint_k_s}
f_{K_i,T_i}(k,t|\boldsymbol{\lambda}) = \lambda_k \exp \biggl(-\sum_{j=1}^{m}{\lambda_j} t\biggr)
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">k \in \{1,\ldots,m\}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t &gt; 0</annotation></semantics></math>.
</div>
<div class="section level2">
<h2 id="likelihood-model">Likelihood Model<a class="anchor" aria-label="anchor" href="#likelihood-model"></a>
</h2>
<p>In this study, the system is a series system with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components. The true DGP for the system lifetime is in the exponential
series system family, i.e., the component lifetimes are exponentially
and independently distributed and we denote the true parameter value by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p>The principal object of study is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ›Œ</mi><annotation encoding="application/x-tex">\boldsymbol{\lambda}</annotation></semantics></math>,
which in the case of the exponential series system family consists of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
rate (scale) parameters for each component lifetime,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ›Œ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Î»</mi><mn>1</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>Î»</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\lambda }= (\lambda_1, \ldots, \lambda_m)'</annotation></semantics></math>.</p>
<p>We are interested in estimating the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
from masked data. The masking comes in two independent forms:</p>
<ul>
<li><p>Censored system failure times, e.g., right-censoring. The system
failure time is the minimum of the component lifetimes, and it is
right-censored if the system failure time does not occur during the
observation period,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mo>min</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Ï„</mi><mi>i</mi></msub><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">
  T_i = \min\{\tau_i, T_{i 1}, \ldots, T_{i m}\},
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ï„</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math>
is the right-censoring time for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
observation and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{i 1},\ldots,T_{i m}</annotation></semantics></math>
are the component lifetimes for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>th
system.</p></li>
<li><p>The cause of failure, the failed component, is masked. This
masking comes in the form of a candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ’</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{C}_i</annotation></semantics></math>
that, on average, conveys information about the component cause of
failure.</p></li>
</ul>
<p>The candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ’</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{C}_i</annotation></semantics></math>
is a random variable that is a subset of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1,\ldots,m\}</annotation></semantics></math>.
The true DGP for the candidate set model has a general form that may be
denoted by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>T</mi><mn>1</mn></msub><mo>=</mo><mi>j</mi><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>T</mi><mi>m</mi></msub><mo>,</mo><mi>Î¸</mi><mo>,</mo><mtext mathvariant="normal">other factors</mtext><mo stretchy="false" form="postfix">}</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">
    \Pr\{\mathcal{C}_i=c_i|T_1=j,\ldots,T_m,\theta,\text{other factors}\}.
</annotation></semantics></math></p>
<p>This is a pretty complicated looking model, and we are not even
interested in the DGP for candidate sets, except to the extent that it
affects the sampling distribution of the MLE for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<p>In theory, given some candidate set model, we could construct a joint
likelihood function for the full model and jointly estimate the
parameters of both the candidate set model and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.
In practice, however, this could be a very challenging task unless we
make some simplifying assumptions about the DGP for candidate sets.</p>
<div class="section level3">
<h3 id="candidate-set-models">Candidate set models<a class="anchor" aria-label="anchor" href="#candidate-set-models"></a>
</h3>
<p>In every model we consider, we assume that the candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ’</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{C}_i</annotation></semantics></math>
is only a function of the component lifetimes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{i 1},\ldots,T_{i m}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
and the right-censoring time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Ï„</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math>.
That is, the candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ’</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{C}_i</annotation></semantics></math>
is independent of any other factors (or held constant for the duration
of the experiment), like ambient temperature, and these factors also
have a negligible effect on the series system lifetime and thus we can
ignore them.</p>
<div class="section level4">
<h4 id="reduced-likelihood-model">Reduced likelihood model<a class="anchor" aria-label="anchor" href="#reduced-likelihood-model"></a>
</h4>
<p>In the Bernoulli candidate set model, we make the following
assumptions about how candidate sets are generated:</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>:
The index of the failed component is in the candidate set, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>K</mi><mi>i</mi></msub><mo>âˆˆ</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\Pr\{K_i \in \mathcal{C}_i\} = 1</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mo>arg</mo><msub><mo>min</mo><mi>j</mi></msub><mo stretchy="false" form="prefix">{</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>:</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">K_i = \arg\min_j \{ T_{i j} : j = 1,\ldots,m\}</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>:
The probability of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>
is equally probable when the failed component varies over the components
in the candidate set, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>Î¸</mi><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mi>â€²</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Pr\{\mathcal{C}_i=c_i|K_i=j,T_i=t_i,\theta\} = \Pr\{C_i=c_i|K_i=j',T_i=t_i\}</annotation></semantics></math>
for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>,</mo><mi>j</mi><mi>â€²</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">j,j' \in c_i</annotation></semantics></math>.</p></li>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>:
The masking probabilities are conditionally independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>,
i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\Pr\{\mathcal{C}_i=c_i|K_i=j,T_i=t_i\}</annotation></semantics></math>
is not a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p></li>
</ul>
<p>Using these simplifying assumptions, we can arrive at a reduced
likelihood function that only depends on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
and the observed data and as long as our candidate set satisfies
conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>,
our reduced likelihood function obtains the same MLEs as the full
likelihood function.</p>
<p>We see that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
    \Pr\{\mathcal{C}_i=c_i,|K_i=j,T_i=t_i\} = g(c_i,t_i),
</annotation></semantics></math> since the probability cannot depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
by condition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>
and cannot depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
by condition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>.
Thus, we can write the likelihood function as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>f</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
    L(\theta) = \prod_{i=1}^n f_{T_i}(t_i|\theta) g(c_i,t_i).
</annotation></semantics></math></p>
<p>We show that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g(c_i,t_i)</annotation></semantics></math>
is proportional to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Î¸</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>âˆ</mo><mrow><mi>l</mi><mo>=</mo><mi>j</mi><mo>,</mo><mi>l</mi><mo>â‰ </mo><mi>j</mi></mrow><mi>m</mi></munderover><msub><mi>R</mi><mi>l</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>Î¸</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
    g(c_i,t_i) \propto \sum_{j \in c_i} f_j(t_i|\theta_j) \prod_{l=j,l \neq j}^m R_l(t_i|\theta_l),
</annotation></semantics></math> and thus the reduced likelihood is
proportional to the full likelihood, yielding the same MLEs.</p>
<p>Note, however, that different ways in which the conditions are met
will yield MLEs with different sampling distributions, e.g., more or
less efficient estimators.</p>
</div>
<div class="section level4">
<h4 id="bernoulli-candidate-set-model-1">Bernoulli candidate set model #1<a class="anchor" aria-label="anchor" href="#bernoulli-candidate-set-model-1"></a>
</h4>
<p>This is a special case of the reduced likelihood model. In this
model, we satisfy conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>,
but we include each of the non-failed components with a fixed
probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0 &lt; p &lt; 1</annotation></semantics></math>.</p>
In the simplest case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">p = 0.5</annotation></semantics></math>,
and candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_i</annotation></semantics></math>
has a probability given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow></msup></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>âŠ†</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mrow><mi>j</mi><mo>âˆ‰</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></mrow><mi>.</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\Pr\{\mathcal{C}_i=c_i|K_i=j,T_i=t_i\} =
\begin{cases}
        (1/2)^{m-1} &amp; \text{if $j \in c_i$ and $c_i \subseteq \{1,\ldots,m\}$} \\
        0 &amp; \text{if $j \notin c_i$}.
\end{cases}
</annotation></semantics></math>
</div>
<div class="section level4">
<h4 id="bernoulli-candidate-set-model-2">Bernoulli candidate set model #2<a class="anchor" aria-label="anchor" href="#bernoulli-candidate-set-model-2"></a>
</h4>
<p>Now, we remove condition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>.
We still assume conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>,
but we allow
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
to depend on the failed component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>,
i.e.,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>ğ’</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>Î¸</mi><mo stretchy="false" form="postfix">}</mo><mo>â‰ </mo><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>C</mi><mi>i</mi></msub><mo>=</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mi>â€²</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">
    \Pr\{\mathcal{C}_i=c_i|K_i=j,T_i=t_i,\theta\} \neq \Pr\{C_i=c_i|K_i=j',T_i=t_i\}
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>,</mo><mi>j</mi><mi>â€²</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">j,j' \in c_i</annotation></semantics></math>.</p>
<p>In this case, we can write the likelihood function as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>f</mi><msub><mi>T</mi><mi>i</mi></msub></msub><mo stretchy="false" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">|</mo><mi>Î¸</mi><mo stretchy="false" form="postfix">)</mo><munderover><mo>âˆ</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><munder><mo>âˆ</mo><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>âˆˆ</mo><msub><mi>ğ’</mi><mi>i</mi></msub></mrow></munder><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
    L(\theta) = \prod_{i=1}^n f_{T_i}(t_i|\theta) \prod_{j=1}^m \Pr\{K_i=j|T_i=t_i\} \prod_{c_i \in \mathcal{C}_i} g(c_i,t_i,j).
</annotation></semantics></math></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulation">Simulation<a class="anchor" aria-label="anchor" href="#simulation"></a>
</h2>
<p>The most straightforward series system to estimate is the series
system with exponentially distributed component lifetimes.</p>
<p>Suppose an exponential series system with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components is parameterized by the following R code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,     <span class="co"># component 1 failure rate</span></span>
<span>           <span class="fl">1.1</span>,   <span class="co"># 3</span></span>
<span>           <span class="fl">0.95</span>,  <span class="co"># 5</span></span>
<span>           <span class="fl">1.15</span>,  <span class="co"># 6</span></span>
<span>           <span class="fl">1.1</span><span class="op">)</span>   <span class="co"># 7</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span></code></pre></div>
<p>So, in our study,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1.1</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.15</mn><mo>,</mo><mn>1.1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\theta = (1, 1.1, 0.95, 1.15, 1.1)'</annotation></semantics></math>.
The component assigned to index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
has an exponentially distributed lifetime with a failure rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î¸</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>,
e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¸</mi><mn>2</mn></msub><mo>=</mo><mn>1.1</mn></mrow><annotation encoding="application/x-tex">\theta_2 = 1.1</annotation></semantics></math>
is the failure rate of the component indexed by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>.</p>
<p>Letâ€™s simulate generating the lifetimes of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">m = 5</annotation></semantics></math>
components for this series system:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span> <span class="co"># set seed for reproducibility</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">7500</span></span>
<span><span class="va">comp_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="va">n</span>,ncol<span class="op">=</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="va">comp_times</span><span class="op">[</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">comp_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/md_encode_matrix.html">md_encode_matrix</a></span><span class="op">(</span><span class="va">comp_times</span>,<span class="st">"t"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">comp_times</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;      t1      t2     t3      t4     t5</span></span>
<span><span class="co">#&gt; 1 2.953 1.67343 0.7765 0.04761 0.3798</span></span>
<span><span class="co">#&gt; 2 1.099 2.20079 2.5923 3.26549 0.6260</span></span>
<span><span class="co">#&gt; 3 1.202 0.09557 3.7371 1.80056 2.1282</span></span>
<span><span class="co">#&gt; 4 1.443 0.04595 0.1229 0.52177 0.1025</span></span></code></pre></div>
<p>Next, we use the function
<code>md_series_lifetime_right_censoring</code> to decorate the masked
data with the right-censor-censoring time chosen by the probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Pr</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>T</mi><mi>i</mi></msub><mo>&gt;</mo><mi>Ï„</mi><mo stretchy="false" form="postfix">}</mo><mo>=</mo><mn>0.75</mn></mrow><annotation encoding="application/x-tex">\Pr\{T_i &gt; \tau\} = 0.75</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">tau</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">q</span><span class="op">)</span>,<span class="va">n</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">comp_times</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/md_series_lifetime_right_censoring.html">md_series_lifetime_right_censoring</a></span><span class="op">(</span><span class="va">tau</span><span class="op">)</span></span>
<span><span class="va">latent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"latent"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">latent</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;         t delta</span></span>
<span><span class="co">#&gt; 1 0.04761  TRUE</span></span>
<span><span class="co">#&gt; 2 0.26156 FALSE</span></span>
<span><span class="co">#&gt; 3 0.09557  TRUE</span></span>
<span><span class="co">#&gt; 4 0.04595  TRUE</span></span></code></pre></div>
<div class="section level3">
<h3 id="masked-component-cause-of-failure">Masked component cause of failure<a class="anchor" aria-label="anchor" href="#masked-component-cause-of-failure"></a>
</h3>
<p>We simulate candidate sets using the Bernoulli candidate model with
an appropriate set of parameters to satisfy conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">.3</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/md_bernoulli_cand_c1_c2_c3.html">md_bernoulli_cand_c1_c2_c3</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"q"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;    q1  q2  q3  q4  q5</span></span>
<span><span class="co">#&gt; 1 0.3 0.3 0.3 1.0 0.3</span></span>
<span><span class="co">#&gt; 2 0.0 0.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 3 0.3 1.0 0.3 0.3 0.3</span></span>
<span><span class="co">#&gt; 4 0.3 1.0 0.3 0.3 0.3</span></span></code></pre></div>
<p>Now, to generate candidate sets, we sample from these
probabilities:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/md_cand_sampler.html">md_cand_sampler</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">delta</span>, <span class="st">"exact"</span>, <span class="st">"right"</span><span class="op">)</span></span>
<span><span class="va">display</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/md_boolean_matrix_to_charsets.html">md_boolean_matrix_to_charsets</a></span><span class="op">(</span><span class="va">data</span>, drop_set <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">latent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">display</span>, <span class="st">"latent"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">display</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">display</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">latent</span><span class="op">]</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;      t1      t2     t3      t4     t5       t delta  q1  q2  q3  q4  q5 omega</span></span>
<span><span class="co">#&gt; 1 2.953 1.67343 0.7765 0.04761 0.3798 0.04761  TRUE 0.3 0.3 0.3 1.0 0.3 exact</span></span>
<span><span class="co">#&gt; 2 1.099 2.20079 2.5923 3.26549 0.6260 0.26156 FALSE 0.0 0.0 0.0 0.0 0.0 right</span></span>
<span><span class="co">#&gt; 3 1.202 0.09557 3.7371 1.80056 2.1282 0.09557  TRUE 0.3 1.0 0.3 0.3 0.3 exact</span></span>
<span><span class="co">#&gt; 4 1.443 0.04595 0.1229 0.52177 0.1025 0.04595  TRUE 0.3 1.0 0.3 0.3 0.3 exact</span></span>
<span><span class="co">#&gt; 5 2.409 0.46744 0.5819 0.02899 0.2009 0.02899  TRUE 0.3 0.3 0.3 1.0 0.3 exact</span></span>
<span><span class="co">#&gt; 6 4.400 1.92722 0.3933 1.56782 0.1597 0.15967  TRUE 0.3 0.3 0.3 0.3 1.0 exact</span></span>
<span><span class="co">#&gt;           x</span></span>
<span><span class="co">#&gt; 1    {1, 4}</span></span>
<span><span class="co">#&gt; 2        {}</span></span>
<span><span class="co">#&gt; 3    {2, 4}</span></span>
<span><span class="co">#&gt; 4 {1, 2, 3}</span></span>
<span><span class="co">#&gt; 5    {4, 5}</span></span>
<span><span class="co">#&gt; 6    {2, 5}</span></span></code></pre></div>
<p>We see that after dropping latent (unobserved) columns, we only have
the right censoring time, right censoring indicator, and the candidate
sets. (Note that this time we showed the candidate sets in a more
friendly way using <code>md_boolean_matrix_to_charsets</code>.)</p>
</div>
</div>
<div class="section level2">
<h2 id="constructing-model">Constructing the Likelihood Model<a class="anchor" aria-label="anchor" href="#constructing-model"></a>
</h2>
<p>The likelihood model is a statistical model that describes the
distribution of the observed data as a function of the parameters of
interest.</p>
<p>We construct a likelihood model for the masked data model with
exponentially distributed component lifetimes with the following
code:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mle">Maximum likelihood estimation<a class="anchor" aria-label="anchor" href="#mle"></a>
</h2>
The log-likelihood for our masked data model under masking conditions C1
(failed component in candidate set), C2 (uniform candidate set
probability), and C3 (masking independent of parameters) is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î»</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>Î´</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>log</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>Î»</mi><mi>j</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo>âˆ’</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>s</mi><mi>i</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î»</mi><mi>j</mi></msub><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:loglik_masked}
\ell(\lambda) =
    \sum_{i=1}^{n} (1-\delta_i) \log \biggl(\sum_{j \in c_i} \lambda_j \biggr) -
    \biggl( \sum_{i=1}^{n} s_i \biggr)
    \biggl( \sum_{j=1}^{m} \lambda_j \biggr).
\end{equation}</annotation></semantics></math><p>The set of solutions to the MLE equations must be stationary points,
i.e., a point at which the score function of type
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>â„</mi><mi>m</mi></msup><mo>â†¦</mo><msup><mi>â„</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^m \mapsto \mathbb{R}^m</annotation></semantics></math>
is zero. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
component of the output of the score function is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î»</mi><mi>p</mi></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>Î»</mi><mi>j</mi></msub><msup><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup><msub><mn>1</mn><mrow><mo stretchy="false" form="prefix">{</mo><mi>p</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>Î´</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow></msub><mo>âˆ’</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>s</mi><mi>i</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:score_expo_j}
\frac{\partial \ell}{\partial \lambda_p} = 
  \sum_{i=1}^{n} \biggl( \sum_{j \in c_i} \lambda_j \biggr)^{-1}
  1_{\{p \in c_i \text{ and } \delta_i = 0\}} - \sum_{i=1}^{n} s_i.
\end{equation}</annotation></semantics></math></p>
<p>We may find an MLE by solving the score equation, i.e., finding
stationary points satisfying
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>âˆ‚</mi><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î»</mi><mi>j</mi></msub></mrow></mfrac><msub><mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">|</mo><msub><mover><mi>Î»</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi></msub></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
\frac{\partial \ell}{\partial \lambda_j}\Biggr|_{\hat\lambda_j} = 0
</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">j=1,\ldots,m</annotation></semantics></math>.
We approximate a solution to this problem by using the iterative
Newton-Raphson method.</p>
<p>The Newton-Raphson method needs the observed information matrix,
which is a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î»</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
of type
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>â„</mi><mi>m</mi></msup><mo>â†¦</mo><msup><mi>â„</mi><mrow><mi>m</mi><mo>Ã—</mo><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^m \mapsto \mathbb{R}^{m \times m}</annotation></semantics></math>.
The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(j,k)</annotation></semantics></math>-th
element of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î»</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">J(\lambda)</annotation></semantics></math>
is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msup><mi>âˆ‚</mi><mn>2</mn></msup><mo>â„“</mo></mrow><mrow><mi>âˆ‚</mi><msub><mi>Î»</mi><mi>j</mi></msub><mi>âˆ‚</mi><msub><mi>Î»</mi><mi>k</mi></msub></mrow></mfrac><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">(</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>Î»</mi><mi>j</mi></msub><msup><mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">)</mo><mrow><mo>âˆ’</mo><mn>2</mn></mrow></msup><msub><mn>1</mn><mrow><mo stretchy="false" form="prefix">{</mo><mi>j</mi><mo>,</mo><mi>k</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> and </mtext><mspace width="0.333em"></mspace></mrow><msub><mi>Î´</mi><mi>i</mi></msub><mo>=</mo><mn>0</mn><mo stretchy="false" form="postfix">}</mo></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:info_expo}
\frac{\partial^2 \ell}{\partial \lambda_j \partial \lambda_k} = 
  \sum_{i=1}^{n} \biggl( \sum_{j \in c_i} \lambda_j \biggr)^{-2}
  1_{\{j,k \in c_i \text{ and } \delta_i = 0\}}.
\end{equation}</annotation></semantics></math></p>
<div class="section level3">
<h3 id="log-likelihood-of-theta-given-masked-data">Log-likelihood of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
given masked data<a class="anchor" aria-label="anchor" href="#log-likelihood-of-theta-given-masked-data"></a>
</h3>
<p>The reduced log-likelihood function (the log of the kernel of the
likelihood function) is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="false" form="prefix">|</mo><mtext mathvariant="normal">data</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>âˆ’</mo><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>âˆ‘</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>Î¸</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>Î´</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>Î¸</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell(\theta|\text{data}) =
    -\left(\sum_{i=1}^{n} t_i\right)
    \left(\sum_{j=1}^{m} \theta_j\right) +
    \sum_{i=1}^{n} (1-\delta_i)\log\left(\sum_{j \in c_i} \theta_j\right).
</annotation></semantics></math></p>
<p>We compute the log-likelihood function using generic dispatch:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>The returned function <code>ll(df, par)</code> evaluates the
log-likelihood at parameter <code>par</code> given data <code>df</code>.
For example, at the true parameter value:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ll</span><span class="op">(</span><span class="va">data</span>, <span class="va">theta</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -1393</span></span></code></pre></div>
<p>Note that the implementation uses minimally sufficient statistics,
which improves computational efficiency.</p>
<p>The log-likelihood function contains the maximum amount of
information about parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
given the sample of masked data <code>data</code> satisfying conditions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>1</mn></msub><annotation encoding="application/x-tex">C_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>2</mn></msub><annotation encoding="application/x-tex">C_2</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mn>3</mn></msub><annotation encoding="application/x-tex">C_3</annotation></semantics></math>.</p>
<p>Suppose we do not know that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1.1</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.15</mn><mo>,</mo><mn>1.1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\theta = (1, 1.1, 0.95, 1.15, 1.1)'</annotation></semantics></math>.
With the log-likelihood, we may estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¸</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat\theta</annotation></semantics></math>
by solving
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mo>=</mo><msub><mo>argmax</mo><mrow><mi>Î¸</mi><mo>âˆˆ</mo><mi>Î©</mi></mrow></msub><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\hat{\theta} = \operatorname{argmax}_{\theta \in \Omega} \ell(\theta),
</annotation></semantics></math> i.e., finding the point that
<em>maximizes</em> the log-likelihood on the observed sample
<code>data</code>. This is known as <em>maximum likelihood
estimation</em> (MLE). We typically solve for the MLE by solving
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>âˆ‡</mi><mo>â„“</mo><msub><mo stretchy="false" form="prefix">|</mo><mrow><mi>Î¸</mi><mo>=</mo><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover></mrow></msub><mo>=</mo><mn>0</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
\nabla \ell|_{\theta=\hat{\theta}} = 0.
</annotation></semantics></math></p>
<p>A popular choice is gradient ascent, which is an iterative method
based on the update rule
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Î¸</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mi>Î¸</mi><mi>n</mi></msup><mo>+</mo><mi>Î·</mi><mo>â„“</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>Î¸</mi><mi>n</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\theta^{(n+1)} = \theta^n + \eta \ell(\theta^n),
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î·</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
is the learning rate.</p>
<p>We can also obtain the score (gradient) function via generic
dispatch:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/score.html" class="external-link">score</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p>The score at the true parameter should be close to zero (at the MLE,
it is exactly zero):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">grad</span><span class="op">(</span><span class="va">data</span>, <span class="va">theta</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -23.934  -4.920  -9.392 -21.984  -2.042</span></span></code></pre></div>
<p>The <code>likelihood.model</code> framework provides analytical score
and Hessian implementations when available, falling back to numerical
differentiation otherwise.</p>
<p>In what follows, we use <a href="https://github.com/queelius/algebraic.mle" class="external-link">algebraic.mle</a> to
help solve the MLE equations and display various properties of the
solution.</p>
<p>To solve the MLE equation, we use the generic <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code>
function, which dispatches to <code>fit.likelihood_model</code> for any
object with <code>"likelihood_model"</code> in its class. The
<code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> function returns a solver that uses
<code>optim</code> internally with the BFGS method by default.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the solver from the model using generic dispatch</span></span>
<span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Solve for MLE with initial guess</span></span>
<span><span class="va">theta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">data</span>, par <span class="op">=</span> <span class="va">theta0</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span></code></pre></div>
<p>The result is an <code>mle</code> object from the
<code>algebraic.mle</code> package with rich accessor methods:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print summary with confidence intervals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimate (Fisherian)</span></span>
<span><span class="co">#&gt; ----------------------------------------</span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; [1] 0.9617 1.1049 0.9455 1.1147 1.1116</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Log-likelihood: -1392 </span></span>
<span><span class="co">#&gt; Observations: 7500</span></span></code></pre></div>
<p>We can access specific components of the MLE:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Point estimate</span></span>
<span><span class="va">theta.hat</span> <span class="op">&lt;-</span> <span class="va">estimate</span><span class="op">$</span><span class="va">par</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"MLE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">theta.hat</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; MLE: 0.9617 1.105 0.9455 1.115 1.112</span></span>
<span></span>
<span><span class="co"># Standard errors (sqrt of diagonal of variance-covariance matrix)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"SE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; SE: 0.0442 0.0457 0.0427 0.0449 0.0454</span></span>
<span></span>
<span><span class="co"># Log-likelihood at MLE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Log-likelihood:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">loglik</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Log-likelihood: -1392</span></span></code></pre></div>
<p>Recall that the true parameter is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î¸</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1.1</mn><mo>,</mo><mn>0.95</mn><mo>,</mo><mn>1.15</mn><mo>,</mo><mn>1.1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>â€²</mi></mrow><annotation encoding="application/x-tex">\theta = (1, 1.1, 0.95, 1.15, 1.1)'</annotation></semantics></math>.</p>
<p>Due to sampling variability, different runs of the experiment will
result in different outcomes, i.e.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>
has a sampling distribution. We see that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mo>â‰ </mo><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\hat{\theta} \neq \theta</annotation></semantics></math>,
but it is reasonably close. We may measure this sampling variability
using the variance-covariance matrix, bias, mean squared error (MSE),
and confidence intervals.</p>
</div>
</div>
<div class="section level2">
<h2 id="observation-types">Observation Types and Censoring<a class="anchor" aria-label="anchor" href="#observation-types"></a>
</h2>
<p>The likelihood model supports four observation types. Each arises
from a different monitoring scheme:</p>
<ul>
<li>
<strong>Exact</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï‰</mi><mo>=</mo><mtext mathvariant="normal">exact</mtext></mrow><annotation encoding="application/x-tex">\omega = \text{exact}</annotation></semantics></math>):
The system failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is observed directly, e.g., continuous monitoring.</li>
<li>
<strong>Right-censored</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï‰</mi><mo>=</mo><mtext mathvariant="normal">right</mtext></mrow><annotation encoding="application/x-tex">\omega = \text{right}</annotation></semantics></math>):
The system is known to have survived past
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
e.g., study ends before failure.</li>
<li>
<strong>Left-censored</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï‰</mi><mo>=</mo><mtext mathvariant="normal">left</mtext></mrow><annotation encoding="application/x-tex">\omega = \text{left}</annotation></semantics></math>):
The system is known to have failed before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
e.g., a single inspection finds it failed.</li>
<li>
<strong>Interval-censored</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï‰</mi><mo>=</mo><mtext mathvariant="normal">interval</mtext></mrow><annotation encoding="application/x-tex">\omega = \text{interval}</annotation></semantics></math>):
The failure occurred in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>,</mo><msub><mi>t</mi><mtext mathvariant="normal">upper</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(t, t_{\text{upper}})</annotation></semantics></math>,
e.g., periodic inspections bracket the failure.</li>
</ul>
<p>For the exponential series system, the individual-observation
log-likelihood contributions are:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Exact:</mtext><mspace width="1.0em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>log</mo><msub><mi>Î»</mi><mi>c</mi></msub><mo>âˆ’</mo><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub><mi>t</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Right:</mtext><mspace width="1.0em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>âˆ’</mo><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub><mi>t</mi></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Left:</mtext><mspace width="1.0em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>log</mo><msub><mi>Î»</mi><mi>c</mi></msub><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub><mi>Ï„</mi></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mo>log</mo><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Interval:</mtext><mspace width="1.0em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>log</mo><msub><mi>Î»</mi><mi>c</mi></msub><mo>âˆ’</mo><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub><mi>a</mi><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><msup><mi>e</mi><mrow><mo>âˆ’</mo><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>âˆ’</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mo>log</mo><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
\text{Exact:} \quad &amp; \log \lambda_c - \lambda_{\text{sys}} t \\
\text{Right:} \quad &amp; -\lambda_{\text{sys}} t \\
\text{Left:} \quad &amp; \log \lambda_c + \log(1 - e^{-\lambda_{\text{sys}} \tau})
  - \log \lambda_{\text{sys}} \\
\text{Interval:} \quad &amp; \log \lambda_c - \lambda_{\text{sys}} a
  + \log(1 - e^{-\lambda_{\text{sys}}(b - a)}) - \log \lambda_{\text{sys}}
\end{align}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mi>c</mi></msub><mo>=</mo><msub><mo>âˆ‘</mo><mrow><mi>j</mi><mo>âˆˆ</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></msub><msub><mi>Î»</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_c = \sum_{j \in c_i} \lambda_j</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub><mo>=</mo><msub><mo>âˆ‘</mo><mi>j</mi></msub><msub><mi>Î»</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_{\text{sys}} = \sum_j \lambda_j</annotation></semantics></math>.</p>
<p>The left-censored contribution can be interpreted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>w</mi><mi>c</mi></msub><mo>+</mo><mo>log</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï„</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log w_c + \log F(\tau)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>c</mi></msub><mo>=</mo><msub><mi>Î»</mi><mi>c</mi></msub><mi>/</mi><msub><mi>Î»</mi><mtext mathvariant="normal">sys</mtext></msub></mrow><annotation encoding="application/x-tex">w_c = \lambda_c / \lambda_{\text{sys}}</annotation></semantics></math>
is the candidate cause weight and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Ï„</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\tau)</annotation></semantics></math>
is the system CDF.</p>
<p><strong>The exponential model is the only one where all four types
have fully analytical loglik, score, AND Hessian.</strong> The Weibull
models require numerical integration or <code>numDeriv</code> for
left/interval types.</p>
<div class="section level3">
<h3 id="observe-functors">Observe functors<a class="anchor" aria-label="anchor" href="#observe-functors"></a>
</h3>
<p>The package provides composable observation functors for generating
data under different monitoring schemes:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Periodic inspection every 0.5 time units, study ends at tau = 5</span></span>
<span><span class="va">obs_periodic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.5</span>, tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Single inspection at tau = 3</span></span>
<span><span class="va">obs_left</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mix of continuous and periodic monitoring</span></span>
<span><span class="va">obs_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generating-mixed-censoring-data">Generating mixed-censoring data<a class="anchor" aria-label="anchor" href="#generating-mixed-censoring-data"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Periodic inspections</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span></span>
<span><span class="va">df_periodic</span> <span class="op">&lt;-</span> <span class="fu">gen</span><span class="op">(</span><span class="va">theta</span>, n <span class="op">=</span> <span class="fl">500</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                   observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.5</span>, tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Periodic inspection observation types:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Periodic inspection observation types:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_periodic</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; interval </span></span>
<span><span class="co">#&gt;      500</span></span>
<span></span>
<span><span class="co"># Mixed monitoring</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span></span>
<span><span class="va">df_mixed</span> <span class="op">&lt;-</span> <span class="fu">gen</span><span class="op">(</span><span class="va">theta</span>, n <span class="op">=</span> <span class="fl">500</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>                  <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>                  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span>                <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nMixed monitoring observation types:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mixed monitoring observation types:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_mixed</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; exact  left </span></span>
<span><span class="co">#&gt;   344   156</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="likelihood-evaluation-on-mixed-censoring-data">Likelihood evaluation on mixed-censoring data<a class="anchor" aria-label="anchor" href="#likelihood-evaluation-on-mixed-censoring-data"></a>
</h3>
<p>All four observation types contribute analytically to the loglik,
score, and Hessian for the exponential model:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ll_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">scr_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/score.html" class="external-link">score</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">hess_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/hess_loglik.html" class="external-link">hess_loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate at true parameters</span></span>
<span><span class="va">ll_val</span> <span class="op">&lt;-</span> <span class="fu">ll_fn</span><span class="op">(</span><span class="va">df_periodic</span>, <span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">scr_val</span> <span class="op">&lt;-</span> <span class="fu">scr_fn</span><span class="op">(</span><span class="va">df_periodic</span>, <span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">hess_val</span> <span class="op">&lt;-</span> <span class="fu">hess_fn</span><span class="op">(</span><span class="va">df_periodic</span>, <span class="va">theta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Log-likelihood (periodic):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ll_val</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Log-likelihood (periodic): -589.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Score (periodic):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">scr_val</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Score (periodic): -21.95 12.48 -8.39 -8.58 4.447</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hessian eigenvalues:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">hess_val</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hessian eigenvalues: -24.44 -34.03 -35.33 -43.87 -56.17</span></span></code></pre></div>
<p>We verify that the analytical score is consistent with numerical
differentiation:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scr_numerical</span> <span class="op">&lt;-</span> <span class="fu">numDeriv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">grad</a></span><span class="op">(</span></span>
<span>  func <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span> <span class="fu">ll_fn</span><span class="op">(</span><span class="va">df_periodic</span>, <span class="va">th</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="va">theta</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Max |analytical - numerical| score:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">scr_val</span> <span class="op">-</span> <span class="va">scr_numerical</span><span class="op">)</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"e"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max |analytical - numerical| score: 5.39e-07</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="monte-carlo-simulation-study">Monte Carlo simulation study<a class="anchor" aria-label="anchor" href="#monte-carlo-simulation-study"></a>
</h3>
<p>To understand the sampling properties of the MLE, we conduct a Monte
Carlo simulation study. We repeatedly:</p>
<ol style="list-style-type: decimal">
<li>Generate masked data from the true model</li>
<li>Fit the likelihood model to obtain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><annotation encoding="application/x-tex">\hat{\theta}</annotation></semantics></math>
</li>
<li>Compute asymptotic confidence intervals</li>
</ol>
<p>From the collection of estimates, we can compute:</p>
<ul>
<li>
<strong>Bias</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">E</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">]</mo></mrow><mo>âˆ’</mo><mi>Î¸</mi></mrow><annotation encoding="application/x-tex">\text{E}[\hat{\theta}] - \theta</annotation></semantics></math>
</li>
<li>
<strong>Variance</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mrow><mo stretchy="true" form="prefix">[</mo><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Var}[\hat{\theta}]</annotation></semantics></math>
</li>
<li>
<strong>MSE</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">E</mtext><mrow><mo stretchy="true" form="prefix">[</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mo>âˆ’</mo><mi>Î¸</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mtext mathvariant="normal">Bias</mtext><mn>2</mn></msup><mo>+</mo><mtext mathvariant="normal">Var</mtext></mrow><annotation encoding="application/x-tex">\text{E}[(\hat{\theta} - \theta)^2] = \text{Bias}^2 + \text{Var}</annotation></semantics></math>
</li>
<li>
<strong>Coverage probability</strong>: Proportion of CIs containing
the true value</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulation parameters</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">200</span>       <span class="co"># Number of Monte Carlo replications</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>  <span class="co"># Significance level for CIs</span></span>
<span></span>
<span><span class="co"># Storage for results</span></span>
<span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">se_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">converged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Generate component lifetimes</span></span>
<span>    <span class="va">comp_times_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">n</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">comp_times_b</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">comp_times_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/md_encode_matrix.html">md_encode_matrix</a></span><span class="op">(</span><span class="va">comp_times_b</span>, <span class="st">"t"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Apply masking pipeline</span></span>
<span>    <span class="va">data_b</span> <span class="op">&lt;-</span> <span class="va">comp_times_b</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu"><a href="../reference/md_series_lifetime_right_censoring.html">md_series_lifetime_right_censoring</a></span><span class="op">(</span><span class="va">tau</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu"><a href="../reference/md_bernoulli_cand_c1_c2_c3.html">md_bernoulli_cand_c1_c2_c3</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu"><a href="../reference/md_cand_sampler.html">md_cand_sampler</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">data_b</span><span class="op">$</span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data_b</span><span class="op">$</span><span class="va">delta</span>, <span class="st">"exact"</span>, <span class="st">"right"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Fit model</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="va">result_b</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">data_b</span>, par <span class="op">=</span> <span class="va">theta0</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span>        <span class="va">estimates</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">result_b</span><span class="op">$</span><span class="va">par</span></span>
<span>        <span class="va">se_estimates</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">result_b</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>        <span class="co"># Asymptotic Wald CIs</span></span>
<span>        <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span>        <span class="va">ci_lower</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">result_b</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">z</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">result_b</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">ci_upper</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">result_b</span><span class="op">$</span><span class="va">par</span> <span class="op">+</span> <span class="va">z</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">result_b</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">converged</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">result_b</span><span class="op">$</span><span class="va">converged</span></span>
<span>    <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">converged</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Convergence rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">converged</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="bias-variance-and-mse">Bias, Variance, and MSE<a class="anchor" aria-label="anchor" href="#bias-variance-and-mse"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute summary statistics (only for converged runs)</span></span>
<span><span class="va">valid</span> <span class="op">&lt;-</span> <span class="va">converged</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">est_valid</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="va">valid</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span><span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">est_valid</span><span class="op">)</span> <span class="op">-</span> <span class="va">theta</span></span>
<span><span class="va">variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">est_valid</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span></span>
<span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="va">bias</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">variance</span></span>
<span><span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mse</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create results table</span></span>
<span><span class="va">results_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Component <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span>,</span>
<span>    True <span class="op">=</span> <span class="va">theta</span>,</span>
<span>    Mean_Est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">est_valid</span><span class="op">)</span>,</span>
<span>    Bias <span class="op">=</span> <span class="va">bias</span>,</span>
<span>    Variance <span class="op">=</span> <span class="va">variance</span>,</span>
<span>    MSE <span class="op">=</span> <span class="va">mse</span>,</span>
<span>    RMSE <span class="op">=</span> <span class="va">rmse</span>,</span>
<span>    Rel_Bias_Pct <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">bias</span> <span class="op">/</span> <span class="va">theta</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">results_df</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Monte Carlo Results: Bias, Variance, and MSE"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="st">"True Î¸"</span>, <span class="st">"Mean Î¸Ì‚"</span>, <span class="st">"Bias"</span>,</span>
<span>                          <span class="st">"Variance"</span>, <span class="st">"MSE"</span>, <span class="st">"RMSE"</span>, <span class="st">"Rel. Bias %"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<caption>Monte Carlo Results: Bias, Variance, and MSE</caption>
<colgroup>
<col width="14%">
<col width="10%">
<col width="10%">
<col width="11%">
<col width="13%">
<col width="10%">
<col width="10%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="right">Component</th>
<th align="right">True Î¸</th>
<th align="right">Mean Î¸Ì‚</th>
<th align="right">Bias</th>
<th align="right">Variance</th>
<th align="right">MSE</th>
<th align="right">RMSE</th>
<th align="right">Rel. Bias %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">1.000</td>
<td align="right">0.0005</td>
<td align="right">0.0019</td>
<td align="right">0.0019</td>
<td align="right">0.0439</td>
<td align="right">0.0464</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1.10</td>
<td align="right">1.100</td>
<td align="right">0.0004</td>
<td align="right">0.0018</td>
<td align="right">0.0018</td>
<td align="right">0.0425</td>
<td align="right">0.0406</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.95</td>
<td align="right">0.949</td>
<td align="right">-0.0010</td>
<td align="right">0.0021</td>
<td align="right">0.0021</td>
<td align="right">0.0463</td>
<td align="right">-0.1064</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1.15</td>
<td align="right">1.151</td>
<td align="right">0.0011</td>
<td align="right">0.0021</td>
<td align="right">0.0021</td>
<td align="right">0.0453</td>
<td align="right">0.0963</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1.10</td>
<td align="right">1.107</td>
<td align="right">0.0073</td>
<td align="right">0.0020</td>
<td align="right">0.0020</td>
<td align="right">0.0452</td>
<td align="right">0.6665</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="confidence-interval-coverage">Confidence Interval Coverage<a class="anchor" aria-label="anchor" href="#confidence-interval-coverage"></a>
</h4>
<p>The asymptotic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1-\alpha)</annotation></semantics></math>%
Wald confidence interval is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi></msub><mo>Â±</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>âˆ’</mo><mi>Î±</mi><mi>/</mi><mn>2</mn></mrow></msub><mo>â‹…</mo><mtext mathvariant="normal">SE</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>Î¸</mi><mo accent="true">Ì‚</mo></mover><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\hat{\theta}_j \pm z_{1-\alpha/2} \cdot \text{SE}(\hat{\theta}_j)
</annotation></semantics></math></p>
<p>We assess coverage probability: the proportion of intervals that
contain the true parameter value.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute coverage for each component</span></span>
<span><span class="va">coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">valid_j</span> <span class="op">&lt;-</span> <span class="va">valid</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ci_lower</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ci_upper</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">covered</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ci_lower</span><span class="op">[</span><span class="va">valid_j</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">ci_upper</span><span class="op">[</span><span class="va">valid_j</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">coverage</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covered</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Mean CI width</span></span>
<span><span class="va">mean_width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">ci_upper</span><span class="op">[</span><span class="va">valid</span>, <span class="op">]</span> <span class="op">-</span> <span class="va">ci_lower</span><span class="op">[</span><span class="va">valid</span>, <span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coverage_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Component <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span>,</span>
<span>    True <span class="op">=</span> <span class="va">theta</span>,</span>
<span>    Coverage <span class="op">=</span> <span class="va">coverage</span>,</span>
<span>    Nominal <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span>,</span>
<span>    Mean_Width <span class="op">=</span> <span class="va">mean_width</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">coverage_df</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Coverage Probability of "</span>, <span class="fl">100</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alpha</span><span class="op">)</span>, <span class="st">"% Confidence Intervals"</span><span class="op">)</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="st">"True Î¸"</span>, <span class="st">"Coverage"</span>, <span class="st">"Nominal"</span>, <span class="st">"Mean Width"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Coverage Probability of 95% Confidence Intervals</caption>
<thead><tr class="header">
<th align="right">Component</th>
<th align="right">True Î¸</th>
<th align="right">Coverage</th>
<th align="right">Nominal</th>
<th align="right">Mean Width</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">0.9444</td>
<td align="right">0.95</td>
<td align="right">0.1725</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1.10</td>
<td align="right">0.9646</td>
<td align="right">0.95</td>
<td align="right">0.1775</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.95</td>
<td align="right">0.9545</td>
<td align="right">0.95</td>
<td align="right">0.1697</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1.15</td>
<td align="right">0.9343</td>
<td align="right">0.95</td>
<td align="right">0.1797</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1.10</td>
<td align="right">0.9495</td>
<td align="right">0.95</td>
<td align="right">0.1776</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="sampling-distribution-visualization">Sampling Distribution Visualization<a class="anchor" aria-label="anchor" href="#sampling-distribution-visualization"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot sampling distributions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">est_valid</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="fl">20</span>, probability <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Component "</span>, <span class="va">j</span><span class="op">)</span>,</span>
<span>         xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hat</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">est_valid</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span>, <span class="st">"Mean Est."</span><span class="op">)</span>,</span>
<span>           col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="exponential_series_files/figure-html/sampling-dist-plot-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level4">
<h4 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h4>
<p>The Monte Carlo simulation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>7500</mn></mrow><annotation encoding="application/x-tex">n = 7500</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">B = 200</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">p = 0.3</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ¼</mo><mn>25</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\sim 25\%</annotation></semantics></math>
censoring) demonstrates that the MLE for the exponential series system
with masked data satisfying conditions C1â€“C3 has desirable large-sample
properties:</p>
<ul>
<li><p><strong>Essentially unbiased.</strong> All relative biases are
below 0.7%, with the largest being component 5 at 0.67%. The
squared-bias contribution to MSE is negligible (e.g., component 1:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mtext mathvariant="normal">bias</mtext><mn>2</mn></msup><mo>â‰ˆ</mo><mn>2</mn><mo>Ã—</mo><msup><mn>10</mn><mrow><mo>âˆ’</mo><mn>7</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\text{bias}^2 \approx 2 \times 10^{-7}</annotation></semantics></math>
vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Var</mtext><mo>=</mo><mn>0.0019</mn></mrow><annotation encoding="application/x-tex">\text{Var} = 0.0019</annotation></semantics></math>).
The MLE is consistent and approximately unbiased at this sample
size.</p></li>
<li><p><strong>Uniform relative precision.</strong> RMSE ranges from
0.042 to 0.046 across components â€” roughly 4â€“5% of the true rates. This
uniformity is consistent with the asymptotic efficiency of the MLE:
components with higher failure rates (and thus higher variance) also
have proportionally wider CIs.</p></li>
<li><p><strong>Coverage near nominal.</strong> Coverage ranges from
93.4% to 96.5% against a nominal 95%. Component 4 (93.4%) slightly
undercovers, suggesting the Wald interval may be mildly liberal for some
components at this sample size. This is a known finite-sample property
of Wald intervals for rate parameters.</p></li>
<li><p><strong>CI width as a design metric.</strong> Mean CI widths of
0.170â€“0.180 (about
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>Â±</mo><mn>8.5</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\pm 8.5\%</annotation></semantics></math>
of the true rate) provide a concrete basis for sample size planning.
Since CI width scales as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">1/\sqrt{n}</annotation></semantics></math>,
halving the width requires roughly
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">4\times</annotation></semantics></math>
the sample size.</p></li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="sensitivity">Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#sensitivity"></a>
</h2>
<p>The MLE properties depend on several factors: sample size, masking
probability, and right-censoring rate. In this section, we study how
these factors affect estimation accuracy.</p>
<div class="section level3">
<h3 id="effect-of-masking-probability">Effect of Masking Probability<a class="anchor" aria-label="anchor" href="#effect-of-masking-probability"></a>
</h3>
<p>The masking probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
controls how much information about the failed component is obscured.
When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p = 0</annotation></semantics></math>,
only the failed component is in the candidate set (perfect information).
As
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
increases, more non-failed components are included, making estimation
more difficult.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use smaller sample for sensitivity study</span></span>
<span><span class="va">n_sens</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">B_sens</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># Masking probabilities to test</span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fixed right-censoring (25% censored)</span></span>
<span><span class="va">q_sens</span> <span class="op">&lt;-</span> <span class="fl">0.25</span></span>
<span><span class="va">tau_sens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">q_sens</span><span class="op">)</span>, <span class="va">n_sens</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Storage</span></span>
<span><span class="va">mask_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">p_idx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">p_values</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p_curr</span> <span class="op">&lt;-</span> <span class="va">p_values</span><span class="op">[</span><span class="va">p_idx</span><span class="op">]</span></span>
<span>    <span class="va">est_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B_sens</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B_sens</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Generate data</span></span>
<span>        <span class="va">comp_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">n_sens</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span> <span class="va">comp_b</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n_sens</span>, <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">comp_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/md_encode_matrix.html">md_encode_matrix</a></span><span class="op">(</span><span class="va">comp_b</span>, <span class="st">"t"</span><span class="op">)</span></span>
<span></span>
<span>        <span class="va">data_b</span> <span class="op">&lt;-</span> <span class="va">comp_b</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu"><a href="../reference/md_series_lifetime_right_censoring.html">md_series_lifetime_right_censoring</a></span><span class="op">(</span><span class="va">tau_sens</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu"><a href="../reference/md_bernoulli_cand_c1_c2_c3.html">md_bernoulli_cand_c1_c2_c3</a></span><span class="op">(</span><span class="va">p_curr</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu"><a href="../reference/md_cand_sampler.html">md_cand_sampler</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="va">data_b</span><span class="op">$</span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data_b</span><span class="op">$</span><span class="va">delta</span>, <span class="st">"exact"</span>, <span class="st">"right"</span><span class="op">)</span></span>
<span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="va">fit_b</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">data_b</span>, par <span class="op">=</span> <span class="va">theta0</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="va">fit_b</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span> <span class="va">est_p</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_b</span><span class="op">$</span><span class="va">par</span></span>
<span>        <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># Compute statistics</span></span>
<span>    <span class="va">valid_p</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">est_p</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">mask_results</span><span class="op">[[</span><span class="va">p_idx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        p <span class="op">=</span> <span class="va">p_curr</span>,</span>
<span>        bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">est_p</span><span class="op">[</span><span class="va">valid_p</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">theta</span>,</span>
<span>        variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">est_p</span><span class="op">[</span><span class="va">valid_p</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span>,</span>
<span>        mse <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">est_p</span><span class="op">[</span><span class="va">valid_p</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">theta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">est_p</span><span class="op">[</span><span class="va">valid_p</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract bias and MSE for plotting</span></span>
<span><span class="va">bias_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mask_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">bias</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mse_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mask_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mse</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean absolute bias vs masking probability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_values</span>, <span class="va">bias_mat</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Masking Probability (p)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Mean Absolute Bias"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Bias vs Masking Probability"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean MSE vs masking probability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p_values</span>, <span class="va">mse_mat</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Masking Probability (p)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Mean MSE"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"MSE vs Masking Probability"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="exponential_series_files/figure-html/masking-sensitivity-plot-1.png" class="r-plt" width="768"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mask_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    Mean_Abs_Bias <span class="op">=</span> <span class="va">bias_mat</span>,</span>
<span>    Mean_MSE <span class="op">=</span> <span class="va">mse_mat</span>,</span>
<span>    Mean_RMSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mse_mat</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mask_df</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Effect of Masking Probability on Estimation Accuracy"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Masking Prob."</span>, <span class="st">"Mean |Bias|"</span>, <span class="st">"Mean MSE"</span>, <span class="st">"Mean RMSE"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Effect of Masking Probability on Estimation Accuracy</caption>
<thead><tr class="header">
<th align="right">Masking Prob.</th>
<th align="right">Mean |Bias|</th>
<th align="right">Mean MSE</th>
<th align="right">Mean RMSE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.0</td>
<td align="right">0.0092</td>
<td align="right">0.0148</td>
<td align="right">0.1218</td>
</tr>
<tr class="even">
<td align="right">0.1</td>
<td align="right">0.0120</td>
<td align="right">0.0187</td>
<td align="right">0.1368</td>
</tr>
<tr class="odd">
<td align="right">0.2</td>
<td align="right">0.0082</td>
<td align="right">0.0211</td>
<td align="right">0.1451</td>
</tr>
<tr class="even">
<td align="right">0.3</td>
<td align="right">0.0152</td>
<td align="right">0.0325</td>
<td align="right">0.1802</td>
</tr>
<tr class="odd">
<td align="right">0.4</td>
<td align="right">0.0142</td>
<td align="right">0.0396</td>
<td align="right">0.1991</td>
</tr>
<tr class="even">
<td align="right">0.5</td>
<td align="right">0.0260</td>
<td align="right">0.0623</td>
<td align="right">0.2495</td>
</tr>
</tbody>
</table>
<p>The simulation reveals several patterns in how masking degrades
estimation quality:</p>
<ul>
<li><p><strong>MSE increases monotonically</strong> from 0.015
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p = 0</annotation></semantics></math>)
to 0.062
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">p = 0.5</annotation></semantics></math>)
â€” a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.2</mn><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">4.2\times</annotation></semantics></math>
degradation. RMSE roughly doubles from 0.12 to 0.25, meaning the typical
estimation error doubles when moving from unmasked to maximally masked
candidate sets.</p></li>
<li><p><strong>Variance drives the degradation, not bias.</strong> Mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mtext mathvariant="normal">bias</mtext><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|\text{bias}|</annotation></semantics></math>
fluctuates between 0.008 and 0.026 with no systematic trend, while
variance grows steadily with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>.
This is consistent with the theoretical result that conditions C1â€“C3
preserve the unbiasedness of the MLE â€” masking erodes <em>precision</em>
without introducing systematic error.</p></li>
<li><p><strong>The marginal cost of masking accelerates.</strong> MSE
roughly doubles from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p = 0</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">p = 0.3</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.015</mn><mo>â†’</mo><mn>0.033</mn></mrow><annotation encoding="application/x-tex">0.015 \to 0.033</annotation></semantics></math>),
then roughly doubles again from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">p = 0.3</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">p = 0.5</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.033</mn><mo>â†’</mo><mn>0.062</mn></mrow><annotation encoding="application/x-tex">0.033 \to 0.062</annotation></semantics></math>).
For practitioners, this means moderate masking
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>â‰¤</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">p \leq 0.3</annotation></semantics></math>)
is far less costly than heavy masking.</p></li>
<li><p><strong>Residual MSE at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p = 0</annotation></semantics></math>.</strong>
Even with no masking of non-failed components, MSE of 0.015 remains due
to right-censoring alone â€” a useful baseline for isolating the censoring
contribution.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="effect-of-right-censoring-rate">Effect of Right-Censoring Rate<a class="anchor" aria-label="anchor" href="#effect-of-right-censoring-rate"></a>
</h3>
<p>Right-censoring reduces the number of exact failure times observed.
When a system is right-censored, we know the system survived beyond the
censoring time, but we donâ€™t observe the actual failure time or failed
component.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Censoring quantiles (proportion surviving past tau)</span></span>
<span><span class="co"># q = 0.1 means 10% survive past tau (light censoring, ~10% censored)</span></span>
<span><span class="co"># q = 0.9 means 90% survive past tau (heavy censoring, ~90% censored)</span></span>
<span><span class="va">q_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>  <span class="co"># Survival probabilities (matches simulation framework)</span></span>
<span></span>
<span><span class="co"># Fixed masking probability</span></span>
<span><span class="va">p_cens</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span></span>
<span><span class="co"># Storage</span></span>
<span><span class="va">cens_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">q_idx</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">q_values</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">q_curr</span> <span class="op">&lt;-</span> <span class="va">q_values</span><span class="op">[</span><span class="va">q_idx</span><span class="op">]</span></span>
<span>    <span class="va">tau_curr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">q_curr</span><span class="op">)</span>, <span class="va">n_sens</span><span class="op">)</span></span>
<span>    <span class="va">est_q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B_sens</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B_sens</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="co"># Generate data</span></span>
<span>        <span class="va">comp_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="va">n_sens</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span> <span class="va">comp_b</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n_sens</span>, <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">comp_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/md_encode_matrix.html">md_encode_matrix</a></span><span class="op">(</span><span class="va">comp_b</span>, <span class="st">"t"</span><span class="op">)</span></span>
<span></span>
<span>        <span class="va">data_b</span> <span class="op">&lt;-</span> <span class="va">comp_b</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu"><a href="../reference/md_series_lifetime_right_censoring.html">md_series_lifetime_right_censoring</a></span><span class="op">(</span><span class="va">tau_curr</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu"><a href="../reference/md_bernoulli_cand_c1_c2_c3.html">md_bernoulli_cand_c1_c2_c3</a></span><span class="op">(</span><span class="va">p_cens</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>            <span class="fu"><a href="../reference/md_cand_sampler.html">md_cand_sampler</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="va">data_b</span><span class="op">$</span><span class="va">omega</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">data_b</span><span class="op">$</span><span class="va">delta</span>, <span class="st">"exact"</span>, <span class="st">"right"</span><span class="op">)</span></span>
<span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>            <span class="va">fit_b</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">data_b</span>, par <span class="op">=</span> <span class="va">theta0</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span>            <span class="kw">if</span> <span class="op">(</span><span class="va">fit_b</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span> <span class="va">est_q</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_b</span><span class="op">$</span><span class="va">par</span></span>
<span>        <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># Compute statistics</span></span>
<span>    <span class="va">valid_q</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">est_q</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">cens_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">data_b</span><span class="op">$</span><span class="va">omega</span> <span class="op">==</span> <span class="st">"right"</span><span class="op">)</span>  <span class="co"># Actual censoring rate</span></span>
<span>    <span class="va">cens_results</span><span class="op">[[</span><span class="va">q_idx</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        q <span class="op">=</span> <span class="va">q_curr</span>,</span>
<span>        cens_rate <span class="op">=</span> <span class="va">cens_rate</span>,</span>
<span>        bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">est_q</span><span class="op">[</span><span class="va">valid_q</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">theta</span>,</span>
<span>        variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">est_q</span><span class="op">[</span><span class="va">valid_q</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span>,</span>
<span>        mse <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">est_q</span><span class="op">[</span><span class="va">valid_q</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="va">theta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">est_q</span><span class="op">[</span><span class="va">valid_q</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract statistics</span></span>
<span><span class="va">cens_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cens_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">cens_rate</span><span class="op">)</span></span>
<span><span class="va">bias_cens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cens_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">bias</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mse_cens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cens_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mse</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean absolute bias vs censoring rate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cens_rates</span> <span class="op">*</span> <span class="fl">100</span>, <span class="va">bias_cens</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Censoring Rate (%)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Mean Absolute Bias"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Bias vs Censoring Rate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mean MSE vs censoring rate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cens_rates</span> <span class="op">*</span> <span class="fl">100</span>, <span class="va">mse_cens</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Censoring Rate (%)"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Mean MSE"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"MSE vs Censoring Rate"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="exponential_series_files/figure-html/censoring-sensitivity-plot-1.png" class="r-plt" width="768"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cens_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Cens_Rate_Pct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cens_rates</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    Mean_Abs_Bias <span class="op">=</span> <span class="va">bias_cens</span>,</span>
<span>    Mean_MSE <span class="op">=</span> <span class="va">mse_cens</span>,</span>
<span>    Mean_RMSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mse_cens</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">cens_df</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Effect of Right-Censoring Rate on Estimation Accuracy"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Censoring %"</span>, <span class="st">"Mean |Bias|"</span>, <span class="st">"Mean MSE"</span>, <span class="st">"Mean RMSE"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Effect of Right-Censoring Rate on Estimation Accuracy</caption>
<thead><tr class="header">
<th align="right">Censoring %</th>
<th align="right">Mean |Bias|</th>
<th align="right">Mean MSE</th>
<th align="right">Mean RMSE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">10.0</td>
<td align="right">0.0049</td>
<td align="right">0.0193</td>
<td align="right">0.1391</td>
</tr>
<tr class="even">
<td align="right">20.0</td>
<td align="right">0.0126</td>
<td align="right">0.0244</td>
<td align="right">0.1561</td>
</tr>
<tr class="odd">
<td align="right">30.1</td>
<td align="right">0.0135</td>
<td align="right">0.0279</td>
<td align="right">0.1672</td>
</tr>
<tr class="even">
<td align="right">40.2</td>
<td align="right">0.0113</td>
<td align="right">0.0333</td>
<td align="right">0.1824</td>
</tr>
<tr class="odd">
<td align="right">50.2</td>
<td align="right">0.0143</td>
<td align="right">0.0402</td>
<td align="right">0.2005</td>
</tr>
<tr class="even">
<td align="right">60.2</td>
<td align="right">0.0185</td>
<td align="right">0.0497</td>
<td align="right">0.2230</td>
</tr>
<tr class="odd">
<td align="right">69.9</td>
<td align="right">0.0310</td>
<td align="right">0.0590</td>
<td align="right">0.2429</td>
</tr>
<tr class="even">
<td align="right">80.2</td>
<td align="right">0.0138</td>
<td align="right">0.0876</td>
<td align="right">0.2959</td>
</tr>
<tr class="odd">
<td align="right">90.1</td>
<td align="right">0.0341</td>
<td align="right">0.1829</td>
<td align="right">0.4276</td>
</tr>
</tbody>
</table>
<p>The simulation reveals that censoring is the dominant source of
information loss in this model:</p>
<ul>
<li><p><strong>MSE grows from 0.019 (10% censored) to 0.183 (90%
censored)</strong> â€” a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9.5</mn><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">9.5\times</annotation></semantics></math>
degradation, far exceeding the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.2</mn><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">4.2\times</annotation></semantics></math>
range from masking. Censoring is more damaging because it eliminates
<em>both</em> the failure time and the candidate set, whereas masking
only dilutes the candidate set.</p></li>
<li><p><strong>Convex MSE growth, accelerating sharply above
70%.</strong> MSE grows gradually from 10% to 70% censoring
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.019</mn><mo>â†’</mo><mn>0.059</mn></mrow><annotation encoding="application/x-tex">0.019 \to 0.059</annotation></semantics></math>,
roughly linear), then accelerates:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.088</mn><annotation encoding="application/x-tex">0.088</annotation></semantics></math>
at 80% and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.183</mn><annotation encoding="application/x-tex">0.183</annotation></semantics></math>
at 90%. The inflection point is near 70â€“80% censoring, beyond which each
additional percentage point of censoring is dramatically more
damaging.</p></li>
<li><p><strong>Bias remains modest even under extreme
censoring.</strong> Mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mtext mathvariant="normal">bias</mtext><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|\text{bias}|</annotation></semantics></math>
grows from 0.005 (10% censoring) to 0.034 (90% censoring) but stays
small relative to the true rates
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ¼</mo><mn>3</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\sim 3\%</annotation></semantics></math>
at worst). The MLE remains approximately unbiased â€” it is consistent but
increasingly inefficient.</p></li>
<li><p><strong>Robustness under extreme censoring.</strong> At 90%
censoring, only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ¼</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">\sim 50</annotation></semantics></math>
of 500 observations are exact failures, yet the MLE still converges. The
resulting estimates are imprecise (RMSE
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>â‰ˆ</mo><mn>0.43</mn></mrow><annotation encoding="application/x-tex">\approx 0.43</annotation></semantics></math>,
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ¼</mo><mn>40</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\sim 40\%</annotation></semantics></math>
of the true rates), but the likelihood-based approach remains
functional.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="practical-recommendations">Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h3>
<p>Based on these sensitivity analyses:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Prioritize reducing censoring over masking.</strong>
Censoring degrades MSE by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>9.5</mn><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">9.5\times</annotation></semantics></math>
across its range versus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4.2</mn><mo>Ã—</mo></mrow><annotation encoding="application/x-tex">4.2\times</annotation></semantics></math>
for masking. In experimental design, extending the observation window to
reduce censoring below 50% yields larger gains than improving diagnostic
resolution to reduce masking.</p></li>
<li><p><strong>Moderate masking is tolerable.</strong> MSE only doubles
from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p = 0</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">p = 0.3</annotation></semantics></math>.
If reducing the masking probability below 0.3 requires expensive
diagnostic equipment, the incremental benefit may not justify the
cost.</p></li>
<li><p><strong>The 70% censoring threshold.</strong> Below
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ¼</mo><mn>70</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">\sim 70\%</annotation></semantics></math>
censoring, MSE growth is roughly linear and moderate. Above 70%, MSE
accelerates sharply â€” avoid experimental designs where more than
two-thirds of systems survive past the observation window.</p></li>
<li><p><strong>CI widths for sample size planning.</strong> At
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>7500</mn></mrow><annotation encoding="application/x-tex">n = 7500</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">p = 0.3</annotation></semantics></math>
and 25% censoring, 95% CI widths are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ¼</mo><mn>0.17</mn></mrow><annotation encoding="application/x-tex">\sim 0.17</annotation></semantics></math>
for rates near 1.0. Width scales as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">1/\sqrt{n}</annotation></semantics></math>,
so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1875</mn></mrow><annotation encoding="application/x-tex">n = 1875</annotation></semantics></math>
gives widths of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ¼</mo><mn>0.34</mn></mrow><annotation encoding="application/x-tex">\sim 0.34</annotation></semantics></math>
(double), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>30000</mn></mrow><annotation encoding="application/x-tex">n = 30000</annotation></semantics></math>
gives
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âˆ¼</mo><mn>0.085</mn></mrow><annotation encoding="application/x-tex">\sim 0.085</annotation></semantics></math>
(half).</p></li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
