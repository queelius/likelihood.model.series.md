<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Censoring Types in Series System Masked Data • likelihood.model.series.md</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Censoring Types in Series System Masked Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">likelihood.model.series.md</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/queelius/likelihood.model.series.md/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Censoring Types in Series System Masked Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/likelihood.model.series.md/blob/HEAD/vignettes/censoring_comparison.Rmd" class="external-link"><code>vignettes/censoring_comparison.Rmd</code></a></small>
      <div class="d-none name"><code>censoring_comparison.Rmd</code></div>
    </div>

    
    
<p>This vignette compares the four observation types supported by the
<code>likelihood.model.series.md</code> package across all three
likelihood models: exponential, homogeneous Weibull, and heterogeneous
Weibull. We study how the choice of monitoring scheme—and hence the mix
of censoring types—affects the information content of the data and the
quality of maximum likelihood estimates.</p>
<div class="section level2">
<h2 id="observation-types">Overview of Observation Types<a class="anchor" aria-label="anchor" href="#observation-types"></a>
</h2>
<p>When monitoring a series system, the observation mechanism determines
what we learn about the system failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T_i = \min(T_{i1}, \ldots, T_{im})</annotation></semantics></math>.
The package supports four observation types, each arising from a
different monitoring design.</p>
<p><strong>Exact</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">exact</mtext></mrow><annotation encoding="application/x-tex">\omega_i = \text{exact}</annotation></semantics></math>).
The system failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>
is observed directly. This occurs under continuous monitoring when the
system fails during the study period. The log-likelihood contribution is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mi>i</mi><mtext mathvariant="normal">exact</mtext></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\ell_i^{\text{exact}}(\theta) = \log S(t_i; \theta) + \log h_c(t_i; \theta),
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t)</annotation></semantics></math>
is the system survival function and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></msub><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_c(t) = \sum_{j \in c_i} h_j(t)</annotation></semantics></math>
is the candidate-set hazard.</p>
<p><strong>Right-censored</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">right</mtext></mrow><annotation encoding="application/x-tex">\omega_i = \text{right}</annotation></semantics></math>).
The system is known to have survived past time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>,
but the actual failure time is unknown. This arises when the study ends
before the system fails. The contribution is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mi>i</mi><mtext mathvariant="normal">right</mtext></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell_i^{\text{right}}(\theta) = \log S(t_i; \theta).
</annotation></semantics></math> Note that right-censored observations
carry no candidate set information.</p>
<p><strong>Left-censored</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">left</mtext></mrow><annotation encoding="application/x-tex">\omega_i = \text{left}</annotation></semantics></math>).
The system is known to have failed before inspection time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math>,
but we do not know when. This occurs in a single-inspection design: if
the system is found failed at inspection, the failure time is
left-censored at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math>.
The contribution is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mi>i</mi><mtext mathvariant="normal">left</mtext></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><msub><mi>w</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>τ</mi><mi>i</mi></msub><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
\ell_i^{\text{left}}(\theta) = \log w_c(\theta) + \log F(\tau_i; \theta),
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><msub><mi>τ</mi><mi>i</mi></msub></msubsup><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mi>/</mi><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>τ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_c(\theta) = \int_0^{\tau_i} h_c(t) S(t)\, dt / F(\tau_i)</annotation></semantics></math>
is the candidate cause weight and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>τ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>τ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\tau_i) = 1 - S(\tau_i)</annotation></semantics></math>.</p>
<p><strong>Interval-censored</strong>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">interval</mtext></mrow><annotation encoding="application/x-tex">\omega_i = \text{interval}</annotation></semantics></math>).
The failure occurred in a known interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a_i, b_i)</annotation></semantics></math>.
This arises from periodic inspections: the system was functioning at
time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>i</mi></msub><annotation encoding="application/x-tex">a_i</annotation></semantics></math>
and found failed at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>i</mi></msub><annotation encoding="application/x-tex">b_i</annotation></semantics></math>.
The contribution is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mi>i</mi><mtext mathvariant="normal">interval</mtext></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><msubsup><mo>∫</mo><msub><mi>a</mi><mi>i</mi></msub><msub><mi>b</mi><mi>i</mi></msub></msubsup><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>t</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
\ell_i^{\text{interval}}(\theta) = \log \int_{a_i}^{b_i} h_c(t) S(t)\, dt.
</annotation></semantics></math></p>
<p><strong>Information ordering.</strong> Intuitively, exact
observations are the most informative since they pin down
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>
precisely. Right-censored observations provide only a lower bound.
Left-censored observations provide only an upper bound.
Interval-censored observations bracket
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>
from both sides, typically making them more informative than one-sided
censoring:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">exact</mtext><mspace width="0.278em"></mspace><mo>&gt;</mo><mspace width="0.278em"></mspace><mtext mathvariant="normal">interval</mtext><mspace width="0.278em"></mspace><mo>&gt;</mo><mspace width="0.278em"></mspace><mtext mathvariant="normal">left</mtext><mo>≈</mo><mtext mathvariant="normal">right</mtext><mi>.</mi></mrow><annotation encoding="application/x-tex">
\text{exact} \;&gt;\; \text{interval} \;&gt;\; \text{left} \approx \text{right}.
</annotation></semantics></math> The relative ranking of left versus
right depends on the hazard structure; for exponential models they are
roughly symmetric.</p>
</div>
<div class="section level2">
<h2 id="observe-functors">Data Generation with Observe Functors<a class="anchor" aria-label="anchor" href="#observe-functors"></a>
</h2>
<p>The package provides composable <em>observe functors</em> that
translate a true system failure time into an observed record. Each
functor returns a list with elements <code>t</code> (observed time),
<code>omega</code> (observation type), and <code>t_upper</code> (upper
bound, for interval-censoring only).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Right-censoring: continuous monitoring, study ends at tau</span></span>
<span><span class="va">obs_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu">obs_right</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>   <span class="co"># failure before tau -&gt; exact</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "exact"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="fu">obs_right</span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>  <span class="co"># survival past tau  -&gt; right-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "right"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span><span class="co"># 2. Left-censoring: single inspection at tau</span></span>
<span><span class="va">obs_left</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu">obs_left</span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>    <span class="co"># failed before inspection -&gt; left-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "left"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="fu">obs_left</span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>   <span class="co"># surviving at inspection  -&gt; right-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "right"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span><span class="co"># 3. Periodic inspection: inspections every delta, study ends at tau</span></span>
<span><span class="va">obs_periodic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">2</span>, tau <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu">obs_periodic</span><span class="op">(</span><span class="fl">5.3</span><span class="op">)</span>  <span class="co"># failure in (4, 6) -&gt; interval-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "interval"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="fu">obs_periodic</span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>   <span class="co"># survival past tau -&gt; right-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "right"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span><span class="co"># 4. Mixture: compose arbitrary monitoring schemes</span></span>
<span><span class="va">obs_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">2</span>, tau <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code>observe_mixture</code> functor is the key to building
realistic monitoring scenarios. For each observation, it randomly
selects one of the constituent schemes according to the supplied
weights. This models heterogeneous monitoring environments where
different units are observed differently—some under continuous
monitoring, others inspected periodically.</p>
<p>All <code><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata()</a></code> methods accept an <code>observe</code>
argument:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.1</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">gen</span><span class="op">(</span><span class="va">theta</span>, n <span class="op">=</span> <span class="fl">200</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>          observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.5</span>, tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observation type distribution:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observation type distribution:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; interval </span></span>
<span><span class="co">#&gt;      200</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exponential-verification">Exponential Model: Closed-Form Verification<a class="anchor" aria-label="anchor" href="#exponential-verification"></a>
</h2>
<p>The exponential model is special: all four observation types have
fully analytical log-likelihood, score, and Hessian. We verify this on a
small mixed-censoring example with one observation of each type.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Construct one observation of each type</span></span>
<span><span class="va">df_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  t       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.0</span>,  <span class="fl">8.0</span>,  <span class="fl">5.0</span>,  <span class="fl">2.0</span><span class="op">)</span>,</span>
<span>  t_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,   <span class="cn">NA</span>,   <span class="cn">NA</span>,   <span class="fl">6.0</span><span class="op">)</span>,</span>
<span>  omega   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exact"</span>, <span class="st">"right"</span>, <span class="st">"left"</span>, <span class="st">"interval"</span><span class="op">)</span>,</span>
<span>  x1      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,  <span class="cn">FALSE</span>, <span class="cn">TRUE</span>,  <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  x2      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,  <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  x3      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>,  <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">lambda_sys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">rates</span><span class="op">)</span></span></code></pre></div>
<p>For the exponential model with rates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.5</mn><mo>,</mo><mn>0.3</mn><mo>,</mo><mn>0.2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\lambda = (0.5, 0.3, 0.2)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub><mo>=</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">\lambda_{\text{sys}} = 1.0</annotation></semantics></math>,
the individual contributions are:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Exact</mtext><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>=</mo><mn>3</mn><mo>,</mo><mi>c</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo></mtd><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.8</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>1.0</mn><mo>⋅</mo><mn>3</mn><mo>=</mo><mo>−</mo><mn>3.2231</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Right</mtext><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>=</mo><mn>8</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo></mtd><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mo>−</mo><mn>1.0</mn><mo>⋅</mo><mn>8</mn><mo>=</mo><mo>−</mo><mn>8</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Left</mtext><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>τ</mi><mo>=</mo><mn>5</mn><mo>,</mo><mi>c</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo></mtd><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.7</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>5</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1.0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mn>0.3634</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Interval</mtext><mspace width="0.222em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>b</mi><mo>=</mo><mn>6</mn><mo>,</mo><mi>c</mi><mo>=</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo stretchy="false" form="postfix">}</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>:</mo></mtd><mtd columnalign="left" style="text-align: left"><mspace width="1.0em"></mspace><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.8</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>2</mn><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>4</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1.0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mn>2.2416</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
\text{Exact}\ (t{=}3, c{=}\{1,2\}):&amp; \quad
  \log(0.8) - 1.0 \cdot 3 = -3.2231 \\
\text{Right}\ (t{=}8):&amp; \quad
  -1.0 \cdot 8 = -8 \\
\text{Left}\ (\tau{=}5, c{=}\{1,3\}):&amp; \quad
  \log(0.7) + \log(1 - e^{-5}) - \log(1.0) = -0.3634 \\
\text{Interval}\ (a{=}2, b{=}6, c{=}\{1,2\}):&amp; \quad
  \log(0.8) - 2 + \log(1 - e^{-4}) - \log(1.0) = -2.2416
\end{align}</annotation></semantics></math></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ll_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span><span class="va">scr_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/score.html" class="external-link">score</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Total log-likelihood</span></span>
<span><span class="va">ll_val</span> <span class="op">&lt;-</span> <span class="fu">ll_fn</span><span class="op">(</span><span class="va">df_mixed</span>, <span class="va">rates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Log-likelihood:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ll_val</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Log-likelihood: -13.83</span></span>
<span></span>
<span><span class="co"># Expected from hand calculation</span></span>
<span><span class="va">ll_exact</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span> <span class="op">-</span> <span class="va">lambda_sys</span> <span class="op">*</span> <span class="fl">3</span></span>
<span><span class="va">ll_right</span>    <span class="op">&lt;-</span> <span class="op">-</span><span class="va">lambda_sys</span> <span class="op">*</span> <span class="fl">8</span></span>
<span><span class="va">ll_left</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">expm1</a></span><span class="op">(</span><span class="op">-</span><span class="va">lambda_sys</span> <span class="op">*</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">lambda_sys</span><span class="op">)</span></span>
<span><span class="va">ll_interval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span> <span class="op">-</span> <span class="va">lambda_sys</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">expm1</a></span><span class="op">(</span><span class="op">-</span><span class="va">lambda_sys</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">lambda_sys</span><span class="op">)</span></span>
<span><span class="va">ll_expected</span> <span class="op">&lt;-</span> <span class="va">ll_exact</span> <span class="op">+</span> <span class="va">ll_right</span> <span class="op">+</span> <span class="va">ll_left</span> <span class="op">+</span> <span class="va">ll_interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Expected:      "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ll_expected</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Expected:       -13.83</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Match:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">ll_val</span>, <span class="va">ll_expected</span>, tolerance <span class="op">=</span> <span class="fl">1e-10</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Match: TRUE</span></span></code></pre></div>
<p>Now verify that the analytical score is consistent with numerical
differentiation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scr_analytical</span> <span class="op">&lt;-</span> <span class="fu">scr_fn</span><span class="op">(</span><span class="va">df_mixed</span>, <span class="va">rates</span><span class="op">)</span></span>
<span><span class="va">scr_numerical</span> <span class="op">&lt;-</span> <span class="fu">numDeriv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">grad</a></span><span class="op">(</span></span>
<span>  func <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span> <span class="fu">ll_fn</span><span class="op">(</span><span class="va">df_mixed</span>, <span class="va">th</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="va">rates</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">score_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Component <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"lambda_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  Analytical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">scr_analytical</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  Numerical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">scr_numerical</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  Abs_Diff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">scr_analytical</span> <span class="op">-</span> <span class="va">scr_numerical</span><span class="op">)</span>,</span>
<span>                     format <span class="op">=</span> <span class="st">"e"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">score_df</span>, caption <span class="op">=</span> <span class="st">"Score verification: analytical vs numerical"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Score verification: analytical vs numerical</caption>
<thead><tr class="header">
<th align="left">Component</th>
<th align="right">Analytical</th>
<th align="right">Numerical</th>
<th align="left">Abs_Diff</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">lambda_1</td>
<td align="right">-10.96</td>
<td align="right">-10.96</td>
<td align="left">3.46e-10</td>
</tr>
<tr class="even">
<td align="left">lambda_2</td>
<td align="right">-12.39</td>
<td align="right">-12.39</td>
<td align="left">3.85e-10</td>
</tr>
<tr class="odd">
<td align="left">lambda_3</td>
<td align="right">-13.46</td>
<td align="right">-13.46</td>
<td align="left">2.20e-09</td>
</tr>
</tbody>
</table>
<p>The agreement to machine precision confirms that all four observation
types are implemented correctly in the exponential score.</p>
</div>
<div class="section level2">
<h2 id="information-content">Simulation: Information Content by Censoring Mix<a class="anchor" aria-label="anchor" href="#information-content"></a>
</h2>
<p>We now study how the <em>mix</em> of censoring types affects
estimation quality. Using the exponential model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">m = 3</annotation></semantics></math>
components, we generate data under five monitoring configurations and
compare bias, MSE, and coverage.</p>
<p>The five configurations are:</p>
<table class="table">
<colgroup>
<col width="21%">
<col width="34%">
<col width="44%">
</colgroup>
<thead><tr class="header">
<th>Config</th>
<th>Description</th>
<th>Observe Functor</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>100% exact</td>
<td><code>observe_right_censor(tau = Inf)</code></td>
</tr>
<tr class="even">
<td>B</td>
<td>75% exact + 25% right</td>
<td>
<code>observe_right_censor(tau)</code> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
set for 25% censoring</td>
</tr>
<tr class="odd">
<td>C</td>
<td>~75% left + ~25% right</td>
<td>
<code>observe_left_censor(tau)</code> — failed before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
are left-censored, survivors right-censored</td>
</tr>
<tr class="even">
<td>D</td>
<td>75% exact + 12.5% left + 12.5% interval</td>
<td><code>observe_mixture(...)</code></td>
</tr>
<tr class="odd">
<td>E</td>
<td>50% exact + 20% right + 15% left + 15% interval</td>
<td><code>observe_mixture(...)</code></td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.1</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="va">exp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span><span class="va">theta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">m</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># tau for ~25% right-censoring: solve S(tau) = 0.25</span></span>
<span><span class="va">lambda_sys</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">tau_25</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.25</span><span class="op">)</span> <span class="op">/</span> <span class="va">lambda_sys</span></span>
<span></span>
<span><span class="co"># tau for left-censoring: F(tau) ~ 0.75 -&gt; same tau</span></span>
<span><span class="co"># For left_censor(tau), Pr(left) = F(tau), Pr(right) = S(tau)</span></span>
<span></span>
<span><span class="va">configs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"100% exact"</span>,</span>
<span>    observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"75% exact + 25% right"</span>,</span>
<span>    observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="va">tau_25</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"~75% left + ~25% right"</span>,</span>
<span>    observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="va">tau_25</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"mix: exact + left + interval"</span>,</span>
<span>    observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="va">tau_25</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.3</span>, tau <span class="op">=</span> <span class="va">tau_25</span><span class="op">)</span>,</span>
<span>      weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.125</span>, <span class="fl">0.125</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  E <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="st">"mix: all four types"</span>,</span>
<span>    observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="va">tau_25</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="va">tau_25</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.3</span>, tau <span class="op">=</span> <span class="va">tau_25</span><span class="op">)</span>,</span>
<span>      weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.70</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">cfg_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">configs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cfg</span> <span class="op">&lt;-</span> <span class="va">configs</span><span class="op">[[</span><span class="va">cfg_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span>  <span class="va">se_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span>  <span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span>  <span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span>  <span class="va">converged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span>
<span>  <span class="va">omega_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">B</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df_b</span> <span class="op">&lt;-</span> <span class="fu">gen</span><span class="op">(</span><span class="va">theta</span>, n <span class="op">=</span> <span class="va">n</span>, p <span class="op">=</span> <span class="fl">0.3</span>, observe <span class="op">=</span> <span class="va">cfg</span><span class="op">$</span><span class="va">observe</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">b</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">omega_counts</span><span class="op">[[</span><span class="va">cfg_name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_b</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="va">result_b</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">df_b</span>, par <span class="op">=</span> <span class="va">theta0</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span>      <span class="va">estimates</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">result_b</span><span class="op">$</span><span class="va">par</span></span>
<span>      <span class="va">se_estimates</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">result_b</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="va">ci_lower</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">result_b</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">z</span> <span class="op">*</span> <span class="va">se_estimates</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span></span>
<span>      <span class="va">ci_upper</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">result_b</span><span class="op">$</span><span class="va">par</span> <span class="op">+</span> <span class="va">z</span> <span class="op">*</span> <span class="va">se_estimates</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span></span>
<span>      <span class="va">converged</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">result_b</span><span class="op">$</span><span class="va">converged</span></span>
<span>    <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">converged</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">valid</span> <span class="op">&lt;-</span> <span class="va">converged</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">est_valid</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="va">valid</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">est_valid</span><span class="op">)</span> <span class="op">-</span> <span class="va">theta</span></span>
<span>  <span class="va">variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">est_valid</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span></span>
<span>  <span class="va">mse</span> <span class="op">&lt;-</span> <span class="va">bias</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">variance</span></span>
<span></span>
<span>  <span class="va">coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">valid_j</span> <span class="op">&lt;-</span> <span class="va">valid</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ci_lower</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">covered</span> <span class="op">&lt;-</span> <span class="va">ci_lower</span><span class="op">[</span><span class="va">valid_j</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&amp;</span></span>
<span>      <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">ci_upper</span><span class="op">[</span><span class="va">valid_j</span>, <span class="va">j</span><span class="op">]</span></span>
<span>    <span class="va">coverage</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covered</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">sim_results</span><span class="op">[[</span><span class="va">cfg_name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    name <span class="op">=</span> <span class="va">cfg</span><span class="op">$</span><span class="va">name</span>,</span>
<span>    bias <span class="op">=</span> <span class="va">bias</span>,</span>
<span>    variance <span class="op">=</span> <span class="va">variance</span>,</span>
<span>    mse <span class="op">=</span> <span class="va">mse</span>,</span>
<span>    coverage <span class="op">=</span> <span class="va">coverage</span>,</span>
<span>    mean_mse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">mse</span><span class="op">)</span>,</span>
<span>    mean_coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">coverage</span><span class="op">)</span>,</span>
<span>    convergence_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">converged</span><span class="op">)</span>,</span>
<span>    omega_sample <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">omega_counts</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">omega_counts</span><span class="op">[[</span><span class="va">cfg_name</span><span class="op">]</span><span class="op">]</span> <span class="kw">else</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 id="results-table">Results Table<a class="anchor" aria-label="anchor" href="#results-table"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sim_results</span><span class="op">)</span>,</span>
<span>  Description <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">name</span><span class="op">)</span>,</span>
<span>  Mean_Bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">bias</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Mean_MSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">mean_mse</span><span class="op">)</span>,</span>
<span>  Mean_RMSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mean_mse</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Mean_Coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">mean_coverage</span><span class="op">)</span>,</span>
<span>  Conv_Rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">convergence_rate</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>, row.names <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">summary_df</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Estimation quality by monitoring configuration"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Config"</span>, <span class="st">"Description"</span>, <span class="st">"Mean |Bias|"</span>,</span>
<span>                          <span class="st">"Mean MSE"</span>, <span class="st">"Mean RMSE"</span>, <span class="st">"Coverage"</span>, <span class="st">"Conv. Rate"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimation quality by monitoring configuration</caption>
<colgroup>
<col width="7%">
<col width="29%">
<col width="22%">
<col width="9%">
<col width="10%">
<col width="9%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">Config</th>
<th align="left">Description</th>
<th align="right">Mean |Bias|</th>
<th align="right">Mean MSE</th>
<th align="right">Mean RMSE</th>
<th align="right">Coverage</th>
<th align="right">Conv. Rate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">100% exact</td>
<td align="right">0.0077</td>
<td align="right">0.0091</td>
<td align="right">0.0953</td>
<td align="right">0.9450</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">75% exact + 25% right</td>
<td align="right">0.0100</td>
<td align="right">0.0129</td>
<td align="right">0.1137</td>
<td align="right">0.9517</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">~75% left + ~25% right</td>
<td align="right">0.0061</td>
<td align="right">0.0122</td>
<td align="right">0.1106</td>
<td align="right">0.9517</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">mix: exact + left + interval</td>
<td align="right">0.0057</td>
<td align="right">0.0100</td>
<td align="right">0.1002</td>
<td align="right">0.9467</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="left">mix: all four types</td>
<td align="right">0.0074</td>
<td align="right">0.0118</td>
<td align="right">0.1087</td>
<td align="right">0.9400</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cfg_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="va">mse_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">mean_mse</span><span class="op">)</span></span>
<span><span class="va">cov_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">sim_results</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">mean_coverage</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MSE comparison</span></span>
<span><span class="va">bp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">mse_vals</span>, names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sim_results</span><span class="op">)</span>,</span>
<span>              col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"coral"</span>, <span class="st">"goldenrod"</span>, <span class="st">"mediumpurple"</span>, <span class="st">"seagreen"</span><span class="op">)</span>,</span>
<span>              main <span class="op">=</span> <span class="st">"Mean MSE by Configuration"</span>,</span>
<span>              ylab <span class="op">=</span> <span class="st">"Mean MSE"</span>, las <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">bp</span>, <span class="va">mse_vals</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">mse_vals</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.03</span>,</span>
<span>     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mse_vals</span>, <span class="fl">4</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Coverage comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">cov_vals</span>, names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sim_results</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"coral"</span>, <span class="st">"goldenrod"</span>, <span class="st">"mediumpurple"</span>, <span class="st">"seagreen"</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Mean Coverage by Configuration"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Coverage Probability"</span>, las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bp</span>, y <span class="op">=</span> <span class="fl">0.86</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cov_vals</span>, <span class="fl">3</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="st">"Nominal 95%"</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="censoring_comparison_files/figure-html/sim-plot-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level4">
<h4 id="per-component-detail">Per-Component Detail<a class="anchor" aria-label="anchor" href="#per-component-detail"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comp_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">cfg_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sim_results</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">sim_results</span><span class="op">[[</span><span class="va">cfg_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">comp_rows</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">comp_rows</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      Config <span class="op">=</span> <span class="va">cfg_name</span>,</span>
<span>      Component <span class="op">=</span> <span class="va">j</span>,</span>
<span>      True <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      Bias <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">bias</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      MSE <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">mse</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      Coverage <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">comp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">comp_rows</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comp_df</span>, digits <span class="op">=</span> <span class="fl">4</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Per-component estimation metrics by configuration"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Config"</span>, <span class="st">"Comp."</span>, <span class="st">"True"</span>, <span class="st">"Bias"</span>, <span class="st">"MSE"</span>, <span class="st">"Coverage"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Per-component estimation metrics by configuration</caption>
<thead><tr class="header">
<th align="left">Config</th>
<th align="right">Comp.</th>
<th align="right">True</th>
<th align="right">Bias</th>
<th align="right">MSE</th>
<th align="right">Coverage</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">0.0100</td>
<td align="right">0.0104</td>
<td align="right">0.925</td>
</tr>
<tr class="even">
<td align="left">A</td>
<td align="right">2</td>
<td align="right">1.10</td>
<td align="right">-0.0096</td>
<td align="right">0.0098</td>
<td align="right">0.945</td>
</tr>
<tr class="odd">
<td align="left">A</td>
<td align="right">3</td>
<td align="right">0.95</td>
<td align="right">0.0035</td>
<td align="right">0.0070</td>
<td align="right">0.965</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">0.0049</td>
<td align="right">0.0134</td>
<td align="right">0.940</td>
</tr>
<tr class="odd">
<td align="left">B</td>
<td align="right">2</td>
<td align="right">1.10</td>
<td align="right">0.0158</td>
<td align="right">0.0138</td>
<td align="right">0.955</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="right">3</td>
<td align="right">0.95</td>
<td align="right">-0.0094</td>
<td align="right">0.0115</td>
<td align="right">0.960</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">-0.0021</td>
<td align="right">0.0131</td>
<td align="right">0.950</td>
</tr>
<tr class="even">
<td align="left">C</td>
<td align="right">2</td>
<td align="right">1.10</td>
<td align="right">0.0090</td>
<td align="right">0.0135</td>
<td align="right">0.935</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="right">3</td>
<td align="right">0.95</td>
<td align="right">0.0073</td>
<td align="right">0.0102</td>
<td align="right">0.970</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">-0.0030</td>
<td align="right">0.0089</td>
<td align="right">0.960</td>
</tr>
<tr class="odd">
<td align="left">D</td>
<td align="right">2</td>
<td align="right">1.10</td>
<td align="right">-0.0091</td>
<td align="right">0.0118</td>
<td align="right">0.930</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="right">3</td>
<td align="right">0.95</td>
<td align="right">-0.0050</td>
<td align="right">0.0093</td>
<td align="right">0.950</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">-0.0189</td>
<td align="right">0.0124</td>
<td align="right">0.930</td>
</tr>
<tr class="even">
<td align="left">E</td>
<td align="right">2</td>
<td align="right">1.10</td>
<td align="right">-0.0025</td>
<td align="right">0.0122</td>
<td align="right">0.950</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="right">3</td>
<td align="right">0.95</td>
<td align="right">0.0009</td>
<td align="right">0.0109</td>
<td align="right">0.940</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="key-findings">Key Findings<a class="anchor" aria-label="anchor" href="#key-findings"></a>
</h4>
<p>The simulation confirms the information ordering described in the
overview:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Exact observations dominate.</strong> Configuration A
(100% exact) achieves the lowest MSE. Any form of censoring degrades
estimation quality.</p></li>
<li><p><strong>Interval-censoring outperforms one-sided
censoring.</strong> Configuration D achieves lower MSE than B or C.
While D also benefits from a high fraction of exact observations (~71%),
the interval-censored observations bracket the failure time from both
sides, preserving more information than either left- or right-censoring
alone.</p></li>
<li><p><strong>Left-censoring is remarkably informative for the
exponential model.</strong> Configuration C has <em>zero</em> exact
observations — every observation is either left-censored (~75%) or
right-censored (~25%) — yet achieves <em>lower</em> MSE than
Configuration B (75% exact + 25% right). This striking result is a
consequence of the memoryless property: for the exponential model,
knowing that a system failed before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
(left-censored) carries nearly as much information as knowing the exact
failure time. Left-censoring loses surprisingly little information when
the hazard is constant.</p></li>
<li><p><strong>Mixed monitoring is viable.</strong> Configuration E,
which mixes all four observation types, converges reliably and produces
reasonable estimates despite the heterogeneous censoring. This validates
the likelihood’s ability to combine information from disparate
monitoring schemes.</p></li>
<li><p><strong>Coverage remains near nominal.</strong> All
configurations achieve coverage close to 95%, confirming that the
asymptotic Wald intervals are reliable at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">n = 500</annotation></semantics></math>
regardless of the censoring mix.</p></li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="cross-model">Cross-Model Comparison Under Mixed Censoring<a class="anchor" aria-label="anchor" href="#cross-model"></a>
</h2>
<p>We now fit the same mixed-censoring dataset using both the
exponential model and the homogeneous Weibull model (with shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>
to match the exponential DGP). When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>,
the Weibull model nests the exponential: the scale parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><msub><mi>λ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\beta_j = 1/\lambda_j</annotation></semantics></math>
and the log-likelihoods should agree up to reparameterization.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate mixed-censoring data from exponential DGP</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">theta_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.1</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">exp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gen_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_cross</span> <span class="op">&lt;-</span> <span class="fu">gen_exp</span><span class="op">(</span><span class="va">theta_exp</span>, n <span class="op">=</span> <span class="fl">300</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                    observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>                      <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.5</span>, tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                      weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span>                    <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observation types:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observation types:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_cross</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    exact interval     left </span></span>
<span><span class="co">#&gt;      153       91       56</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exponential loglik at true parameters</span></span>
<span><span class="va">ll_exp_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span><span class="va">ll_exp_val</span> <span class="op">&lt;-</span> <span class="fu">ll_exp_fn</span><span class="op">(</span><span class="va">df_cross</span>, <span class="va">theta_exp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Homogeneous Weibull with k=1, scales = 1/rates</span></span>
<span><span class="va">hom_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_homogeneous_md_c1_c2_c3.html">wei_series_homogeneous_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ll_hom_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">hom_model</span><span class="op">)</span></span>
<span><span class="va">scales_from_rates</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">theta_exp</span></span>
<span><span class="va">ll_hom_val</span> <span class="op">&lt;-</span> <span class="fu">ll_hom_fn</span><span class="op">(</span><span class="va">df_cross</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">scales_from_rates</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Exponential log-likelihood:          "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ll_exp_val</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exponential log-likelihood:           -279.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Homogeneous Weibull (k=1) log-likelihood:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ll_hom_val</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Homogeneous Weibull (k=1) log-likelihood: -279.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Difference:                          "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="va">ll_exp_val</span> <span class="op">-</span> <span class="va">ll_hom_val</span>, format <span class="op">=</span> <span class="st">"e"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Difference:                           -3.98e-13</span></span></code></pre></div>
<p>The log-likelihoods agree, confirming that the homogeneous Weibull
model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>
reduces to the exponential model for all observation types, including
left-censored and interval-censored.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit both models</span></span>
<span><span class="va">solver_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span><span class="va">solver_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">hom_model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mle_exp</span> <span class="op">&lt;-</span> <span class="fu">solver_exp</span><span class="op">(</span><span class="va">df_cross</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span><span class="va">mle_hom</span> <span class="op">&lt;-</span> <span class="fu">solver_hom</span><span class="op">(</span><span class="va">df_cross</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Exponential MLE (rates):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mle_exp</span><span class="op">$</span><span class="va">par</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exponential MLE (rates): 0.7856 1.005 0.9203</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Homogeneous Weibull MLE (k, scales):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mle_hom</span><span class="op">$</span><span class="va">par</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Homogeneous Weibull MLE (k, scales): 0.9379 1.334 1.026 1.126</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nExponential loglik at MLE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mle_exp</span><span class="op">$</span><span class="va">loglik</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Exponential loglik at MLE: -277.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Weibull loglik at MLE:    "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mle_hom</span><span class="op">$</span><span class="va">loglik</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Weibull loglik at MLE:     -276.9</span></span></code></pre></div>
<p>The Weibull model achieves a slightly higher (or equal)
log-likelihood at its MLE because it has one additional parameter
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>).
If the true DGP is exponential, the estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>k</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{k}</annotation></semantics></math>
should be close to 1:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Estimated shape k:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">mle_hom</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated shape k: 0.9379</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"(Expected: 1.0 for exponential DGP)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Expected: 1.0 for exponential DGP)</span></span></code></pre></div>
<div class="section level4">
<h4 id="computational-considerations">Computational Considerations<a class="anchor" aria-label="anchor" href="#computational-considerations"></a>
</h4>
<p>The exponential model evaluates all four observation types in closed
form, making it fast even for large datasets. The homogeneous Weibull
model also has closed-form log-likelihood for all types (because the
common shape allows the system survival to remain Weibull). However, its
score uses <code><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">numDeriv::grad</a></code> for left/interval contributions,
making it slower.</p>
<p>The heterogeneous Weibull model requires numerical integration
(<code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">stats::integrate</a></code>) for each left-censored and
interval-censored observation, making it substantially slower. For
datasets with many such observations, computational cost can be
significant.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Time loglik evaluation on mixed-censoring data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">df_large</span> <span class="op">&lt;-</span> <span class="fu">gen_exp</span><span class="op">(</span><span class="va">theta_exp</span>, n <span class="op">=</span> <span class="fl">1000</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                    observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>                      <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                      <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.5</span>, tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                      weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span>                    <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wei_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_md_c1_c2_c3.html">wei_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">ll_wei_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">wei_model</span><span class="op">)</span></span>
<span><span class="va">wei_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="va">theta_exp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="va">theta_exp</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="va">theta_exp</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu">ll_exp_fn</span><span class="op">(</span><span class="va">df_large</span>, <span class="va">theta_exp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">t_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu">ll_hom_fn</span><span class="op">(</span><span class="va">df_large</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="va">theta_exp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">t_wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fu">ll_wei_fn</span><span class="op">(</span><span class="va">df_large</span>, <span class="va">wei_par</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">timing_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Exponential"</span>, <span class="st">"Homogeneous Weibull"</span>, <span class="st">"Heterogeneous Weibull"</span><span class="op">)</span>,</span>
<span>  Time_10_evals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">t_exp</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>, <span class="va">t_hom</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span>,</span>
<span>                          <span class="va">t_wei</span><span class="op">[</span><span class="st">"elapsed"</span><span class="op">]</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Closed-form"</span>, <span class="st">"Closed-form"</span>, <span class="st">"Numerical integration"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">timing_df</span>, caption <span class="op">=</span> <span class="st">"Log-likelihood evaluation time (10 evaluations, n=1000)"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model"</span>, <span class="st">"Time (s)"</span>, <span class="st">"Left/Interval Method"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Log-likelihood evaluation time (10 evaluations,
n=1000)</caption>
<thead><tr class="header">
<th align="left">Model</th>
<th align="right">Time (s)</th>
<th align="left">Left/Interval Method</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Exponential</td>
<td align="right">0.069</td>
<td align="left">Closed-form</td>
</tr>
<tr class="even">
<td align="left">Homogeneous Weibull</td>
<td align="right">0.099</td>
<td align="left">Closed-form</td>
</tr>
<tr class="odd">
<td align="left">Heterogeneous Weibull</td>
<td align="right">0.690</td>
<td align="left">Numerical integration</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="recommendations">Practical Recommendations<a class="anchor" aria-label="anchor" href="#recommendations"></a>
</h2>
<p>Based on the analysis in this vignette, we offer several guidelines
for practitioners designing reliability studies and choosing likelihood
models.</p>
<p><strong>When to invest in interval-censored data.</strong> If
continuous monitoring is infeasible, periodic inspections that produce
interval-censored data are preferable to single inspections that produce
left-censored data. The information gain from bracketing the failure
time is substantial: our simulation shows that interval-censored
observations reduce MSE relative to one-sided censoring, often
approaching the quality of exact observations when the inspection
interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
is small.</p>
<p><strong>Trade-off: inspection frequency vs. cost.</strong> Shorter
inspection intervals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
produce tighter brackets and more informative interval-censored data,
but at higher monitoring cost. A useful heuristic: set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
to be a fraction of the expected system lifetime, e.g.,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>≈</mo><mn>0.1</mn><mi>/</mi><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub></mrow><annotation encoding="application/x-tex">\delta \approx 0.1 / \lambda_{\text{sys}}</annotation></semantics></math>
for the exponential model. This ensures that most intervals contain
meaningful probability mass.</p>
<p><strong>Choosing the right model.</strong> When the data includes
left-censored or interval-censored observations:</p>
<ul>
<li>The <strong>exponential model</strong> is fastest (all closed-form)
and should be the first choice when constant hazard is plausible.</li>
<li>The <strong>homogeneous Weibull</strong> is nearly as fast
(closed-form loglik, numerical score for left/interval) and adds
wear-out or burn-in modeling via the shared shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>.</li>
<li>The <strong>heterogeneous Weibull</strong> is the most flexible but
slowest due to numerical integration for each left/interval observation.
Reserve it for settings where components genuinely have different aging
characteristics.</li>
</ul>
<p><strong>Computational budget.</strong> For the heterogeneous Weibull
model with many left- or interval-censored observations, each
log-likelihood evaluation involves
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mtext mathvariant="normal">left</mtext></msub><mo>+</mo><msub><mi>n</mi><mtext mathvariant="normal">interval</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n_{\text{left}} + n_{\text{interval}})</annotation></semantics></math>
calls to <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">stats::integrate</a></code>. This makes MLE optimization
significantly slower. Strategies to manage this include:</p>
<ul>
<li>Using the homogeneous Weibull as a starting point, then refitting
with heterogeneous shapes.</li>
<li>Reducing the number of left/interval observations (e.g., by
extending the study period to convert more observations to exact or
right-censored).</li>
<li>Using the exponential model for initial exploration and switching to
Weibull only when the data clearly supports non-constant hazard.</li>
</ul>
<p><strong>Mixed monitoring is practical.</strong> Real reliability
studies often combine continuous monitoring of some units with periodic
inspection of others. The <code>observe_mixture</code> functor and the
unified likelihood framework handle this seamlessly. The key insight is
that each observation contributes to the likelihood according to its
type, and combining them is straightforward—no special adjustments are
needed beyond specifying the correct
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ω</mi><annotation encoding="application/x-tex">\omega</annotation></semantics></math>
column.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
