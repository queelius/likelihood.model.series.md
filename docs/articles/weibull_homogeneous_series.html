<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Homogeneous Weibull Series Systems: Shared Shape Parameter ‚Ä¢ likelihood.model.series.md</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Homogeneous Weibull Series Systems: Shared Shape Parameter">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">likelihood.model.series.md</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/queelius/likelihood.model.series.md/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Homogeneous Weibull Series Systems: Shared Shape Parameter</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/likelihood.model.series.md/blob/HEAD/vignettes/weibull_homogeneous_series.Rmd" class="external-link"><code>vignettes/weibull_homogeneous_series.Rmd</code></a></small>
      <div class="d-none name"><code>weibull_homogeneous_series.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="theory">Theory<a class="anchor" aria-label="anchor" href="#theory"></a>
</h2>
<div class="section level3">
<h3 id="component-lifetime-model">Component lifetime model<a class="anchor" aria-label="anchor" href="#component-lifetime-model"></a>
</h3>
<p>Consider a series system with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components where each component lifetime follows a Weibull distribution
with a <strong>common shape parameter</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
but individual scale parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>Œ≤</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\beta_1, \ldots, \beta_m</annotation></semantics></math>.
The parameter vector is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ∏</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><msub><mi>Œ≤</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>Œ≤</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àà</mo><msubsup><mi>‚Ñù</mi><mrow><mo>&gt;</mo><mn>0</mn></mrow><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \theta = (k, \beta_1, \ldots, \beta_m) \in \mathbb{R}^{m+1}_{&gt;0}.
</annotation></semantics></math></p>
<p>The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
component has hazard function
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>‚à£</mo><mi>k</mi><mo>,</mo><msub><mi>Œ≤</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>k</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>,</mo><mspace width="1.0em"></mspace><mi>t</mi><mo>&gt;</mo><mn>0</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">
  h_j(t \mid k, \beta_j) = \frac{k}{\beta_j}
    \left(\frac{t}{\beta_j}\right)^{k-1}, \quad t &gt; 0,
</annotation></semantics></math> survival function
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>‚à£</mo><mi>k</mi><mo>,</mo><msub><mi>Œ≤</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
  R_j(t \mid k, \beta_j) = \exp\!\left(-\left(\frac{t}{\beta_j}\right)^k\right),
</annotation></semantics></math> and pdf
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>‚à£</mo><mi>k</mi><mo>,</mo><msub><mi>Œ≤</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>k</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>exp</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  f_j(t \mid k, \beta_j) = h_j(t) \, R_j(t)
    = \frac{k}{\beta_j}\left(\frac{t}{\beta_j}\right)^{k-1}
      \exp\!\left(-\left(\frac{t}{\beta_j}\right)^k\right).
</annotation></semantics></math></p>
<p>The shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
controls the failure rate behaviour:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k &lt; 1</annotation></semantics></math>:
decreasing failure rate (DFR) ‚Äì infant mortality, burn-in</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>:
constant failure rate (CFR) ‚Äì exponential distribution</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k &gt; 1</annotation></semantics></math>:
increasing failure rate (IFR) ‚Äì wear-out, aging</li>
</ul>
</div>
<div class="section level3">
<h3 id="system-lifetime">System lifetime<a class="anchor" aria-label="anchor" href="#system-lifetime"></a>
</h3>
<p>The system lifetime
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><msub><mi>T</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T = \min(T_1, \ldots, T_m)</annotation></semantics></math>
has reliability
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mtext mathvariant="normal">sys</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>‚à£</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àè</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  R_{\text{sys}}(t \mid \theta) = \prod_{j=1}^m R_j(t)
    = \exp\!\left(-\sum_{j=1}^m \left(\frac{t}{\beta_j}\right)^k\right).
</annotation></semantics></math></p>
<p>Because all components share the same shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
the exponent simplifies:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo>=</mo><msup><mi>t</mi><mi>k</mi></msup><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msubsup><mi>Œ≤</mi><mi>j</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo>,</mo></mrow><annotation encoding="application/x-tex">
  \sum_{j=1}^m \left(\frac{t}{\beta_j}\right)^k
    = t^k \sum_{j=1}^m \beta_j^{-k}
    = \left(\frac{t}{\beta_{\text{sys}}}\right)^k,
</annotation></semantics></math> where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msubsup><mi>Œ≤</mi><mi>j</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn><mi>/</mi><mi>k</mi></mrow></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \beta_{\text{sys}} = \left(\sum_{j=1}^m \beta_j^{-k}\right)^{-1/k}.
</annotation></semantics></math> Thus, the system lifetime is itself
Weibull with shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
and scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub><annotation encoding="application/x-tex">\beta_{\text{sys}}</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>‚àº</mo><mo>Weibull</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  T \sim \operatorname{Weibull}(k, \beta_{\text{sys}}).
</annotation></semantics></math> This closure under the minimum
operation is the defining structural advantage of the homogeneous model
and is computed by <code>wei_series_system_scale(k, scales)</code>.</p>
</div>
<div class="section level3">
<h3 id="conditional-cause-probability">Conditional cause probability<a class="anchor" aria-label="anchor" href="#conditional-cause-probability"></a>
</h3>
<p>The conditional probability that component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
caused the system failure at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>=</mo><mi>j</mi><mo>‚à£</mo><mi>T</mi><mo>=</mo><mi>t</mi><mo>,</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>h</mi><mtext mathvariant="normal">sys</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><msubsup><mi>Œ≤</mi><mi>j</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mi>/</mi><msub><mi>Œ≤</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>/</mi><msub><mi>Œ≤</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow><mrow><munder><mo>‚àë</mo><mi>l</mi></munder><msubsup><mi>Œ≤</mi><mi>l</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mi>/</mi><msub><mi>Œ≤</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>/</mi><msub><mi>Œ≤</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P(K = j \mid T = t, \theta) = \frac{h_j(t)}{h_{\text{sys}}(t)}
    = \frac{\beta_j^{-k} \cdot (k / \beta_j)(t/\beta_j)^{k-1}}
           {\sum_l \beta_l^{-k} \cdot (k / \beta_l)(t/\beta_l)^{k-1}}.
</annotation></semantics></math> The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>t</mi><mrow><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">t^{k-1}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
factors cancel, yielding
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>=</mo><mi>j</mi><mo>‚à£</mo><mi>T</mi><mo>=</mo><mi>t</mi><mo>,</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msubsup><mi>Œ≤</mi><mi>j</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup><mrow><munderover><mo>‚àë</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msubsup><mi>Œ≤</mi><mi>l</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup></mrow></mfrac><mo>‚âï</mo><msub><mi>w</mi><mi>j</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P(K = j \mid T = t, \theta) = \frac{\beta_j^{-k}}{\sum_{l=1}^m \beta_l^{-k}}
    \eqqcolon w_j.
</annotation></semantics></math> Remarkably, this does
<strong>not</strong> depend on the failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
‚Äì the conditional cause probability is constant, just as in the
exponential case. This occurs because every component hazard shares the
same power-law time dependence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>t</mi><mrow><mi>k</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">t^{k-1}</annotation></semantics></math>,
which cancels in the ratio. We define the <strong>cause weights</strong>
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>j</mi></msub><mo>=</mo><mfrac><msubsup><mi>Œ≤</mi><mi>j</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup><mrow><munderover><mo>‚àë</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msubsup><mi>Œ≤</mi><mi>l</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
  w_j = \frac{\beta_j^{-k}}{\sum_{l=1}^m \beta_l^{-k}}.
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="marginal-cause-probability">Marginal cause probability<a class="anchor" aria-label="anchor" href="#marginal-cause-probability"></a>
</h3>
<p>Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>=</mo><mi>j</mi><mo>‚à£</mo><mi>T</mi><mo>=</mo><mi>t</mi><mo>,</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">P(K = j \mid T = t, \theta)</annotation></semantics></math>
is independent of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
the marginal probability integrates trivially:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>=</mo><mi>j</mi><mo>‚à£</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùîº</mi><mi>T</mi></msub><mrow><mo stretchy="true" form="prefix">[</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>=</mo><mi>j</mi><mo>‚à£</mo><mi>T</mi><mo>,</mo><mi>Œ∏</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msub><mi>w</mi><mi>j</mi></msub><mo>=</mo><mfrac><msubsup><mi>Œ≤</mi><mi>j</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup><mrow><munderover><mo>‚àë</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msubsup><mi>Œ≤</mi><mi>l</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P(K = j \mid \theta) = \mathbb{E}_T[P(K = j \mid T, \theta)] = w_j
    = \frac{\beta_j^{-k}}{\sum_{l=1}^m \beta_l^{-k}}.
</annotation></semantics></math> Components with smaller scale
parameters (shorter expected lifetimes) are more likely to be the cause
of system failure.</p>
</div>
<div class="section level3">
<h3 id="connection-to-the-exponential-model">Connection to the exponential model<a class="anchor" aria-label="anchor" href="#connection-to-the-exponential-model"></a>
</h3>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>,
the Weibull distribution reduces to the exponential with rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><msub><mi>Œ≤</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_j = 1/\beta_j</annotation></semantics></math>.
In this case:</p>
<ul>
<li>The system scale becomes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><msub><mo>‚àë</mo><mi>j</mi></msub><msubsup><mi>Œ≤</mi><mi>j</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_{\text{sys}} = (1/\sum_j \beta_j^{-1})</annotation></semantics></math>
and the system rate is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œª</mi><mtext mathvariant="normal">sys</mtext></msub><mo>=</mo><msub><mo>‚àë</mo><mi>j</mi></msub><msub><mi>Œª</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_{\text{sys}} = \sum_j \lambda_j</annotation></semantics></math>.</li>
<li>The cause weights become
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>j</mi></msub><mo>=</mo><msub><mi>Œª</mi><mi>j</mi></msub><mi>/</mi><msub><mi>Œª</mi><mtext mathvariant="normal">sys</mtext></msub></mrow><annotation encoding="application/x-tex">w_j = \lambda_j / \lambda_{\text{sys}}</annotation></semantics></math>.</li>
<li>All likelihood contributions reduce to the
<code>exp_series_md_c1_c2_c3</code> forms.</li>
</ul>
<p>We verify this identity numerically in the <a href="#exponential-identity">Weibull(k=1) = Exponential Identity</a>
section below.</p>
</div>
</div>
<div class="section level2">
<h2 id="worked-example">Worked Example<a class="anchor" aria-label="anchor" href="#worked-example"></a>
</h2>
<p>We construct a 3-component homogeneous Weibull series system with
increasing failure rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">k = 1.5</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1.5</span>, beta1 <span class="op">=</span> <span class="fl">100</span>, beta2 <span class="op">=</span> <span class="fl">150</span>, beta3 <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">scales</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">scales</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_sys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_system_scale.html">wei_series_system_scale</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">scales</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"System scale (beta_sys):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_sys</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; System scale (beta_sys): 65.24</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"System mean lifetime:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_sys</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="va">k</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; System mean lifetime: 58.89</span></span></code></pre></div>
<div class="section level3">
<h3 id="component-hazards">Component hazards<a class="anchor" aria-label="anchor" href="#component-hazards"></a>
</h3>
<p>The <code><a href="../reference/component_hazard.html">component_hazard()</a></code> generic returns a closure for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>-th
component hazard. We overlay all three to visualize how failure
intensity changes over time:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_homogeneous_md_c1_c2_c3.html">wei_series_homogeneous_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">t_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">200</span>, length.out <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E41A1C"</span>, <span class="st">"#377EB8"</span>, <span class="st">"#4DAF4A"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.06</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time t"</span>, ylab <span class="op">=</span> <span class="st">"Hazard h_j(t)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Component Hazard Functions"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">h_j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/component_hazard.html">component_hazard</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">j</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_grid</span>, <span class="fu">h_j</span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">theta</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Component "</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m</span>, <span class="st">" (beta="</span>, <span class="va">scales</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="va">cols</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></code></pre></div>
<p><img src="weibull_homogeneous_series_files/figure-html/hazard-plot-1.png" class="r-plt" width="672"></p>
<p>All three hazard curves are increasing
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k &gt; 1</annotation></semantics></math>),
but component 1 (smallest scale) has the steepest rate of increase and
dominates at all times.</p>
</div>
<div class="section level3">
<h3 id="cause-probabilities">Cause probabilities<a class="anchor" aria-label="anchor" href="#cause-probabilities"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analytical cause weights: w_j = beta_j^{-k} / sum(beta_l^{-k})</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">scales</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">k</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">scales</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">k</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Component "</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cause weights (w_j):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Cause weights (w_j):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">w</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Component 1 Component 2 Component 3 </span></span>
<span><span class="co">#&gt;      0.5269      0.2868      0.1863</span></span></code></pre></div>
<p>The <code><a href="../reference/conditional_cause_probability.html">conditional_cause_probability()</a></code> generic confirms
these are time-invariant:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ccp_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional_cause_probability.html">conditional_cause_probability</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/wei_series_homogeneous_md_c1_c2_c3.html">wei_series_homogeneous_md_c1_c2_c3</a></span><span class="op">(</span>scales <span class="op">=</span> <span class="va">scales</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">ccp_fn</span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">theta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time t"</span>, ylab <span class="op">=</span> <span class="st">"P(K = j | T = t)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Conditional Cause Probability vs Time"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">probs</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Component "</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="va">cols</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="va">w</span>, col <span class="op">=</span> <span class="va">cols</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="weibull_homogeneous_series_files/figure-html/cond-cause-plot-1.png" class="r-plt" width="672"></p>
<p>The conditional cause probabilities are flat lines, confirming that
the homogeneous shape creates time-invariant cause attributions ‚Äì a key
structural simplification shared with the exponential model.</p>
</div>
<div class="section level3">
<h3 id="data-generation-with-periodic-inspection">Data generation with periodic inspection<a class="anchor" aria-label="anchor" href="#data-generation-with-periodic-inspection"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">gen</span><span class="op">(</span><span class="va">theta</span>, n <span class="op">=</span> <span class="fl">500</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>          observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">20</span>, tau <span class="op">=</span> <span class="fl">250</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observation types:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observation types:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; interval </span></span>
<span><span class="co">#&gt;      500</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFirst 6 rows:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; First 6 rows:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt;    t    omega t_upper    x1    x2    x3</span></span>
<span><span class="co">#&gt;    0 interval      20 FALSE  TRUE  TRUE</span></span>
<span><span class="co">#&gt;  100 interval     120  TRUE FALSE FALSE</span></span>
<span><span class="co">#&gt;   40 interval      60  TRUE FALSE FALSE</span></span>
<span><span class="co">#&gt;   40 interval      60  TRUE FALSE  TRUE</span></span>
<span><span class="co">#&gt;   40 interval      60 FALSE  TRUE FALSE</span></span>
<span><span class="co">#&gt;   40 interval      60  TRUE FALSE  TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="likelihood-contributions">Likelihood Contributions<a class="anchor" aria-label="anchor" href="#likelihood-contributions"></a>
</h2>
<p>The log-likelihood under conditions C1, C2, C3 decomposes into
individual observation contributions. The homogeneous shape is critical:
because the system lifetime is
Weibull(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub><annotation encoding="application/x-tex">\beta_{\text{sys}}</annotation></semantics></math>),
left- and interval-censored terms have <strong>closed-form</strong>
expressions involving only the system Weibull CDF and cause weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><mi>c</mi></msub><annotation encoding="application/x-tex">w_c</annotation></semantics></math>.</p>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_i</annotation></semantics></math>
denote the candidate set for observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and define
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mo>=</mo><msub><mo>‚àë</mo><mrow><mi>j</mi><mo>‚àà</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></msub><msubsup><mi>Œ≤</mi><mi>j</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup><mi>/</mi><msub><mo>‚àë</mo><mi>l</mi></msub><msubsup><mi>Œ≤</mi><mi>l</mi><mrow><mo>‚àí</mo><mi>k</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">w_{c_i} = \sum_{j \in c_i} \beta_j^{-k} / \sum_l \beta_l^{-k}</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="exact-observation-omega_i-textexact">Exact observation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œâ</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">exact</mtext></mrow><annotation encoding="application/x-tex">\omega_i = \text{exact}</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#exact-observation-omega_i-textexact"></a>
</h3>
<p>The system failed at observed time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚Ñì</mo><mi>i</mi></msub><mo>=</mo><mo>log</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>‚àë</mo><mrow><mi>j</mi><mo>‚àà</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>t</mi><mi>i</mi></msub><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \ell_i = \log\!\left(\sum_{j \in c_i} h_j(t_i)\right)
    - \sum_{j=1}^m \left(\frac{t_i}{\beta_j}\right)^k.
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="right-censored-omega_i-textright">Right-censored
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œâ</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">right</mtext></mrow><annotation encoding="application/x-tex">\omega_i = \text{right}</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#right-censored-omega_i-textright"></a>
</h3>
<p>The system survived past
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>
(no candidate set information):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚Ñì</mo><mi>i</mi></msub><mo>=</mo><mo>‚àí</mo><munderover><mo>‚àë</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>t</mi><mi>i</mi></msub><msub><mi>Œ≤</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo>=</mo><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>t</mi><mi>i</mi></msub><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \ell_i = -\sum_{j=1}^m \left(\frac{t_i}{\beta_j}\right)^k
    = -\left(\frac{t_i}{\beta_{\text{sys}}}\right)^k.
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="left-censored-omega_i-textleft">Left-censored
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œâ</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">left</mtext></mrow><annotation encoding="application/x-tex">\omega_i = \text{left}</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#left-censored-omega_i-textleft"></a>
</h3>
<p>The system failed before inspection time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÑ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚Ñì</mo><mi>i</mi></msub><mo>=</mo><mo>log</mo><msub><mi>w</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mo>+</mo><mo>log</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>œÑ</mi><mi>i</mi></msub><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \ell_i = \log w_{c_i} + \log\!\left(
    1 - \exp\!\left(-\left(\frac{\tau_i}{\beta_{\text{sys}}}\right)^k\right)
  \right).
</annotation></semantics></math> This is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>w</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mo>+</mo><mo>log</mo><msub><mi>F</mi><mtext mathvariant="normal">sys</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œÑ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log w_{c_i} + \log F_{\text{sys}}(\tau_i)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>F</mi><mtext mathvariant="normal">sys</mtext></msub><annotation encoding="application/x-tex">F_{\text{sys}}</annotation></semantics></math>
is the system Weibull CDF ‚Äì a closed form that does <strong>not</strong>
require numerical integration. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><msub><mi>c</mi><mi>i</mi></msub></msub><annotation encoding="application/x-tex">w_{c_i}</annotation></semantics></math>
term arises because, under homogeneous shapes, the cause attribution and
system lifetime factor cleanly.</p>
</div>
<div class="section level3">
<h3 id="interval-censored-omega_i-textinterval">Interval-censored
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œâ</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">interval</mtext></mrow><annotation encoding="application/x-tex">\omega_i = \text{interval}</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#interval-censored-omega_i-textinterval"></a>
</h3>
<p>The system failed in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a_i, b_i)</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚Ñì</mo><mi>i</mi></msub><mo>=</mo><mo>log</mo><msub><mi>w</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>a</mi><mi>i</mi></msub><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo>+</mo><mo>log</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>b</mi><mi>i</mi></msub><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>a</mi><mi>i</mi></msub><msub><mi>Œ≤</mi><mtext mathvariant="normal">sys</mtext></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \ell_i = \log w_{c_i}
    - \left(\frac{a_i}{\beta_{\text{sys}}}\right)^k
    + \log\!\left(1 - \exp\!\left(
      -\left(\left(\frac{b_i}{\beta_{\text{sys}}}\right)^k
       - \left(\frac{a_i}{\beta_{\text{sys}}}\right)^k\right)
    \right)\right).
</annotation></semantics></math> This is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>w</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>R</mi><mtext mathvariant="normal">sys</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><msub><mi>R</mi><mtext mathvariant="normal">sys</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log w_{c_i} + \log(R_{\text{sys}}(a_i) - R_{\text{sys}}(b_i))</annotation></semantics></math>,
again in closed form.</p>
</div>
<div class="section level3">
<h3 id="why-homogeneous-shapes-enable-closed-forms">Why homogeneous shapes enable closed forms<a class="anchor" aria-label="anchor" href="#why-homogeneous-shapes-enable-closed-forms"></a>
</h3>
<p>In the heterogeneous Weibull model
(<code>wei_series_md_c1_c2_c3</code>), the system survival function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mtext mathvariant="normal">sys</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>‚àè</mo><mi>j</mi></msub><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mi>/</mi><msub><mi>Œ≤</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>k</mi><mi>j</mi></msub></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_{\text{sys}}(t) = \prod_j \exp(-(t/\beta_j)^{k_j})</annotation></semantics></math>
does not reduce to a single Weibull, so the left- and interval-censored
contributions require numerical integration via <code>cubature</code>.
The homogeneous constraint
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>j</mi></msub><mo>=</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k_j = k</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
collapses the product into a single Weibull CDF evaluation, and the
cause weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>w</mi><msub><mi>c</mi><mi>i</mi></msub></msub><annotation encoding="application/x-tex">w_{c_i}</annotation></semantics></math>
separate from the time dependence. This makes the homogeneous model
substantially faster and more numerically stable for censored data.</p>
</div>
</div>
<div class="section level2">
<h2 id="mle-fitting">MLE Fitting<a class="anchor" aria-label="anchor" href="#mle-fitting"></a>
</h2>
<p>We fit the model to the periodically inspected data generated above
using the <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> generic, which returns a solver based on
<code>optim</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">theta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">110</span>, <span class="fl">140</span>, <span class="fl">180</span><span class="op">)</span>  <span class="co"># Initial guess near true values</span></span>
<span></span>
<span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">df</span>, par <span class="op">=</span> <span class="va">theta0</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span>
<span><span class="co">#&gt; Maximum Likelihood Estimate (Fisherian)</span></span>
<span><span class="co">#&gt; ----------------------------------------</span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; [1]   1.48 100.94 149.80 247.39</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Log-likelihood: -1326 </span></span>
<span><span class="co">#&gt; Observations: 500</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True parameters: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">theta</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; True parameters:  1.5 100 150 200</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"MLE estimates:   "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">par</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; MLE estimates:    1.48 100.9 149.8 247.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Std errors:      "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Std errors:       0.05 4.63 10.16 27.54</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Relative error:  "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">theta</span><span class="op">)</span> <span class="op">/</span> <span class="va">theta</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Relative error:   1.4 0.9 0.1 23.7 %</span></span></code></pre></div>
<div class="section level3">
<h3 id="score-and-hessian-computation">Score and Hessian computation<a class="anchor" aria-label="anchor" href="#score-and-hessian-computation"></a>
</h3>
<p>The score function uses a <strong>hybrid approach</strong>:
analytical gradients for exact and right-censored observations, and
<code><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">numDeriv::grad</a></code> for left- and interval-censored
observations. The Hessian is fully numerical, computed as the Jacobian
of the score via <code><a href="https://rdrr.io/pkg/numDeriv/man/jacobian.html" class="external-link">numDeriv::jacobian</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ll_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">scr_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/score.html" class="external-link">score</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">hess_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/hess_loglik.html" class="external-link">hess_loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Score at MLE should be near zero</span></span>
<span><span class="va">scr_mle</span> <span class="op">&lt;-</span> <span class="fu">scr_fn</span><span class="op">(</span><span class="va">df</span>, <span class="va">estimate</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Score at MLE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">scr_mle</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Score at MLE: -0.141 -0.0018 -1e-04 -2e-04</span></span>
<span></span>
<span><span class="co"># Verify score against numerical gradient</span></span>
<span><span class="va">scr_num</span> <span class="op">&lt;-</span> <span class="fu">numDeriv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">grad</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span> <span class="fu">ll_fn</span><span class="op">(</span><span class="va">df</span>, <span class="va">th</span><span class="op">)</span>, <span class="va">estimate</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Max |analytical - numerical| score:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">scr_mle</span> <span class="op">-</span> <span class="va">scr_num</span><span class="op">)</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"e"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max |analytical - numerical| score: 0.00e+00</span></span>
<span></span>
<span><span class="co"># Hessian eigenvalues (should be negative for concavity)</span></span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu">hess_fn</span><span class="op">(</span><span class="va">df</span>, <span class="va">estimate</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hessian eigenvalues:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hessian eigenvalues: -431 -0.05 -0.01 0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="monte-carlo">Monte Carlo Simulation Study<a class="anchor" aria-label="anchor" href="#monte-carlo"></a>
</h2>
<p>We compare estimation performance across three shape regimes:
decreasing failure rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">k = 0.7</annotation></semantics></math>),
constant
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1.0</mn></mrow><annotation encoding="application/x-tex">k = 1.0</annotation></semantics></math>),
and increasing
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">k = 1.5</annotation></semantics></math>).
Each scenario uses
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">m = 3</annotation></semantics></math>
components,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">n = 500</annotation></semantics></math>
observations, Bernoulli masking with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">p = 0.3</annotation></semantics></math>,
and periodic inspection with approximately 25% right-censoring.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">100</span>          <span class="co"># Monte Carlo replications</span></span>
<span><span class="va">n_mc</span> <span class="op">&lt;-</span> <span class="fl">500</span>       <span class="co"># Sample size per replication</span></span>
<span><span class="va">p_mc</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>       <span class="co"># Masking probability</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>     <span class="co"># CI level</span></span>
<span></span>
<span><span class="co"># Three shape regimes</span></span>
<span><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  DFR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">0.7</span>, beta1 <span class="op">=</span> <span class="fl">100</span>, beta2 <span class="op">=</span> <span class="fl">150</span>, beta3 <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>  CFR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1.0</span>, beta1 <span class="op">=</span> <span class="fl">100</span>, beta2 <span class="op">=</span> <span class="fl">150</span>, beta3 <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>  IFR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1.5</span>, beta1 <span class="op">=</span> <span class="fl">100</span>, beta2 <span class="op">=</span> <span class="fl">150</span>, beta3 <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_homogeneous_md_c1_c2_c3.html">wei_series_homogeneous_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gen_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model_mc</span><span class="op">)</span></span>
<span><span class="va">solver_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model_mc</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sc_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">scenarios</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">th</span> <span class="op">&lt;-</span> <span class="va">scenarios</span><span class="op">[[</span><span class="va">sc_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">k_sc</span> <span class="op">&lt;-</span> <span class="va">th</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">scales_sc</span> <span class="op">&lt;-</span> <span class="va">th</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">m_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">scales_sc</span><span class="op">)</span></span>
<span>  <span class="va">npars</span> <span class="op">&lt;-</span> <span class="va">m_sc</span> <span class="op">+</span> <span class="fl">1</span></span>
<span></span>
<span>  <span class="co"># Choose tau to give ~25% right-censoring</span></span>
<span>  <span class="va">beta_sys_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_system_scale.html">wei_series_system_scale</a></span><span class="op">(</span><span class="va">k_sc</span>, <span class="va">scales_sc</span><span class="op">)</span></span>
<span>  <span class="va">tau_sc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">qweibull</a></span><span class="op">(</span><span class="fl">0.75</span>, shape <span class="op">=</span> <span class="va">k_sc</span>, scale <span class="op">=</span> <span class="va">beta_sys_sc</span><span class="op">)</span></span>
<span>  <span class="va">delta_sc</span> <span class="op">&lt;-</span> <span class="va">tau_sc</span> <span class="op">/</span> <span class="fl">10</span>  <span class="co"># ~10 inspection intervals</span></span>
<span></span>
<span>  <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">npars</span><span class="op">)</span></span>
<span>  <span class="va">se_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">npars</span><span class="op">)</span></span>
<span>  <span class="va">ci_lower</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">npars</span><span class="op">)</span></span>
<span>  <span class="va">ci_upper</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">B</span>, ncol <span class="op">=</span> <span class="va">npars</span><span class="op">)</span></span>
<span>  <span class="va">converged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span>
<span>  <span class="va">cens_fracs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">df_b</span> <span class="op">&lt;-</span> <span class="fu">gen_mc</span><span class="op">(</span><span class="va">th</span>, n <span class="op">=</span> <span class="va">n_mc</span>, p <span class="op">=</span> <span class="va">p_mc</span>,</span>
<span>                   observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="va">delta_sc</span>, tau <span class="op">=</span> <span class="va">tau_sc</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">cens_fracs</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df_b</span><span class="op">$</span><span class="va">omega</span> <span class="op">==</span> <span class="st">"right"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>      <span class="va">est_b</span> <span class="op">&lt;-</span> <span class="fu">solver_mc</span><span class="op">(</span><span class="va">df_b</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">120</span>, <span class="va">m_sc</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                         method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>,</span>
<span>                         lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1e-6</span>, <span class="va">npars</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">estimates</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">est_b</span><span class="op">$</span><span class="va">par</span></span>
<span>      <span class="va">se_est</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">est_b</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="va">ci_lower</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">est_b</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">z</span> <span class="op">*</span> <span class="va">se_est</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span></span>
<span>      <span class="va">ci_upper</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">est_b</span><span class="op">$</span><span class="va">par</span> <span class="op">+</span> <span class="va">z</span> <span class="op">*</span> <span class="va">se_est</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span></span>
<span>      <span class="va">converged</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">est_b</span><span class="op">$</span><span class="va">converged</span></span>
<span>    <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">converged</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">results</span><span class="op">[[</span><span class="va">sc_name</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    theta <span class="op">=</span> <span class="va">th</span>, estimates <span class="op">=</span> <span class="va">estimates</span>, se_est <span class="op">=</span> <span class="va">se_est</span>,</span>
<span>    ci_lower <span class="op">=</span> <span class="va">ci_lower</span>, ci_upper <span class="op">=</span> <span class="va">ci_upper</span>,</span>
<span>    converged <span class="op">=</span> <span class="va">converged</span>, cens_fracs <span class="op">=</span> <span class="va">cens_fracs</span>,</span>
<span>    tau <span class="op">=</span> <span class="va">tau_sc</span>, delta <span class="op">=</span> <span class="va">delta_sc</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 id="bias-and-mse-by-shape-regime">Bias and MSE by shape regime<a class="anchor" aria-label="anchor" href="#bias-and-mse-by-shape-regime"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sc_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="va">sc_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">th</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">theta</span></span>
<span>  <span class="va">valid</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">converged</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">est_v</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="va">valid</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">est_v</span><span class="op">)</span> <span class="op">-</span> <span class="va">th</span></span>
<span>  <span class="va">variance</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">est_v</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span></span>
<span>  <span class="va">mse</span> <span class="op">&lt;-</span> <span class="va">bias</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">variance</span></span>
<span>  <span class="va">pnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">th</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">summary_rows</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">summary_rows</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      Regime <span class="op">=</span> <span class="va">sc_name</span>,</span>
<span>      Parameter <span class="op">=</span> <span class="va">pnames</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      True <span class="op">=</span> <span class="va">th</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      Mean_Est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">est_v</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      Bias <span class="op">=</span> <span class="va">bias</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      RMSE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">mse</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      Rel_Bias_Pct <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">bias</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">/</span> <span class="va">th</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mc_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">summary_rows</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">mc_table</span>, digits <span class="op">=</span> <span class="fl">3</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Monte Carlo Results by Shape Regime (B=100, n=500)"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Regime"</span>, <span class="st">"Parameter"</span>, <span class="st">"True"</span>, <span class="st">"Mean Est."</span>,</span>
<span>                          <span class="st">"Bias"</span>, <span class="st">"RMSE"</span>, <span class="st">"Rel. Bias %"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Monte Carlo Results by Shape Regime (B=100, n=500)</caption>
<thead><tr class="header">
<th align="left">Regime</th>
<th align="left">Parameter</th>
<th align="right">True</th>
<th align="right">Mean Est.</th>
<th align="right">Bias</th>
<th align="right">RMSE</th>
<th align="right">Rel. Bias %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DFR</td>
<td align="left">k</td>
<td align="right">0.7</td>
<td align="right">0.700</td>
<td align="right">0.000</td>
<td align="right">0.039</td>
<td align="right">-0.046</td>
</tr>
<tr class="even">
<td align="left">DFR</td>
<td align="left">beta1</td>
<td align="right">100.0</td>
<td align="right">102.108</td>
<td align="right">2.108</td>
<td align="right">16.190</td>
<td align="right">2.108</td>
</tr>
<tr class="odd">
<td align="left">DFR</td>
<td align="left">beta2</td>
<td align="right">150.0</td>
<td align="right">156.849</td>
<td align="right">6.849</td>
<td align="right">29.900</td>
<td align="right">4.566</td>
</tr>
<tr class="even">
<td align="left">DFR</td>
<td align="left">beta3</td>
<td align="right">200.0</td>
<td align="right">208.930</td>
<td align="right">8.930</td>
<td align="right">46.026</td>
<td align="right">4.465</td>
</tr>
<tr class="odd">
<td align="left">CFR</td>
<td align="left">k</td>
<td align="right">1.0</td>
<td align="right">0.997</td>
<td align="right">-0.003</td>
<td align="right">0.052</td>
<td align="right">-0.329</td>
</tr>
<tr class="even">
<td align="left">CFR</td>
<td align="left">beta1</td>
<td align="right">100.0</td>
<td align="right">102.388</td>
<td align="right">2.388</td>
<td align="right">11.367</td>
<td align="right">2.388</td>
</tr>
<tr class="odd">
<td align="left">CFR</td>
<td align="left">beta2</td>
<td align="right">150.0</td>
<td align="right">151.217</td>
<td align="right">1.217</td>
<td align="right">21.640</td>
<td align="right">0.811</td>
</tr>
<tr class="even">
<td align="left">CFR</td>
<td align="left">beta3</td>
<td align="right">200.0</td>
<td align="right">205.608</td>
<td align="right">5.608</td>
<td align="right">30.815</td>
<td align="right">2.804</td>
</tr>
<tr class="odd">
<td align="left">IFR</td>
<td align="left">k</td>
<td align="right">1.5</td>
<td align="right">1.503</td>
<td align="right">0.003</td>
<td align="right">0.064</td>
<td align="right">0.231</td>
</tr>
<tr class="even">
<td align="left">IFR</td>
<td align="left">beta1</td>
<td align="right">100.0</td>
<td align="right">100.785</td>
<td align="right">0.785</td>
<td align="right">6.674</td>
<td align="right">0.785</td>
</tr>
<tr class="odd">
<td align="left">IFR</td>
<td align="left">beta2</td>
<td align="right">150.0</td>
<td align="right">150.996</td>
<td align="right">0.996</td>
<td align="right">13.150</td>
<td align="right">0.664</td>
</tr>
<tr class="even">
<td align="left">IFR</td>
<td align="left">beta3</td>
<td align="right">200.0</td>
<td align="right">201.455</td>
<td align="right">1.455</td>
<td align="right">24.228</td>
<td align="right">0.728</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="confidence-interval-coverage">Confidence interval coverage<a class="anchor" aria-label="anchor" href="#confidence-interval-coverage"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coverage_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sc_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="va">sc_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">th</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">theta</span></span>
<span>  <span class="va">valid</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">converged</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ci_lower</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">pnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">th</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">valid_j</span> <span class="op">&lt;-</span> <span class="va">valid</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ci_lower</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ci_upper</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">covered</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ci_lower</span><span class="op">[</span><span class="va">valid_j</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">th</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>               <span class="op">(</span><span class="va">th</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">res</span><span class="op">$</span><span class="va">ci_upper</span><span class="op">[</span><span class="va">valid_j</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">width</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">ci_upper</span><span class="op">[</span><span class="va">valid_j</span>, <span class="va">j</span><span class="op">]</span> <span class="op">-</span> <span class="va">res</span><span class="op">$</span><span class="va">ci_lower</span><span class="op">[</span><span class="va">valid_j</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">coverage_rows</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">coverage_rows</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      Regime <span class="op">=</span> <span class="va">sc_name</span>,</span>
<span>      Parameter <span class="op">=</span> <span class="va">pnames</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      Coverage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covered</span><span class="op">)</span>,</span>
<span>      Mean_Width <span class="op">=</span> <span class="va">width</span>,</span>
<span>      stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">cov_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">coverage_rows</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">cov_table</span>, digits <span class="op">=</span> <span class="fl">3</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"95% Wald CI Coverage by Shape Regime"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Regime"</span>, <span class="st">"Parameter"</span>, <span class="st">"Coverage"</span>, <span class="st">"Mean Width"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>95% Wald CI Coverage by Shape Regime</caption>
<thead><tr class="header">
<th align="left">Regime</th>
<th align="left">Parameter</th>
<th align="right">Coverage</th>
<th align="right">Mean Width</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">DFR</td>
<td align="left">k</td>
<td align="right">0.949</td>
<td align="right">0.150</td>
</tr>
<tr class="even">
<td align="left">DFR</td>
<td align="left">beta1</td>
<td align="right">0.949</td>
<td align="right">60.773</td>
</tr>
<tr class="odd">
<td align="left">DFR</td>
<td align="left">beta2</td>
<td align="right">0.960</td>
<td align="right">115.664</td>
</tr>
<tr class="even">
<td align="left">DFR</td>
<td align="left">beta3</td>
<td align="right">0.970</td>
<td align="right">176.434</td>
</tr>
<tr class="odd">
<td align="left">CFR</td>
<td align="left">k</td>
<td align="right">0.950</td>
<td align="right">0.193</td>
</tr>
<tr class="even">
<td align="left">CFR</td>
<td align="left">beta1</td>
<td align="right">0.940</td>
<td align="right">39.604</td>
</tr>
<tr class="odd">
<td align="left">CFR</td>
<td align="left">beta2</td>
<td align="right">0.900</td>
<td align="right">76.988</td>
</tr>
<tr class="even">
<td align="left">CFR</td>
<td align="left">beta3</td>
<td align="right">0.980</td>
<td align="right">127.453</td>
</tr>
<tr class="odd">
<td align="left">IFR</td>
<td align="left">k</td>
<td align="right">0.980</td>
<td align="right">0.275</td>
</tr>
<tr class="even">
<td align="left">IFR</td>
<td align="left">beta1</td>
<td align="right">0.950</td>
<td align="right">22.968</td>
</tr>
<tr class="odd">
<td align="left">IFR</td>
<td align="left">beta2</td>
<td align="right">0.950</td>
<td align="right">52.617</td>
</tr>
<tr class="even">
<td align="left">IFR</td>
<td align="left">beta3</td>
<td align="right">0.950</td>
<td align="right">92.139</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="censoring-rates">Censoring rates<a class="anchor" aria-label="anchor" href="#censoring-rates"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">sc_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="va">sc_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">conv_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span></span>
<span>  <span class="va">cens_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cens_fracs</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">converged</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s (k=%.1f): convergence=%.1f%%, mean censoring=%.1f%%\n"</span>,</span>
<span>              <span class="va">sc_name</span>, <span class="va">res</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">100</span> <span class="op">*</span> <span class="va">conv_rate</span>, <span class="fl">100</span> <span class="op">*</span> <span class="va">cens_rate</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; DFR (k=0.7): convergence=99.0%, mean censoring=25.2%</span></span>
<span><span class="co">#&gt; CFR (k=1.0): convergence=100.0%, mean censoring=25.0%</span></span>
<span><span class="co">#&gt; IFR (k=1.5): convergence=100.0%, mean censoring=25.0%</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sampling-distribution-visualization">Sampling distribution visualization<a class="anchor" aria-label="anchor" href="#sampling-distribution-visualization"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, oma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="st">"beta1"</span>, <span class="st">"beta2"</span>, <span class="st">"beta3"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sc_name</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="va">sc_name</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">th</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">theta</span></span>
<span>  <span class="va">valid</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">converged</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">est_v</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">estimates</span><span class="op">[</span><span class="va">valid</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">th</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">est_v</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span>, breaks <span class="op">=</span> <span class="fl">20</span>, probability <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">sc_name</span>, <span class="st">": "</span>, <span class="va">pnames</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>,</span>
<span>         xlab <span class="op">=</span> <span class="va">pnames</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>         col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>, cex.main <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">th</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">est_v</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Sampling Distributions by Regime"</span>, outer <span class="op">=</span> <span class="cn">TRUE</span>, cex <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="weibull_homogeneous_series_files/figure-html/mc-sampling-dist-1.png" class="r-plt" width="768"></p>
</div>
<div class="section level4">
<h4 id="interpretation">Interpretation<a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h4>
<p>The Monte Carlo study reveals several patterns:</p>
<ul>
<li><p><strong>Shape estimation accuracy varies by regime.</strong> In
absolute terms, the DFR regime
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">k = 0.7</annotation></semantics></math>)
has the smallest shape RMSE, while IFR
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">k = 1.5</annotation></semantics></math>)
has the best <em>relative</em> precision
(RMSE/<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>).
IFR has the widest absolute confidence intervals simply because the
parameter value is largest; the relative CI width
(width/<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>)
is actually smallest for IFR. The steeper curvature of the IFR hazard
function provides stronger signal about the shape parameter relative to
its magnitude.</p></li>
<li><p><strong>Scale estimation is robust across regimes.</strong>
Relative bias in the scale parameters is below 5% in all three regimes.
Coverage is near the nominal 95% for most parameters, though a few
(e.g., CFR
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ≤</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\beta_2</annotation></semantics></math>)
show undercoverage around 90%, which is borderline significant at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">B = 100</annotation></semantics></math>
replications. In the DFR regime, scale parameters exhibit positive bias
that increases with the true scale value.</p></li>
<li><p><strong>Periodic inspection adds interval-censoring.</strong>
Unlike the exponential vignette which used only exact + right
observations, this study uses periodic inspection. The closed-form
interval-censored contributions (unique to the homogeneous model) keep
computation fast despite the additional complexity.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="exponential-identity">Weibull(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k=1</annotation></semantics></math>)
= Exponential Identity<a class="anchor" aria-label="anchor" href="#exponential-identity"></a>
</h2>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>,
the homogeneous Weibull model reduces to the exponential model. We
verify this numerically by comparing log-likelihoods on the same
data.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameters: k=1 with scales equivalent to rates (1/beta_j)</span></span>
<span><span class="va">exp_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.008</span>, <span class="fl">0.005</span><span class="op">)</span></span>
<span><span class="va">wei_scales</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">exp_rates</span>  <span class="co"># beta = 1/lambda</span></span>
<span><span class="va">wei_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">wei_scales</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data under exponential model</span></span>
<span><span class="va">exp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">exp_gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">df_test</span> <span class="op">&lt;-</span> <span class="fu">exp_gen</span><span class="op">(</span><span class="va">exp_rates</span>, n <span class="op">=</span> <span class="fl">200</span>, tau <span class="op">=</span> <span class="fl">300</span>, p <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate both log-likelihoods</span></span>
<span><span class="va">ll_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span></span>
<span><span class="va">ll_wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">val_exp</span> <span class="op">&lt;-</span> <span class="fu">ll_exp</span><span class="op">(</span><span class="va">df_test</span>, <span class="va">exp_rates</span><span class="op">)</span></span>
<span><span class="va">val_wei</span> <span class="op">&lt;-</span> <span class="fu">ll_wei</span><span class="op">(</span><span class="va">df_test</span>, <span class="va">wei_theta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Exponential loglik:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">val_exp</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exponential loglik: -1104</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Weibull(k=1) loglik:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">val_wei</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Weibull(k=1) loglik: -1104</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Absolute difference:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">val_exp</span> <span class="op">-</span> <span class="va">val_wei</span><span class="op">)</span>,</span>
<span>                                     format <span class="op">=</span> <span class="st">"e"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Absolute difference: 2.27e-13</span></span></code></pre></div>
<p>The two log-likelihoods agree to machine precision, confirming that
the homogeneous Weibull model is a proper generalization of the
exponential series model. This also serves as a consistency check on the
implementation.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Score comparison</span></span>
<span><span class="va">s_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/score.html" class="external-link">score</a></span><span class="op">(</span><span class="va">exp_model</span><span class="op">)</span><span class="op">(</span><span class="va">df_test</span>, <span class="va">exp_rates</span><span class="op">)</span></span>
<span><span class="va">s_wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/score.html" class="external-link">score</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">(</span><span class="va">df_test</span>, <span class="va">wei_theta</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The exponential score is d/d(lambda_j), the Weibull score includes d/dk</span></span>
<span><span class="co"># and d/d(beta_j). Since lambda_j = 1/beta_j, by the chain rule:</span></span>
<span><span class="co">#   d(ell)/d(lambda_j) = d(ell)/d(beta_j) * d(beta_j)/d(lambda_j)</span></span>
<span><span class="co">#                      = d(ell)/d(beta_j) * (-beta_j^2)</span></span>
<span><span class="co"># So: d(ell)/d(lambda_j) = -beta_j^2 * d(ell)/d(beta_j)</span></span>
<span><span class="va">s_wei_transformed</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">wei_scales</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">s_wei</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Exponential score:        "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">s_exp</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Exponential score:         -1490 -395 -439.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Weibull(k=1) scale score: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">s_wei_transformed</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Weibull(k=1) scale score:  -1490 -395 -439.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Max |difference|:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">s_exp</span> <span class="op">-</span> <span class="va">s_wei_transformed</span><span class="op">)</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"e"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max |difference|: 1.48e-12</span></span></code></pre></div>
<p>The transformed Weibull scale scores match the exponential rate
scores to machine precision, confirming that the two parameterizations
yield identical inference at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math>.
The shape score
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>‚àÇ</mi><mo>‚Ñì</mo><mi>/</mi><mi>‚àÇ</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">\partial\ell/\partial k</annotation></semantics></math>
is nonzero at the true parameter (the score is zero only at the MLE, not
at the DGP truth for any finite sample).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
