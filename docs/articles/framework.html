<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A Likelihood Framework for Masked Series Systems • maskedcauses</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A Likelihood Framework for Masked Series Systems">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">maskedcauses</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/queelius/maskedcauses/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>A Likelihood Framework for Masked Series Systems</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/queelius/maskedcauses/blob/HEAD/vignettes/framework.Rmd" class="external-link"><code>vignettes/framework.Rmd</code></a></small>
      <div class="d-none name"><code>framework.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In reliability engineering, many systems are designed as
<strong>series systems</strong>: the system functions only when all of
its
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components function. When the system fails, the failure time is
observed, but the <em>component</em> that caused the failure is often
unknown or only partially identified. This situation — where the failed
component is hidden behind incomplete diagnostic information — is called
<strong>masked failure cause data</strong>.</p>
<p>This vignette develops a self-contained mathematical framework for
estimating component lifetime parameters from masked series system data.
Everything is derived from first principles; no external paper is
required. The framework is then instantiated for three distribution
families implemented in <code>maskedcauses</code>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Exponential</strong> (<code>exp_series_md_c1_c2_c3</code>) —
constant failure rates</li>
<li>
<strong>Homogeneous Weibull</strong>
(<code>wei_series_homogeneous_md_c1_c2_c3</code>) — shared shape,
individual scales</li>
<li>
<strong>Heterogeneous Weibull</strong>
(<code>wei_series_md_c1_c2_c3</code>) — individual shapes and
scales</li>
</ol>
<p>Each section pairs the mathematical derivation with live R code that
demonstrates the corresponding package functions.</p>
</div>
<div class="section level2">
<h2 id="series-system">Series System Model<a class="anchor" aria-label="anchor" href="#series-system"></a>
</h2>
<div class="section level3">
<h3 id="definition">Definition<a class="anchor" aria-label="anchor" href="#definition"></a>
</h3>
<p>Consider a system of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
independent components. The lifetime of component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
in the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
system is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">T_{ij}</annotation></semantics></math>,
with reliability (survival) function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>&gt;</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_j(t) = P(T_{ij} &gt; t)</annotation></semantics></math>,
pdf
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_j(t)</annotation></semantics></math>,
and hazard function
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">
  h_j(t) = \frac{f_j(t)}{R_j(t)}.
</annotation></semantics></math></p>
<p>In a series configuration (“weakest link”), the system fails as soon
as any component fails:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  T_i = \min(T_{i1}, \ldots, T_{im}).
</annotation></semantics></math></p>
<p><strong>Assumption (independence).</strong> Component lifetimes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{i1}, \ldots, T_{im}</annotation></semantics></math>
are mutually independent given the parameter vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="system-reliability">System reliability<a class="anchor" aria-label="anchor" href="#system-reliability"></a>
</h3>
The system reliability is the product of component reliabilities:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo>&gt;</mo><mi>t</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><msub><mi>θ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:sys_reliability}
R(t \mid \theta) = P(T_i &gt; t \mid \theta) = \prod_{j=1}^m R_j(t \mid \theta_j).
\end{equation}</annotation></semantics></math>
</div>
<div class="section level3">
<h3 id="additive-hazards">Additive hazards<a class="anchor" aria-label="anchor" href="#additive-hazards"></a>
</h3>
The system hazard is the sum of component hazards:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><msub><mi>θ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:sys_hazard}
h(t \mid \theta) = \sum_{j=1}^m h_j(t \mid \theta_j).
\end{equation}</annotation></semantics></math><p>The additive hazard decomposition is the central structural result
for series systems. It means that each component contributes
independently to the instantaneous system failure risk at every time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<p>The system pdf follows immediately:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><munderover><mo>∏</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>R</mi><mi>l</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  f(t \mid \theta) = h(t \mid \theta) \cdot R(t \mid \theta)
    = \left[\sum_{j=1}^m h_j(t)\right]
      \prod_{l=1}^m R_l(t).
</annotation></semantics></math></p>
<div class="section level4">
<h4 id="r-code-exponential-example">R code: Exponential example<a class="anchor" aria-label="anchor" href="#r-code-exponential-example"></a>
</h4>
<p>We demonstrate with a 3-component exponential series system. Each
component has a constant hazard (failure rate)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\lambda_j</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Component failure rates</span></span>
<span><span class="va">theta_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.1</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta_exp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract hazard closures</span></span>
<span><span class="va">h1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/component_hazard.html">component_hazard</a></span><span class="op">(</span><span class="va">model_exp</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">h2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/component_hazard.html">component_hazard</a></span><span class="op">(</span><span class="va">model_exp</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">h3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/component_hazard.html">component_hazard</a></span><span class="op">(</span><span class="va">model_exp</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">3</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">h_sys</span> <span class="op">&lt;-</span> <span class="fu">h1</span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">theta_exp</span><span class="op">)</span> <span class="op">+</span> <span class="fu">h2</span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">theta_exp</span><span class="op">)</span> <span class="op">+</span> <span class="fu">h3</span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">theta_exp</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"System hazard (constant):"</span>, <span class="va">h_sys</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; System hazard (constant): 3.05</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Sum of component rates:  "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">theta_exp</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sum of component rates:   3.05</span></span></code></pre></div>
<p>For exponential components, the system hazard is constant and equals
the sum of the individual rates — consistent with the additive hazard
theorem.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="cause-of-failure">Component Cause of Failure<a class="anchor" aria-label="anchor" href="#cause-of-failure"></a>
</h2>
<div class="section level3">
<h3 id="definition-1">Definition<a class="anchor" aria-label="anchor" href="#definition-1"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
denote the index of the component that caused the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>-th
system failure:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mo>arg</mo><munder><mo>min</mo><mrow><mi>j</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow></munder><msub><mi>T</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
  K_i = \arg\min_{j \in \{1,\ldots,m\}} T_{ij}.
</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>
is a discrete random variable on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{1, \ldots, m\}</annotation></semantics></math>
that, in general, depends on the failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>i</mi></msub><annotation encoding="application/x-tex">T_i</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="conditional-cause-probability">Conditional cause probability<a class="anchor" aria-label="anchor" href="#conditional-cause-probability"></a>
</h3>
The probability that component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
caused the system failure, given that the failure occurred at time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>∣</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mi>t</mi><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><msub><mi>θ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>h</mi><mi>l</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>∣</mo><msub><mi>θ</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:cond_cause}
P(K_i = j \mid T_i = t, \theta)
  = \frac{h_j(t \mid \theta_j)}{\sum_{l=1}^m h_l(t \mid \theta_l)}
  = \frac{h_j(t)}{h(t)}.
\end{equation}</annotation></semantics></math><p><strong>Intuition.</strong> At any instant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
the component with the highest hazard is the most likely cause. The
cause probability is the component’s <em>share</em> of the total
instantaneous risk — a proportional allocation.</p>
<div class="section level4">
<h4 id="r-code-exponential-vs-weibull-cause-probabilities">R code: Exponential vs Weibull cause probabilities<a class="anchor" aria-label="anchor" href="#r-code-exponential-vs-weibull-cause-probabilities"></a>
</h4>
<p>For exponential components, the cause probability is
<em>constant</em> in time (because all hazards are constant). For
heterogeneous Weibull components, the cause probability <em>varies</em>
with time:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exponential: constant cause probabilities</span></span>
<span><span class="va">ccp_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional_cause_probability.html">conditional_cause_probability</a></span><span class="op">(</span><span class="va">model_exp</span><span class="op">)</span></span>
<span><span class="va">probs_exp</span> <span class="op">&lt;-</span> <span class="fu">ccp_exp</span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">theta_exp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Heterogeneous Weibull: time-varying</span></span>
<span><span class="va">theta_wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">200</span>,   <span class="co"># DFR electronics</span></span>
<span>               <span class="fl">1.0</span>, <span class="fl">150</span>,   <span class="co"># CFR seals</span></span>
<span>               <span class="fl">2.0</span>, <span class="fl">100</span><span class="op">)</span>   <span class="co"># IFR bearing</span></span>
<span><span class="va">model_wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_md_c1_c2_c3.html">wei_series_md_c1_c2_c3</a></span><span class="op">(</span></span>
<span>  shapes <span class="op">=</span> <span class="va">theta_wei</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  scales <span class="op">=</span> <span class="va">theta_wei</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="va">ccp_wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional_cause_probability.html">conditional_cause_probability</a></span><span class="op">(</span><span class="va">model_wei</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t_wei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">120</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">probs_wei</span> <span class="op">&lt;-</span> <span class="fu">ccp_wei</span><span class="op">(</span><span class="va">t_wei</span>, <span class="va">theta_wei</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Exponential</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">probs_exp</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"P(K = j | T = t)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Exponential (constant)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">probs_exp</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">probs_exp</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Comp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"forestgreen"</span>, <span class="st">"firebrick"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Heterogeneous Weibull</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t_wei</span>, <span class="va">probs_wei</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"P(K = j | T = t)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Heterogeneous Weibull (time-varying)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_wei</span>, <span class="va">probs_wei</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_wei</span>, <span class="va">probs_wei</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DFR (k=0.7)"</span>, <span class="st">"CFR (k=1.0)"</span>, <span class="st">"IFR (k=2.0)"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"forestgreen"</span>, <span class="st">"firebrick"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="framework_files/figure-html/cause-prob-demo-1.png" class="r-plt" width="672"></p>
<p>In the right panel, the DFR component (high infant-mortality hazard)
dominates at early times, but the IFR component (wear-out) takes over as
the system ages. This crossover cannot be captured by models that force
a common shape parameter.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="observational-model">The Observational Model<a class="anchor" aria-label="anchor" href="#observational-model"></a>
</h2>
<p>In practice, we do not observe the latent component lifetimes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>m</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(T_{i1}, \ldots, T_{im})</annotation></semantics></math>
directly. Instead, for each of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
systems we observe a triple
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>,</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(s_i, \omega_i, c_i)</annotation></semantics></math>:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mi>i</mi></msub><annotation encoding="application/x-tex">s_i</annotation></semantics></math>:
a time value (possibly censored)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ω</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\omega_i</annotation></semantics></math>:
the observation type</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo>⊆</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>m</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">c_i \subseteq \{1, \ldots, m\}</annotation></semantics></math>:
the candidate set of possibly-failed components</li>
</ul>
<div class="section level3">
<h3 id="four-observation-types">Four observation types<a class="anchor" aria-label="anchor" href="#four-observation-types"></a>
</h3>
<p>The package supports four types, each arising from a different
monitoring scheme:</p>
<table class="table">
<colgroup>
<col width="10%">
<col width="20%">
<col width="25%">
<col width="43%">
</colgroup>
<thead><tr class="header">
<th>Type</th>
<th><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ω</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\omega_i</annotation></semantics></math></th>
<th>What we know</th>
<th>Likelihood contribution</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Exact</td>
<td><code>"exact"</code></td>
<td>System failed at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mi>i</mi></msub><annotation encoding="application/x-tex">s_i</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R(s_i) \cdot h_c(s_i)</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Right-censored</td>
<td><code>"right"</code></td>
<td>System survived past
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mi>i</mi></msub><annotation encoding="application/x-tex">s_i</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R(s_i)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Left-censored</td>
<td><code>"left"</code></td>
<td>System failed before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>s</mi><mi>i</mi></msub><annotation encoding="application/x-tex">s_i</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><msub><mi>s</mi><mi>i</mi></msub></msubsup><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">\int_0^{s_i} h_c(u) R(u)\, du</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Interval-censored</td>
<td><code>"interval"</code></td>
<td>Failure in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>s</mi><mi>i</mi></msub><mo>,</mo><msubsup><mi>s</mi><mi>i</mi><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(s_i, s_i^{\mathrm{upper}})</annotation></semantics></math>
</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∫</mo><msub><mi>s</mi><mi>i</mi></msub><msubsup><mi>s</mi><mi>i</mi><mrow><mi mathvariant="normal">u</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">p</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">r</mi></mrow></msubsup></msubsup><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>u</mi></mrow><annotation encoding="application/x-tex">\int_{s_i}^{s_i^{\mathrm{upper}}} h_c(u) R(u)\, du</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>Here
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></msub><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_c(t) = \sum_{j \in c_i} h_j(t)</annotation></semantics></math>
is the candidate-set hazard.</p>
</div>
<div class="section level3">
<h3 id="masking">Masking<a class="anchor" aria-label="anchor" href="#masking"></a>
</h3>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|c_i| = 1</annotation></semantics></math>,
the failed component is known exactly. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|c_i| &gt; 1</annotation></semantics></math>,
the cause of failure is <strong>masked</strong>: the diagnostic
identifies a set of possible culprits but not the specific one.</p>
</div>
<div class="section level3">
<h3 id="observe-functors">Observe functors<a class="anchor" aria-label="anchor" href="#observe-functors"></a>
</h3>
<p>The package provides composable observation functors for generating
data under different monitoring schemes:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Continuous monitoring with right-censoring at tau</span></span>
<span><span class="va">obs_right</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu">obs_right</span><span class="op">(</span><span class="fl">3.2</span><span class="op">)</span>   <span class="co"># failure before tau -&gt; exact</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 3.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "exact"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="fu">obs_right</span><span class="op">(</span><span class="fl">7.1</span><span class="op">)</span>   <span class="co"># survival past tau  -&gt; right-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "right"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span><span class="co"># Single inspection at tau (left-censoring)</span></span>
<span><span class="va">obs_left</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu">obs_left</span><span class="op">(</span><span class="fl">3.2</span><span class="op">)</span>    <span class="co"># failed before inspection -&gt; left-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "left"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="fu">obs_left</span><span class="op">(</span><span class="fl">7.1</span><span class="op">)</span>    <span class="co"># surviving at inspection  -&gt; right-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "right"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span><span class="co"># Periodic inspections every delta time units</span></span>
<span><span class="va">obs_periodic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">1</span>, tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu">obs_periodic</span><span class="op">(</span><span class="fl">3.2</span><span class="op">)</span>  <span class="co"># failure in (3, 4) -&gt; interval-censored</span></span>
<span><span class="co">#&gt; $t</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $omega</span></span>
<span><span class="co">#&gt; [1] "interval"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $t_upper</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span></span>
<span><span class="co"># Mixture: random assignment to schemes</span></span>
<span><span class="va">obs_mixed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.5</span>, tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>All <code><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata()</a></code> methods accept an <code>observe</code>
argument to generate data under a specified monitoring scheme:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model_exp</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">df_demo</span> <span class="op">&lt;-</span> <span class="fu">gen_exp</span><span class="op">(</span><span class="va">theta_exp</span>, n <span class="op">=</span> <span class="fl">500</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                   observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_mixture.html">observe_mixture</a></span><span class="op">(</span></span>
<span>                     <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="../reference/observe_left_censor.html">observe_left_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>                     weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span>                   <span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observation type counts:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observation type counts:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_demo</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; exact  left </span></span>
<span><span class="co">#&gt;   344   156</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="c1-c2-c3">The C1–C2–C3 Likelihood<a class="anchor" aria-label="anchor" href="#c1-c2-c3"></a>
</h2>
<p>This is the core contribution: three conditions on the masking
process that reduce the full joint likelihood to a tractable form that
depends only on the lifetime parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="the-three-conditions">The three conditions<a class="anchor" aria-label="anchor" href="#the-three-conditions"></a>
</h3>
<p><strong>C1 (containment).</strong> The candidate set always contains
the true failed component:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P(K_i \in c_i) = 1.
</annotation></semantics></math> This is a minimal accuracy requirement
on the diagnostic. Without C1, the candidate set could be misleading,
and the likelihood would need to model diagnostic errors explicitly.</p>
<p><em>Example:</em> An on-board diagnostic (OBD) system reports a set
of possibly-failed modules. C1 requires that the truly failed module is
always in this set — the OBD may include false positives but never a
false negative.</p>
<p><strong>C2 (symmetric masking).</strong> The masking probability is
the same for all components in the candidate set:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mi>′</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="1.0em"></mspace><mrow><mtext mathvariant="normal">for all </mtext><mspace width="0.333em"></mspace></mrow><mi>j</mi><mo>,</mo><mi>j</mi><mi>′</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P(c_i \mid K_i = j, T_i = t_i, \theta)
    = P(c_i \mid K_i = j', T_i = t_i, \theta)
    \quad \text{for all } j, j' \in c_i.
</annotation></semantics></math> Intuitively, the diagnostic cannot
distinguish among the candidates — if it could, it would narrow the
candidate set.</p>
<p><em>Example:</em> A line-replaceable unit (LRU) grouping replaces all
components in a subsystem together. The grouping is determined by
physical layout, not by which component failed, so C2 holds by
construction.</p>
<p><strong>C3 (parameter independence).</strong> The masking
probabilities do not depend on the lifetime parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> is not a function of </mtext><mspace width="0.333em"></mspace></mrow><mi>θ</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P(c_i \mid K_i = j, T_i = t_i) \text{ is not a function of } \theta.
</annotation></semantics></math></p>
<p><em>Example:</em> Diagnostic accuracy depends on sensor calibration
and technician skill, not on component failure rates. If the diagnostic
equipment was calibrated before the study, C3 holds.</p>
</div>
<div class="section level3">
<h3 id="deriving-the-likelihood">Deriving the likelihood<a class="anchor" aria-label="anchor" href="#deriving-the-likelihood"></a>
</h3>
<p>We derive the likelihood step by step. Consider observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
with failure time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>
and candidate set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>c</mi><mi>i</mi></msub><annotation encoding="application/x-tex">c_i</annotation></semantics></math>.</p>
<p><strong>Step 1: Full joint density.</strong> The observed-data
density includes a sum over the latent cause
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>i</mi></msub><annotation encoding="application/x-tex">K_i</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>f</mi><mrow><mi>K</mi><mo>,</mo><mi>T</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  L_i(\theta) = \sum_{j=1}^m f_{K,T}(j, t_i) \cdot P(c_i \mid K_i = j, T_i = t_i, \theta).
</annotation></semantics></math></p>
<p><strong>Step 2: Apply C1.</strong> Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>i</mi></msub><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">P(K_i \in c_i) = 1</annotation></semantics></math>,
contributions from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>∉</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">j \notin c_i</annotation></semantics></math>
are zero:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>f</mi><mrow><mi>K</mi><mo>,</mo><mi>T</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  L_i(\theta) = \sum_{j \in c_i} f_{K,T}(j, t_i) \cdot P(c_i \mid K_i = j, T_i = t_i, \theta).
</annotation></semantics></math></p>
<p><strong>Step 3: Apply C2.</strong> Symmetric masking means
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>c</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>K</mi><mi>i</mi></msub><mo>=</mo><mi>j</mi><mo>,</mo><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P(c_i \mid K_i = j, T_i = t_i, \theta) = \beta_i</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">j \in c_i</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>β</mi><mi>i</mi></msub><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>f</mi><mrow><mi>K</mi><mo>,</mo><mi>T</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  L_i(\theta) = \beta_i \sum_{j \in c_i} f_{K,T}(j, t_i).
</annotation></semantics></math></p>
<p><strong>Step 4: Apply C3.</strong> Since
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\beta_i</annotation></semantics></math>
does not depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>,
it is a constant with respect to the parameters and drops from the
maximization:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>f</mi><mrow><mi>K</mi><mo>,</mo><mi>T</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo>,</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>⋅</mo><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  L_i(\theta) \propto \sum_{j \in c_i} f_{K,T}(j, t_i)
    = \sum_{j \in c_i} h_j(t_i) \cdot R(t_i)
    = R(t_i) \cdot h_c(t_i).
</annotation></semantics></math></p>
<p>The <strong>exact-failure likelihood contribution</strong> is
therefore:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mi>i</mi><mtext mathvariant="normal">exact</mtext></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:exact_contrib}
  \ell_i^{\text{exact}}(\theta)
    = \log R(t_i \mid \theta) + \log h_c(t_i \mid \theta),
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></msub><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_c(t) = \sum_{j \in c_i} h_j(t)</annotation></semantics></math>
is the candidate-set hazard.</p>
</div>
<div class="section level3">
<h3 id="censored-observations">Censored observations<a class="anchor" aria-label="anchor" href="#censored-observations"></a>
</h3>
<p><strong>Right-censored.</strong> The system survived past
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>i</mi></msub><annotation encoding="application/x-tex">t_i</annotation></semantics></math>.
No failure was observed, so there is no candidate set and the
contribution is simply:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mi>i</mi><mtext mathvariant="normal">right</mtext></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>∣</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \ell_i^{\text{right}}(\theta) = \log R(t_i \mid \theta).
</annotation></semantics></math></p>
<p><strong>Left-censored.</strong> The system was found failed at
inspection time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\tau_i</annotation></semantics></math>,
but the exact failure time is unknown. Applying C1–C3 to the integrated
likelihood:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mi>i</mi><mtext mathvariant="normal">left</mtext></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><msubsup><mo>∫</mo><mn>0</mn><msub><mi>τ</mi><mi>i</mi></msub></msubsup><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>u</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \ell_i^{\text{left}}(\theta)
    = \log \int_0^{\tau_i} h_c(u) \, R(u) \, du.
</annotation></semantics></math></p>
<p><strong>Interval-censored.</strong> The failure occurred in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo>,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(a_i, b_i)</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>ℓ</mo><mi>i</mi><mtext mathvariant="normal">interval</mtext></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><msubsup><mo>∫</mo><msub><mi>a</mi><mi>i</mi></msub><msub><mi>b</mi><mi>i</mi></msub></msubsup><msub><mi>h</mi><mi>c</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>u</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \ell_i^{\text{interval}}(\theta)
    = \log \int_{a_i}^{b_i} h_c(u) \, R(u) \, du.
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="combined-log-likelihood">Combined log-likelihood<a class="anchor" aria-label="anchor" href="#combined-log-likelihood"></a>
</h3>
<p>The full log-likelihood decomposes as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mo>ℓ</mo><mi>E</mi></msub><mo>+</mo><msub><mo>ℓ</mo><mi>R</mi></msub><mo>+</mo><msub><mo>ℓ</mo><mi>L</mi></msub><mo>+</mo><msub><mo>ℓ</mo><mi>I</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
\label{eq:full_loglik}
  \ell(\theta) = \ell_E + \ell_R + \ell_L + \ell_I,
\end{equation}</annotation></semantics></math> where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>ℓ</mo><mi>E</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>:</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">exact</mtext></mrow></munder><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">[</mo><mo>log</mo><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><msub><mi>h</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">]</mo><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>ℓ</mo><mi>R</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>:</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">right</mtext></mrow></munder><mo>log</mo><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>ℓ</mo><mi>L</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>:</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">left</mtext></mrow></munder><mo>log</mo><msubsup><mo>∫</mo><mn>0</mn><msub><mi>τ</mi><mi>i</mi></msub></msubsup><msub><mi>h</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>u</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msub><mo>ℓ</mo><mi>I</mi></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munder><mo>∑</mo><mrow><mi>i</mi><mo>:</mo><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mtext mathvariant="normal">interval</mtext></mrow></munder><mo>log</mo><msubsup><mo>∫</mo><msub><mi>a</mi><mi>i</mi></msub><msub><mi>b</mi><mi>i</mi></msub></msubsup><msub><mi>h</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>u</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>d</mi><mi>u</mi><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
  \ell_E &amp;= \sum_{i : \omega_i = \text{exact}}
    \bigl[\log R(t_i) + \log h_{c_i}(t_i)\bigr], \\
  \ell_R &amp;= \sum_{i : \omega_i = \text{right}} \log R(t_i), \\
  \ell_L &amp;= \sum_{i : \omega_i = \text{left}}
    \log \int_0^{\tau_i} h_{c_i}(u) R(u) \, du, \\
  \ell_I &amp;= \sum_{i : \omega_i = \text{interval}}
    \log \int_{a_i}^{b_i} h_{c_i}(u) R(u) \, du.
\end{align}</annotation></semantics></math></p>
<div class="section level4">
<h4 id="r-code-log-likelihood-evaluation">R code: Log-likelihood evaluation<a class="anchor" aria-label="anchor" href="#r-code-log-likelihood-evaluation"></a>
</h4>
<p>The <code><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik()</a></code> generic returns a closure that evaluates
this log-likelihood for any model:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ll_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">model_exp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate at true parameters on the mixed-censoring demo data</span></span>
<span><span class="va">ll_val</span> <span class="op">&lt;-</span> <span class="fu">ll_exp</span><span class="op">(</span><span class="va">df_demo</span>, <span class="va">theta_exp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Log-likelihood at true theta:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ll_val</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Log-likelihood at true theta: -345.3</span></span>
<span></span>
<span><span class="co"># Perturb parameters and compare</span></span>
<span><span class="va">theta_bad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Log-likelihood at wrong theta:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu">ll_exp</span><span class="op">(</span><span class="va">df_demo</span>, <span class="va">theta_bad</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Log-likelihood at wrong theta: -470.8</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="families">Distribution Families<a class="anchor" aria-label="anchor" href="#families"></a>
</h2>
<p>The C1–C2–C3 framework applies to <em>any</em> component lifetime
distribution. The following table lists common families with their
hazard, reliability, and pdf:</p>
<table class="table">
<colgroup>
<col width="19%">
<col width="26%">
<col width="26%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th>Family</th>
<th>Parameters</th>
<th><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_j(t)</annotation></semantics></math></th>
<th><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_j(t)</annotation></semantics></math></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Exponential</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\lambda_j</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\lambda_j</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>λ</mi><mi>j</mi></msub><mi>t</mi></mrow></msup><annotation encoding="application/x-tex">e^{-\lambda_j t}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Weibull</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>j</mi></msub><mo>,</mo><msub><mi>β</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">k_j, \beta_j</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>k</mi><mi>j</mi></msub><msub><mi>β</mi><mi>j</mi></msub></mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>β</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><msub><mi>k</mi><mi>j</mi></msub><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\frac{k_j}{\beta_j}\left(\frac{t}{\beta_j}\right)^{k_j-1}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>exp</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>β</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>k</mi><mi>j</mi></msub></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\exp\!\left(-\left(\frac{t}{\beta_j}\right)^{k_j}\right)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Pareto</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>j</mi></msub><mo>,</mo><msub><mi>x</mi><mrow><mi>m</mi><mo>,</mo><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_j, x_{m,j}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><msub><mi>α</mi><mi>j</mi></msub><mi>t</mi></mfrac><annotation encoding="application/x-tex">\frac{\alpha_j}{t}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>x</mi><mrow><mi>m</mi><mo>,</mo><mi>j</mi></mrow></msub><mi>t</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>α</mi><mi>j</mi></msub></msup><annotation encoding="application/x-tex">\left(\frac{x_{m,j}}{t}\right)^{\alpha_j}</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Log-normal</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mi>j</mi></msub><mo>,</mo><msub><mi>σ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\mu_j, \sigma_j</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>ϕ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>t</mi><msub><mi>σ</mi><mi>j</mi></msub><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><annotation encoding="application/x-tex">\frac{\phi(z_j)}{t\sigma_j \Phi(-z_j)}</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>z</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi(-z_j)</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>Gamma</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>j</mi></msub><mo>,</mo><msub><mi>β</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_j, \beta_j</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f_j(t)/R_j(t)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><mi>γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mi>j</mi></msub><mo>,</mo><mi>t</mi><mi>/</mi><msub><mi>β</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">1 - \frac{\gamma(\alpha_j, t/\beta_j)}{\Gamma(\alpha_j)}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>j</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mi>t</mi><mo>−</mo><msub><mi>μ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><msub><mi>σ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">z_j = (\log t - \mu_j)/\sigma_j</annotation></semantics></math>.
The package currently implements the first two families (Exponential and
Weibull). The framework extends to any family by substituting the
appropriate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>h</mi><mi>j</mi></msub><annotation encoding="application/x-tex">h_j</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>j</mi></msub><annotation encoding="application/x-tex">R_j</annotation></semantics></math>
into the general log-likelihood.</p>
</div>
<div class="section level2">
<h2 id="exponential">Worked Example: Exponential Components<a class="anchor" aria-label="anchor" href="#exponential"></a>
</h2>
<p>The exponential model is the simplest instantiation: all hazards are
constant, yielding closed-form expressions for every quantity.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.1</span>, <span class="fl">0.95</span>, <span class="fl">1.15</span>, <span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True rates:"</span>, <span class="va">theta</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; True rates: 1 1.1 0.95 1.15 1.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"System rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; System rate: 5.3</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="specializing-the-likelihood">Specializing the likelihood<a class="anchor" aria-label="anchor" href="#specializing-the-likelihood"></a>
</h3>
<p>For exponential components with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>λ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">h_j(t) = \lambda_j</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>λ</mi><mi>j</mi></msub><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">R_j(t) = e^{-\lambda_j t}</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Exact:</mtext><mspace width="1.0em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>log</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></munder><msub><mi>λ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>λ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Right:</mtext><mspace width="1.0em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>−</mo><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub><msub><mi>t</mi><mi>i</mi></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Left:</mtext><mspace width="1.0em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>log</mo><msub><mi>λ</mi><mi>c</mi></msub><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub><msub><mi>τ</mi><mi>i</mi></msub></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub><mo>,</mo></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Interval:</mtext><mspace width="1.0em"></mspace></mtd><mtd columnalign="left" style="text-align: left"><mo>log</mo><msub><mi>λ</mi><mi>c</mi></msub><mo>−</mo><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>b</mi><mi>i</mi></msub><mo>−</mo><msub><mi>a</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
\text{Exact:}     \quad &amp; \log\!\left(\sum_{j \in c_i} \lambda_j\right)
  - \left(\sum_{j=1}^m \lambda_j\right) t_i, \\
\text{Right:}     \quad &amp; -\lambda_{\text{sys}} t_i, \\
\text{Left:}      \quad &amp; \log \lambda_c + \log(1 - e^{-\lambda_{\text{sys}} \tau_i})
  - \log \lambda_{\text{sys}}, \\
\text{Interval:}  \quad &amp; \log \lambda_c - \lambda_{\text{sys}} a_i
  + \log(1 - e^{-\lambda_{\text{sys}}(b_i - a_i)}) - \log \lambda_{\text{sys}},
\end{align}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>c</mi></msub><mo>=</mo><msub><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>c</mi><mi>i</mi></msub></mrow></msub><msub><mi>λ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_c = \sum_{j \in c_i} \lambda_j</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mtext mathvariant="normal">sys</mtext></msub><mo>=</mo><msub><mo>∑</mo><mi>j</mi></msub><msub><mi>λ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_{\text{sys}} = \sum_j \lambda_j</annotation></semantics></math>.</p>
<p>All four observation types have <strong>closed-form</strong>
log-likelihood, score, <em>and</em> Hessian — the exponential model is
unique in this respect.</p>
</div>
<div class="section level3">
<h3 id="data-generation-and-fitting">Data generation and fitting<a class="anchor" aria-label="anchor" href="#data-generation-and-fitting"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">gen</span><span class="op">(</span><span class="va">theta</span>, n <span class="op">=</span> <span class="fl">2000</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>          observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observation types:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observation types:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; exact </span></span>
<span><span class="co">#&gt;  2000</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solver</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">theta0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="va">estimate</span> <span class="op">&lt;-</span> <span class="fu">solver</span><span class="op">(</span><span class="va">df</span>, par <span class="op">=</span> <span class="va">theta0</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recovery</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Component <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span>,</span>
<span>  True <span class="op">=</span> <span class="va">theta</span>,</span>
<span>  MLE <span class="op">=</span> <span class="va">estimate</span><span class="op">$</span><span class="va">par</span>,</span>
<span>  SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Rel_Error_Pct <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">theta</span><span class="op">)</span> <span class="op">/</span> <span class="va">theta</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">recovery</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Exponential MLE: parameter recovery"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Component"</span>, <span class="st">"True"</span>, <span class="st">"MLE"</span>, <span class="st">"SE"</span>, <span class="st">"Rel. Error %"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Exponential MLE: parameter recovery</caption>
<thead><tr class="header">
<th align="right">Component</th>
<th align="right">True</th>
<th align="right">MLE</th>
<th align="right">SE</th>
<th align="right">Rel. Error %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1.00</td>
<td align="right">0.9824</td>
<td align="right">0.0753</td>
<td align="right">-1.7590</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1.10</td>
<td align="right">0.9906</td>
<td align="right">0.0713</td>
<td align="right">-9.9493</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.95</td>
<td align="right">0.9429</td>
<td align="right">0.0721</td>
<td align="right">-0.7451</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1.15</td>
<td align="right">1.1041</td>
<td align="right">0.0760</td>
<td align="right">-3.9901</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1.10</td>
<td align="right">1.1903</td>
<td align="right">0.0789</td>
<td align="right">8.2058</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="score-and-hessian-verification">Score and Hessian verification<a class="anchor" aria-label="anchor" href="#score-and-hessian-verification"></a>
</h3>
<p>The analytical score should vanish at the MLE. We also verify it
against numerical differentiation:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ll_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/loglik.html" class="external-link">loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">scr_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/score.html" class="external-link">score</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">hess_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/hess_loglik.html" class="external-link">hess_loglik</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scr_at_mle</span> <span class="op">&lt;-</span> <span class="fu">scr_fn</span><span class="op">(</span><span class="va">df</span>, <span class="va">estimate</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Score at MLE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">scr_at_mle</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Score at MLE: -0.0494 0.1326 -0.0488 0.0388 0.1303</span></span>
<span></span>
<span><span class="va">scr_num</span> <span class="op">&lt;-</span> <span class="fu">numDeriv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">grad</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">th</span><span class="op">)</span> <span class="fu">ll_fn</span><span class="op">(</span><span class="va">df</span>, <span class="va">th</span><span class="op">)</span>, <span class="va">estimate</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Max |analytical - numerical| score:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/formatc.html" class="external-link">formatC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">scr_at_mle</span> <span class="op">-</span> <span class="va">scr_num</span><span class="op">)</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">"e"</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Max |analytical - numerical| score: 1.14e-06</span></span>
<span></span>
<span><span class="co"># Hessian eigenvalues (should all be negative for concavity)</span></span>
<span><span class="va">H</span> <span class="op">&lt;-</span> <span class="fu">hess_fn</span><span class="op">(</span><span class="va">df</span>, <span class="va">estimate</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hessian eigenvalues:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">H</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Hessian eigenvalues: -142.6 -153.3 -167.4 -174.5 -370.4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fisher-information-and-confidence-intervals">Fisher information and confidence intervals<a class="anchor" aria-label="anchor" href="#fisher-information-and-confidence-intervals"></a>
</h3>
<p>The observed Fisher information is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mi>H</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I(\hat\theta) = -H(\hat\theta)</annotation></semantics></math>.
Asymptotic
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1-\alpha)</annotation></semantics></math>%
Wald confidence intervals are:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><mo>±</mo><msub><mi>z</mi><mrow><mn>1</mn><mo>−</mo><mi>α</mi><mi>/</mi><mn>2</mn></mrow></msub><msqrt><mrow><mi>I</mi><msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>j</mi><mi>j</mi></mrow><mrow><mo>−</mo><mn>1</mn></mrow></msubsup></mrow></msqrt><mi>.</mi></mrow><annotation encoding="application/x-tex">
  \hat\theta_j \pm z_{1-\alpha/2} \sqrt{I(\hat\theta)^{-1}_{jj}}.
</annotation></semantics></math></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ci_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Component <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span>,</span>
<span>  Lower <span class="op">=</span> <span class="va">estimate</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">z</span> <span class="op">*</span> <span class="va">se</span>,</span>
<span>  MLE <span class="op">=</span> <span class="va">estimate</span><span class="op">$</span><span class="va">par</span>,</span>
<span>  Upper <span class="op">=</span> <span class="va">estimate</span><span class="op">$</span><span class="va">par</span> <span class="op">+</span> <span class="va">z</span> <span class="op">*</span> <span class="va">se</span>,</span>
<span>  True <span class="op">=</span> <span class="va">theta</span>,</span>
<span>  Covered <span class="op">=</span> <span class="op">(</span><span class="va">estimate</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">z</span> <span class="op">*</span> <span class="va">se</span> <span class="op">&lt;=</span> <span class="va">theta</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">theta</span> <span class="op">&lt;=</span> <span class="va">estimate</span><span class="op">$</span><span class="va">par</span> <span class="op">+</span> <span class="va">z</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">ci_df</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"95% Wald confidence intervals"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Comp."</span>, <span class="st">"Lower"</span>, <span class="st">"MLE"</span>, <span class="st">"Upper"</span>, <span class="st">"True"</span>, <span class="st">"Covered?"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>95% Wald confidence intervals</caption>
<thead><tr class="header">
<th align="right">Comp.</th>
<th align="right">Lower</th>
<th align="right">MLE</th>
<th align="right">Upper</th>
<th align="right">True</th>
<th align="left">Covered?</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.8348</td>
<td align="right">0.9824</td>
<td align="right">1.130</td>
<td align="right">1.00</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.8508</td>
<td align="right">0.9906</td>
<td align="right">1.130</td>
<td align="right">1.10</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.8016</td>
<td align="right">0.9429</td>
<td align="right">1.084</td>
<td align="right">0.95</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.9552</td>
<td align="right">1.1041</td>
<td align="right">1.253</td>
<td align="right">1.15</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1.0357</td>
<td align="right">1.1903</td>
<td align="right">1.345</td>
<td align="right">1.10</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="homogeneous-weibull">Homogeneous Weibull<a class="anchor" aria-label="anchor" href="#homogeneous-weibull"></a>
</h2>
<p>The <strong>homogeneous Weibull</strong> model constrains all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
components to share a common shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
while allowing individual scale parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>β</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">\beta_1, \ldots, \beta_m</annotation></semantics></math>.
The parameter vector is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>,</mo><msub><mi>β</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>β</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msubsup><mi>ℝ</mi><mrow><mo>&gt;</mo><mn>0</mn></mrow><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\theta = (k, \beta_1, \ldots, \beta_m) \in \mathbb{R}^{m+1}_{&gt; 0}</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="key-properties">Key properties<a class="anchor" aria-label="anchor" href="#key-properties"></a>
</h3>
<p><strong>Property 1: The system lifetime is Weibull.</strong> Because
all shapes are equal, the system reliability simplifies:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo>exp</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>β</mi><mi>j</mi></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mspace width="-0.167em"></mspace><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mi>t</mi><msub><mi>β</mi><mtext mathvariant="normal">sys</mtext></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
  R(t) = \prod_{j=1}^m \exp\!\left(-\left(\frac{t}{\beta_j}\right)^k\right)
       = \exp\!\left(-\left(\frac{t}{\beta_{\text{sys}}}\right)^k\right),
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mtext mathvariant="normal">sys</mtext></msub><mo>=</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><msubsup><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msubsup><mi>β</mi><mi>j</mi><mrow><mo>−</mo><mi>k</mi></mrow></msubsup><msup><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mi>k</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\beta_{\text{sys}} = \bigl(\sum_{j=1}^m \beta_j^{-k}\bigr)^{-1/k}</annotation></semantics></math>.
This closure under the minimum is the structural advantage of the
homogeneous model.</p>
<p><strong>Property 2: Constant cause probabilities.</strong> The time
dependence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>t</mi><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">t^{k-1}</annotation></semantics></math>
cancels in the hazard ratio:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>K</mi><mo>=</mo><mi>j</mi><mo>∣</mo><mi>T</mi><mo>=</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msubsup><mi>β</mi><mi>j</mi><mrow><mo>−</mo><mi>k</mi></mrow></msubsup><mrow><munder><mo>∑</mo><mi>l</mi></munder><msubsup><mi>β</mi><mi>l</mi><mrow><mo>−</mo><mi>k</mi></mrow></msubsup></mrow></mfrac><mo>≕</mo><msub><mi>w</mi><mi>j</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
  P(K = j \mid T = t) = \frac{\beta_j^{-k}}{\sum_l \beta_l^{-k}}
    \eqqcolon w_j.
</annotation></semantics></math> Just as in the exponential case, the
conditional cause probability does not depend on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<p><strong>Property 3: Closed-form censored contributions.</strong>
Left- and interval-censored terms factor as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>w</mi><msub><mi>c</mi><mi>i</mi></msub></msub><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">[</mo><mtext mathvariant="normal">Weibull CDF difference</mtext><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\log w_{c_i} + \log [\text{Weibull CDF difference}]</annotation></semantics></math>
— no numerical integration needed.</p>
</div>
<div class="section level3">
<h3 id="r-code-setup-and-hazard-visualization">R code: Setup and hazard visualization<a class="anchor" aria-label="anchor" href="#r-code-setup-and-hazard-visualization"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">1.5</span>, beta1 <span class="op">=</span> <span class="fl">100</span>, beta2 <span class="op">=</span> <span class="fl">150</span>, beta3 <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="va">theta_hom</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">scales</span> <span class="op">&lt;-</span> <span class="va">theta_hom</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">m_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">scales</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_homogeneous_md_c1_c2_c3.html">wei_series_homogeneous_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># System scale</span></span>
<span><span class="va">beta_sys</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_system_scale.html">wei_series_system_scale</a></span><span class="op">(</span><span class="va">k</span>, <span class="va">scales</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"System scale:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">beta_sys</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; System scale: 65.24</span></span>
<span></span>
<span><span class="co"># Plot component hazards</span></span>
<span><span class="va">t_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">200</span>, length.out <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"forestgreen"</span>, <span class="st">"firebrick"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NULL</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">200</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.06</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Hazard h_j(t)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Homogeneous Weibull: component hazards (k = 1.5)"</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">m_hom</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">h_j</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/component_hazard.html">component_hazard</a></span><span class="op">(</span><span class="va">model_hom</span>, <span class="va">j</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_grid</span>, <span class="fu">h_j</span><span class="op">(</span><span class="va">t_grid</span>, <span class="va">theta_hom</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Comp "</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m_hom</span>, <span class="st">" (beta="</span>, <span class="va">scales</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="va">cols</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="framework_files/figure-html/hom-setup-1.png" class="r-plt" width="672"></p>
<p>All hazards are increasing
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k &gt; 1</annotation></semantics></math>),
sharing the same shape but differing in magnitude. Component 1 (smallest
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>)
dominates at all times.</p>
</div>
<div class="section level3">
<h3 id="cause-probabilities">Cause probabilities<a class="anchor" aria-label="anchor" href="#cause-probabilities"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analytical cause weights</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">scales</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">k</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">scales</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="va">k</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Component "</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m_hom</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Time-invariant cause weights:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time-invariant cause weights:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">w</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Component 1 Component 2 Component 3 </span></span>
<span><span class="co">#&gt;      0.5269      0.2868      0.1863</span></span>
<span></span>
<span><span class="co"># Verify with package function (pass scales so model knows m)</span></span>
<span><span class="va">ccp_fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional_cause_probability.html">conditional_cause_probability</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/wei_series_homogeneous_md_c1_c2_c3.html">wei_series_homogeneous_md_c1_c2_c3</a></span><span class="op">(</span>scales <span class="op">=</span> <span class="va">scales</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu">ccp_fn</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>, <span class="va">theta_hom</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">probs</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"P(K=j | T=t) at four time points (should be constant)"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Comp "</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m_hom</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>P(K=j | T=t) at four time points (should be constant)</caption>
<thead><tr class="header">
<th align="right">Comp 1</th>
<th align="right">Comp 2</th>
<th align="right">Comp 3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.5269</td>
<td align="right">0.2868</td>
<td align="right">0.1863</td>
</tr>
<tr class="even">
<td align="right">0.5269</td>
<td align="right">0.2868</td>
<td align="right">0.1863</td>
</tr>
<tr class="odd">
<td align="right">0.5269</td>
<td align="right">0.2868</td>
<td align="right">0.1863</td>
</tr>
<tr class="even">
<td align="right">0.5269</td>
<td align="right">0.2868</td>
<td align="right">0.1863</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="data-generation-and-mle">Data generation and MLE<a class="anchor" aria-label="anchor" href="#data-generation-and-mle"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model_hom</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_hom</span> <span class="op">&lt;-</span> <span class="fu">gen_hom</span><span class="op">(</span><span class="va">theta_hom</span>, n <span class="op">=</span> <span class="fl">500</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                  observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_periodic.html">observe_periodic</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">20</span>, tau <span class="op">=</span> <span class="fl">250</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observation types:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observation types:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_hom</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; interval </span></span>
<span><span class="co">#&gt;      500</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solver_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model_hom</span><span class="op">)</span></span>
<span><span class="va">theta0_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">110</span>, <span class="fl">140</span>, <span class="fl">180</span><span class="op">)</span></span>
<span></span>
<span><span class="va">est_hom</span> <span class="op">&lt;-</span> <span class="fu">solver_hom</span><span class="op">(</span><span class="va">df_hom</span>, par <span class="op">=</span> <span class="va">theta0_hom</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">recovery_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"beta_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m_hom</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  True <span class="op">=</span> <span class="va">theta_hom</span>,</span>
<span>  MLE <span class="op">=</span> <span class="va">est_hom</span><span class="op">$</span><span class="va">par</span>,</span>
<span>  SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">est_hom</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Rel_Error_Pct <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">est_hom</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">theta_hom</span><span class="op">)</span> <span class="op">/</span> <span class="va">theta_hom</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">recovery_hom</span>, digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Homogeneous Weibull MLE (n = 500)"</span><span class="op">)</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parameter"</span>, <span class="st">"True"</span>, <span class="st">"MLE"</span>, <span class="st">"SE"</span>, <span class="st">"Rel. Error %"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Homogeneous Weibull MLE (n = 500)</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="left">Parameter</th>
<th align="right">True</th>
<th align="right">MLE</th>
<th align="right">SE</th>
<th align="right">Rel. Error %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">k</td>
<td align="left">k</td>
<td align="right">1.5</td>
<td align="right">1.48</td>
<td align="right">0.054</td>
<td align="right">-1.353</td>
</tr>
<tr class="even">
<td align="left">beta1</td>
<td align="left">beta_1</td>
<td align="right">100.0</td>
<td align="right">100.94</td>
<td align="right">4.629</td>
<td align="right">0.938</td>
</tr>
<tr class="odd">
<td align="left">beta2</td>
<td align="left">beta_2</td>
<td align="right">150.0</td>
<td align="right">149.80</td>
<td align="right">10.157</td>
<td align="right">-0.131</td>
</tr>
<tr class="even">
<td align="left">beta3</td>
<td align="left">beta_3</td>
<td align="right">200.0</td>
<td align="right">247.39</td>
<td align="right">27.542</td>
<td align="right">23.696</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="heterogeneous-weibull">Heterogeneous Weibull<a class="anchor" aria-label="anchor" href="#heterogeneous-weibull"></a>
</h2>
<p>The <strong>heterogeneous Weibull</strong> model allows each
component to have its own shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>j</mi></msub><annotation encoding="application/x-tex">k_j</annotation></semantics></math>
and scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math>,
giving a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">2m</annotation></semantics></math>-dimensional
parameter vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>β</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>k</mi><mi>m</mi></msub><mo>,</mo><msub><mi>β</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta = (k_1, \beta_1, \ldots, k_m, \beta_m)</annotation></semantics></math>.</p>
<div class="section level3">
<h3 id="differences-from-the-homogeneous-model">Differences from the homogeneous model<a class="anchor" aria-label="anchor" href="#differences-from-the-homogeneous-model"></a>
</h3>
<table class="table">
<colgroup>
<col width="26%">
<col width="34%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th>Property</th>
<th>Homogeneous</th>
<th>Heterogeneous</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Parameters</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m + 1</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>m</mi></mrow><annotation encoding="application/x-tex">2m</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>System lifetime</td>
<td>Weibull(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mtext mathvariant="normal">sys</mtext></msub><annotation encoding="application/x-tex">\beta_{\text{sys}}</annotation></semantics></math>)</td>
<td>
<strong>Not</strong> Weibull</td>
</tr>
<tr class="odd">
<td>Cause probabilities</td>
<td>Constant in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
</td>
<td>Time-varying</td>
</tr>
<tr class="even">
<td>Left/interval likelihood</td>
<td>Closed form</td>
<td>Numerical integration</td>
</tr>
</tbody>
</table>
<p>The additional flexibility comes at a cost: the system lifetime
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>=</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>T</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>T</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T = \min(T_1, \ldots, T_m)</annotation></semantics></math>
is no longer Weibull when shapes differ, and left-censored or
interval-censored likelihood contributions require numerical integration
(<code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">stats::integrate</a></code>).</p>
</div>
<div class="section level3">
<h3 id="r-code-mixed-failure-regimes">R code: Mixed failure regimes<a class="anchor" aria-label="anchor" href="#r-code-mixed-failure-regimes"></a>
</h3>
<p>We construct a 3-component system with DFR (infant mortality), CFR
(random), and IFR (wear-out) components:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">200</span>,   <span class="co"># DFR electronics</span></span>
<span>               <span class="fl">1.0</span>, <span class="fl">150</span>,   <span class="co"># CFR seals</span></span>
<span>               <span class="fl">2.0</span>, <span class="fl">100</span><span class="op">)</span>   <span class="co"># IFR bearing</span></span>
<span><span class="va">m_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta_het</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">model_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_md_c1_c2_c3.html">wei_series_md_c1_c2_c3</a></span><span class="op">(</span></span>
<span>  shapes <span class="op">=</span> <span class="va">theta_het</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  scales <span class="op">=</span> <span class="va">theta_het</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Component hazard functions</span></span>
<span><span class="va">t_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">120</span>, length.out <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span></span>
<span><span class="va">h_fns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m_het</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="fu"><a href="../reference/component_hazard.html">component_hazard</a></span><span class="op">(</span><span class="va">model_het</span>, <span class="va">j</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">h_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">h_fns</span>, <span class="kw">function</span><span class="op">(</span><span class="va">hf</span><span class="op">)</span> <span class="fu">hf</span><span class="op">(</span><span class="va">t_het</span>, <span class="va">theta_het</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t_het</span>, <span class="va">h_vals</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"Hazard h_j(t)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Heterogeneous Weibull: mixed failure regimes"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_het</span>, <span class="va">h_vals</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_het</span>, <span class="va">h_vals</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Comp 1: DFR (k=0.7)"</span>, <span class="st">"Comp 2: CFR (k=1.0)"</span>, <span class="st">"Comp 3: IFR (k=2.0)"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"forestgreen"</span>, <span class="st">"firebrick"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="framework_files/figure-html/het-setup-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="time-varying-cause-probabilities">Time-varying cause probabilities<a class="anchor" aria-label="anchor" href="#time-varying-cause-probabilities"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ccp_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/conditional_cause_probability.html">conditional_cause_probability</a></span><span class="op">(</span><span class="va">model_het</span><span class="op">)</span></span>
<span><span class="va">probs_het</span> <span class="op">&lt;-</span> <span class="fu">ccp_het</span><span class="op">(</span><span class="va">t_het</span>, <span class="va">theta_het</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t_het</span>, <span class="va">probs_het</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Time"</span>, ylab <span class="op">=</span> <span class="st">"P(K = j | T = t)"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Heterogeneous Weibull: time-varying cause probabilities"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_het</span>, <span class="va">probs_het</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t_het</span>, <span class="va">probs_het</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"right"</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DFR (k=0.7)"</span>, <span class="st">"CFR (k=1.0)"</span>, <span class="st">"IFR (k=2.0)"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"forestgreen"</span>, <span class="st">"firebrick"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">0.85</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="framework_files/figure-html/het-cause-prob-1.png" class="r-plt" width="672"></p>
<p>The crossover pattern is characteristic of bathtub-curve behavior at
the system level: early failures are dominated by infant-mortality
mechanisms, while late failures are dominated by wear-out.</p>
</div>
<div class="section level3">
<h3 id="data-generation-and-mle-1">Data generation and MLE<a class="anchor" aria-label="anchor" href="#data-generation-and-mle-1"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gen_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model_het</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7231</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_het</span> <span class="op">&lt;-</span> <span class="fu">gen_het</span><span class="op">(</span><span class="va">theta_het</span>, n <span class="op">=</span> <span class="fl">300</span>, tau <span class="op">=</span> <span class="fl">120</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                  observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">120</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observation types:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Observation types:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_het</span><span class="op">$</span><span class="va">omega</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; exact right </span></span>
<span><span class="co">#&gt;   286    14</span></span></code></pre></div>
<p>We use right-censoring for speed — exact and right-censored
observations have closed-form likelihood contributions. Left- and
interval-censored observations require numerical integration per
observation per optimization iteration.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">solver_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model_het</span><span class="op">)</span></span>
<span><span class="va">theta0_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">150</span><span class="op">)</span>, <span class="va">m_het</span><span class="op">)</span></span>
<span></span>
<span><span class="va">est_het</span> <span class="op">&lt;-</span> <span class="fu">solver_het</span><span class="op">(</span><span class="va">df_het</span>, par <span class="op">=</span> <span class="va">theta0_het</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">par_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="st">"beta"</span><span class="op">)</span>, <span class="va">m_het</span><span class="op">)</span>, <span class="st">"_"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m_het</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">recovery_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Parameter <span class="op">=</span> <span class="va">par_names</span>,</span>
<span>  True <span class="op">=</span> <span class="va">theta_het</span>,</span>
<span>  MLE <span class="op">=</span> <span class="va">est_het</span><span class="op">$</span><span class="va">par</span>,</span>
<span>  SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">est_het</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Rel_Error_Pct <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">est_het</span><span class="op">$</span><span class="va">par</span> <span class="op">-</span> <span class="va">theta_het</span><span class="op">)</span> <span class="op">/</span> <span class="va">theta_het</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">recovery_het</span>, digits <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Heterogeneous Weibull MLE (n = 300)"</span><span class="op">)</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parameter"</span>, <span class="st">"True"</span>, <span class="st">"MLE"</span>, <span class="st">"SE"</span>, <span class="st">"Rel. Error %"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Heterogeneous Weibull MLE (n = 300)</caption>
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="right">True</th>
<th align="right">MLE</th>
<th align="right">SE</th>
<th align="right">Rel. Error %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">k_1</td>
<td align="right">0.7</td>
<td align="right">0.744</td>
<td align="right">0.062</td>
<td align="right">6.233</td>
</tr>
<tr class="even">
<td align="left">beta_1</td>
<td align="right">200.0</td>
<td align="right">145.388</td>
<td align="right">19.797</td>
<td align="right">-27.306</td>
</tr>
<tr class="odd">
<td align="left">k_2</td>
<td align="right">1.0</td>
<td align="right">1.137</td>
<td align="right">0.126</td>
<td align="right">13.668</td>
</tr>
<tr class="even">
<td align="left">beta_2</td>
<td align="right">150.0</td>
<td align="right">150.563</td>
<td align="right">21.610</td>
<td align="right">0.376</td>
</tr>
<tr class="odd">
<td align="left">k_3</td>
<td align="right">2.0</td>
<td align="right">2.341</td>
<td align="right">0.220</td>
<td align="right">17.071</td>
</tr>
<tr class="even">
<td align="left">beta_3</td>
<td align="right">100.0</td>
<td align="right">102.378</td>
<td align="right">5.510</td>
<td align="right">2.378</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="model-comparison-heterogeneous-vs-homogeneous">Model comparison: heterogeneous vs homogeneous<a class="anchor" aria-label="anchor" href="#model-comparison-heterogeneous-vs-homogeneous"></a>
</h3>
<p>When the true DGP has heterogeneous shapes, the homogeneous model is
misspecified. We compare the two on the same data:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Refit on larger dataset for sharper comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span>
<span><span class="va">df_comp</span> <span class="op">&lt;-</span> <span class="fu">gen_het</span><span class="op">(</span><span class="va">theta_het</span>, n <span class="op">=</span> <span class="fl">800</span>, tau <span class="op">=</span> <span class="fl">150</span>, p <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                   observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">150</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Heterogeneous (6 params)</span></span>
<span><span class="va">fit_het</span> <span class="op">&lt;-</span> <span class="fu">solver_het</span><span class="op">(</span><span class="va">df_comp</span>, par <span class="op">=</span> <span class="va">theta0_het</span>, method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Homogeneous (4 params)</span></span>
<span><span class="va">model_hom2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_homogeneous_md_c1_c2_c3.html">wei_series_homogeneous_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">solver_hom2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model_hom2</span><span class="op">)</span></span>
<span><span class="va">fit_hom2</span> <span class="op">&lt;-</span> <span class="fu">solver_hom2</span><span class="op">(</span><span class="va">df_comp</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">150</span>, <span class="fl">150</span>, <span class="fl">150</span><span class="op">)</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Likelihood ratio test</span></span>
<span><span class="va">LRT</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">fit_het</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">fit_hom2</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span>
<span><span class="va">df_lrt</span> <span class="op">&lt;-</span> <span class="fl">6</span> <span class="op">-</span> <span class="fl">4</span></span>
<span><span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">LRT</span>, df <span class="op">=</span> <span class="va">df_lrt</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">comp_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Heterogeneous (2m = 6)"</span>, <span class="st">"Homogeneous (m+1 = 4)"</span><span class="op">)</span>,</span>
<span>  Params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  LogLik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_het</span><span class="op">$</span><span class="va">loglik</span>, <span class="va">fit_hom2</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span>,</span>
<span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">fit_het</span><span class="op">$</span><span class="va">loglik</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">6</span>, <span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">fit_hom2</span><span class="op">$</span><span class="va">loglik</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comp_df</span>, digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Model comparison"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Model"</span>, <span class="st">"# Params"</span>, <span class="st">"Log-Lik"</span>, <span class="st">"AIC"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Model comparison</caption>
<thead><tr class="header">
<th align="left">Model</th>
<th align="right"># Params</th>
<th align="right">Log-Lik</th>
<th align="right">AIC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Heterogeneous (2m = 6)</td>
<td align="right">6</td>
<td align="right">-4373</td>
<td align="right">8759</td>
</tr>
<tr class="even">
<td align="left">Homogeneous (m+1 = 4)</td>
<td align="right">4</td>
<td align="right">-4451</td>
<td align="right">8911</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"\nLRT statistic: %.2f (df = %d, p = %.4f)\n"</span>,</span>
<span>            <span class="va">LRT</span>, <span class="va">df_lrt</span>, <span class="va">p_val</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LRT statistic: 155.88 (df = 2, p = 0.0000)</span></span></code></pre></div>
<p>Both AIC and the likelihood ratio test favor the heterogeneous model
when the true DGP has unequal shapes. The common-shape estimate from the
homogeneous fit represents a compromise value between 0.7, 1.0, and 2.0,
leading to biased estimates of the scale parameters.</p>
</div>
</div>
<div class="section level2">
<h2 id="monte-carlo">Monte Carlo Assessment<a class="anchor" aria-label="anchor" href="#monte-carlo"></a>
</h2>
<p>We briefly assess finite-sample properties of the MLE for each model
family. Full Monte Carlo studies with sensitivity analyses are provided
in the dedicated vignettes (<code>exponential_series</code>,
<code>weibull_series</code>,
<code>weibull_homogeneous_series</code>).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span></span>
<span><span class="co"># Exponential: 5 components</span></span>
<span><span class="va">theta_mc_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.1</span>, <span class="fl">0.95</span>, <span class="fl">1.15</span>, <span class="fl">1.1</span><span class="op">)</span></span>
<span><span class="va">m_mc_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">theta_mc_exp</span><span class="op">)</span></span>
<span><span class="va">n_mc</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="va">model_mc_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/exp_series_md_c1_c2_c3.html">exp_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gen_mc_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model_mc_exp</span><span class="op">)</span></span>
<span><span class="va">solver_mc_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model_mc_exp</span><span class="op">)</span></span>
<span></span>
<span><span class="va">est_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">B</span>, <span class="va">m_mc_exp</span><span class="op">)</span></span>
<span><span class="va">conv_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df_b</span> <span class="op">&lt;-</span> <span class="fu">gen_mc_exp</span><span class="op">(</span><span class="va">theta_mc_exp</span>, n <span class="op">=</span> <span class="va">n_mc</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                     observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">fit_b</span> <span class="op">&lt;-</span> <span class="fu">solver_mc_exp</span><span class="op">(</span><span class="va">df_b</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">m_mc_exp</span><span class="op">)</span>,</span>
<span>                           method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span></span>
<span>    <span class="va">est_exp</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_b</span><span class="op">$</span><span class="va">par</span></span>
<span>    <span class="va">conv_exp</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_b</span><span class="op">$</span><span class="va">converged</span></span>
<span>  <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="va">conv_exp</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Homogeneous Weibull: 3 components</span></span>
<span><span class="va">theta_mc_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">100</span>, <span class="fl">150</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">m_mc_hom</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">model_mc_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_homogeneous_md_c1_c2_c3.html">wei_series_homogeneous_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gen_mc_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model_mc_hom</span><span class="op">)</span></span>
<span><span class="va">solver_mc_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model_mc_hom</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta_sys_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_system_scale.html">wei_series_system_scale</a></span><span class="op">(</span><span class="va">theta_mc_hom</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">theta_mc_hom</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">tau_mc_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">qweibull</a></span><span class="op">(</span><span class="fl">0.75</span>, shape <span class="op">=</span> <span class="va">theta_mc_hom</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, scale <span class="op">=</span> <span class="va">beta_sys_mc</span><span class="op">)</span></span>
<span></span>
<span><span class="va">est_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">B</span>, <span class="va">m_mc_hom</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">conv_hom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df_b</span> <span class="op">&lt;-</span> <span class="fu">gen_mc_hom</span><span class="op">(</span><span class="va">theta_mc_hom</span>, n <span class="op">=</span> <span class="va">n_mc</span>, p <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                     observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="va">tau_mc_hom</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">fit_b</span> <span class="op">&lt;-</span> <span class="fu">solver_mc_hom</span><span class="op">(</span><span class="va">df_b</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">120</span>, <span class="fl">120</span>, <span class="fl">120</span><span class="op">)</span>,</span>
<span>                           method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>,</span>
<span>                           lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1e-6</span>, <span class="va">m_mc_hom</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">est_hom</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_b</span><span class="op">$</span><span class="va">par</span></span>
<span>    <span class="va">conv_hom</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_b</span><span class="op">$</span><span class="va">converged</span></span>
<span>  <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="va">conv_hom</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Heterogeneous Weibull: 3 components</span></span>
<span><span class="va">theta_mc_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">150</span>, <span class="fl">1.5</span>, <span class="fl">120</span>, <span class="fl">2.0</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">m_mc_het</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">model_mc_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wei_series_md_c1_c2_c3.html">wei_series_md_c1_c2_c3</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gen_mc_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://queelius.github.io/likelihood.model/reference/rdata.html" class="external-link">rdata</a></span><span class="op">(</span><span class="va">model_mc_het</span><span class="op">)</span></span>
<span><span class="va">solver_mc_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">model_mc_het</span><span class="op">)</span></span>
<span></span>
<span><span class="va">est_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">B</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">m_mc_het</span><span class="op">)</span></span>
<span><span class="va">conv_het</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df_b</span> <span class="op">&lt;-</span> <span class="fu">gen_mc_het</span><span class="op">(</span><span class="va">theta_mc_het</span>, n <span class="op">=</span> <span class="va">n_mc</span>, tau <span class="op">=</span> <span class="fl">200</span>, p <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                     observe <span class="op">=</span> <span class="fu"><a href="../reference/observe_right_censor.html">observe_right_censor</a></span><span class="op">(</span>tau <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">fit_b</span> <span class="op">&lt;-</span> <span class="fu">solver_mc_het</span><span class="op">(</span><span class="va">df_b</span>, par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">130</span><span class="op">)</span>, <span class="va">m_mc_het</span><span class="op">)</span>,</span>
<span>                           method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>,</span>
<span>                           lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1e-6</span>, <span class="fl">2</span> <span class="op">*</span> <span class="va">m_mc_het</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">est_het</span><span class="op">[</span><span class="va">b</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_b</span><span class="op">$</span><span class="va">par</span></span>
<span>    <span class="va">conv_het</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fit_b</span><span class="op">$</span><span class="va">converged</span></span>
<span>  <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="va">conv_het</span><span class="op">[</span><span class="va">b</span><span class="op">]</span> <span class="op">&lt;&lt;-</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mc_summary</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">estimates</span>, <span class="va">converged</span>, <span class="va">theta</span>, <span class="va">par_names</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">valid</span> <span class="op">&lt;-</span> <span class="va">converged</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">ev</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[</span><span class="va">valid</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span>
<span>  <span class="va">bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">ev</span><span class="op">)</span> <span class="op">-</span> <span class="va">theta</span></span>
<span>  <span class="va">rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">bias</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">ev</span>, <span class="fl">2</span>, <span class="va">var</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Parameter <span class="op">=</span> <span class="va">par_names</span>,</span>
<span>    True <span class="op">=</span> <span class="va">theta</span>,</span>
<span>    Mean_Est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">ev</span><span class="op">)</span>,</span>
<span>    Bias <span class="op">=</span> <span class="va">bias</span>,</span>
<span>    RMSE <span class="op">=</span> <span class="va">rmse</span>,</span>
<span>    Rel_Bias_Pct <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">bias</span> <span class="op">/</span> <span class="va">theta</span>,</span>
<span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Exponential</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"=== Exponential ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; === Exponential ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Convergence:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">conv_exp</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Convergence: 0.99</span></span>
<span><span class="va">exp_table</span> <span class="op">&lt;-</span> <span class="fu">mc_summary</span><span class="op">(</span><span class="va">est_exp</span>, <span class="va">conv_exp</span>, <span class="va">theta_mc_exp</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"lambda_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m_mc_exp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">exp_table</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Exponential MC (B=100, n=1000)"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parameter"</span>, <span class="st">"True"</span>, <span class="st">"Mean Est."</span>, <span class="st">"Bias"</span>,</span>
<span>                          <span class="st">"RMSE"</span>, <span class="st">"Rel. Bias %"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Exponential MC (B=100, n=1000)</caption>
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="right">True</th>
<th align="right">Mean Est.</th>
<th align="right">Bias</th>
<th align="right">RMSE</th>
<th align="right">Rel. Bias %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">lambda_1</td>
<td align="right">1.00</td>
<td align="right">0.9906</td>
<td align="right">-0.0094</td>
<td align="right">0.0968</td>
<td align="right">-0.9366</td>
</tr>
<tr class="even">
<td align="left">lambda_2</td>
<td align="right">1.10</td>
<td align="right">1.1103</td>
<td align="right">0.0103</td>
<td align="right">0.1183</td>
<td align="right">0.9401</td>
</tr>
<tr class="odd">
<td align="left">lambda_3</td>
<td align="right">0.95</td>
<td align="right">0.9688</td>
<td align="right">0.0188</td>
<td align="right">0.1071</td>
<td align="right">1.9777</td>
</tr>
<tr class="even">
<td align="left">lambda_4</td>
<td align="right">1.15</td>
<td align="right">1.1424</td>
<td align="right">-0.0076</td>
<td align="right">0.1062</td>
<td align="right">-0.6650</td>
</tr>
<tr class="odd">
<td align="left">lambda_5</td>
<td align="right">1.10</td>
<td align="right">1.1039</td>
<td align="right">0.0039</td>
<td align="right">0.1065</td>
<td align="right">0.3550</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Homogeneous Weibull ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Homogeneous Weibull ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Convergence:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">conv_hom</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Convergence: 0.8</span></span>
<span><span class="va">hom_table</span> <span class="op">&lt;-</span> <span class="fu">mc_summary</span><span class="op">(</span><span class="va">est_hom</span>, <span class="va">conv_hom</span>, <span class="va">theta_mc_hom</span>,</span>
<span>                        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"beta_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">m_mc_hom</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">hom_table</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Homogeneous Weibull MC (B=100, n=1000)"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parameter"</span>, <span class="st">"True"</span>, <span class="st">"Mean Est."</span>, <span class="st">"Bias"</span>,</span>
<span>                          <span class="st">"RMSE"</span>, <span class="st">"Rel. Bias %"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Homogeneous Weibull MC (B=100, n=1000)</caption>
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="right">True</th>
<th align="right">Mean Est.</th>
<th align="right">Bias</th>
<th align="right">RMSE</th>
<th align="right">Rel. Bias %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">k</td>
<td align="right">1.5</td>
<td align="right">1.496</td>
<td align="right">-0.0036</td>
<td align="right">0.0507</td>
<td align="right">-0.2375</td>
</tr>
<tr class="even">
<td align="left">beta_1</td>
<td align="right">100.0</td>
<td align="right">100.242</td>
<td align="right">0.2423</td>
<td align="right">3.9623</td>
<td align="right">0.2423</td>
</tr>
<tr class="odd">
<td align="left">beta_2</td>
<td align="right">150.0</td>
<td align="right">151.721</td>
<td align="right">1.7208</td>
<td align="right">9.2254</td>
<td align="right">1.1472</td>
</tr>
<tr class="even">
<td align="left">beta_3</td>
<td align="right">200.0</td>
<td align="right">201.174</td>
<td align="right">1.1742</td>
<td align="right">17.2010</td>
<td align="right">0.5871</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n=== Heterogeneous Weibull ===\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; === Heterogeneous Weibull ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Convergence:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">conv_het</span><span class="op">)</span>, <span class="st">"\n\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Convergence: 0.78</span></span>
<span><span class="va">het_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"k"</span>, <span class="st">"beta"</span><span class="op">)</span>, <span class="va">m_mc_het</span><span class="op">)</span>, <span class="st">"_"</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m_mc_het</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">het_table</span> <span class="op">&lt;-</span> <span class="fu">mc_summary</span><span class="op">(</span><span class="va">est_het</span>, <span class="va">conv_het</span>, <span class="va">theta_mc_het</span>, <span class="va">het_names</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">het_table</span>, digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Heterogeneous Weibull MC (B=100, n=1000)"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Parameter"</span>, <span class="st">"True"</span>, <span class="st">"Mean Est."</span>, <span class="st">"Bias"</span>,</span>
<span>                          <span class="st">"RMSE"</span>, <span class="st">"Rel. Bias %"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Heterogeneous Weibull MC (B=100, n=1000)</caption>
<thead><tr class="header">
<th align="left">Parameter</th>
<th align="right">True</th>
<th align="right">Mean Est.</th>
<th align="right">Bias</th>
<th align="right">RMSE</th>
<th align="right">Rel. Bias %</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">k_1</td>
<td align="right">0.8</td>
<td align="right">0.8012</td>
<td align="right">0.0012</td>
<td align="right">0.0351</td>
<td align="right">0.1440</td>
</tr>
<tr class="even">
<td align="left">beta_1</td>
<td align="right">150.0</td>
<td align="right">148.7311</td>
<td align="right">-1.2689</td>
<td align="right">12.2943</td>
<td align="right">-0.8460</td>
</tr>
<tr class="odd">
<td align="left">k_2</td>
<td align="right">1.5</td>
<td align="right">1.5145</td>
<td align="right">0.0145</td>
<td align="right">0.0821</td>
<td align="right">0.9648</td>
</tr>
<tr class="even">
<td align="left">beta_2</td>
<td align="right">120.0</td>
<td align="right">120.9411</td>
<td align="right">0.9411</td>
<td align="right">6.0519</td>
<td align="right">0.7842</td>
</tr>
<tr class="odd">
<td align="left">k_3</td>
<td align="right">2.0</td>
<td align="right">1.9917</td>
<td align="right">-0.0083</td>
<td align="right">0.0936</td>
<td align="right">-0.4159</td>
</tr>
<tr class="even">
<td align="left">beta_3</td>
<td align="right">100.0</td>
<td align="right">100.1777</td>
<td align="right">0.1777</td>
<td align="right">3.2279</td>
<td align="right">0.1777</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="practical">Practical Considerations<a class="anchor" aria-label="anchor" href="#practical"></a>
</h2>
<p><strong>Starting values.</strong> For the exponential model, starting
at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_j = 1</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
generally works. For Weibull models, start with shapes near 1 (the
exponential case) and scales estimated from sample quantiles. An
exponential fit can provide good initial scale values via
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>β</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><msub><mover><mi>λ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\hat\beta_j = 1/\hat\lambda_j</annotation></semantics></math>.</p>
<p><strong>Identifiability.</strong> If two components are
<em>always</em> masked together (i.e., they appear in every candidate
set as a pair), their individual parameters are not identifiable — only
their sum (exponential) or combined contribution (Weibull) can be
estimated. This is a structural limitation of the observational design,
not the estimation method.</p>
<p><strong>Computational cost.</strong> The three models differ
substantially in computation time:</p>
<ul>
<li>
<strong>Exponential</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math>
per log-likelihood evaluation. All four observation types have
closed-form loglik, score, and Hessian.</li>
<li>
<strong>Homogeneous Weibull</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math>
for loglik (closed form for all types). Score uses
<code><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">numDeriv::grad</a></code> for left/interval observations.</li>
<li>
<strong>Heterogeneous Weibull</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mtext mathvariant="normal">exact</mtext></msub><mo>+</mo><msub><mi>n</mi><mtext mathvariant="normal">right</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n_{\text{exact}} + n_{\text{right}})</annotation></semantics></math>
for closed-form terms, plus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mtext mathvariant="normal">left</mtext></msub><mo>+</mo><msub><mi>n</mi><mtext mathvariant="normal">interval</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n_{\text{left}} + n_{\text{interval}})</annotation></semantics></math>
calls to <code><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">stats::integrate</a></code> for numerical integration
terms.</li>
</ul>
<p>For datasets with many left- or interval-censored observations under
the heterogeneous model, each optimization iteration involves hundreds
of numerical integrations. Strategies to manage this include using the
homogeneous model as a warm start, or extending the study period to
convert more observations to exact/right-censored.</p>
<p><strong>Bootstrap confidence intervals.</strong> As an alternative to
asymptotic Wald intervals (based on the observed Fisher information),
parametric bootstrap confidence intervals can be constructed by
repeatedly simulating from the fitted model and refitting. This is more
computationally expensive but avoids reliance on large-sample normality
approximations, which can be inaccurate when the sample size is small or
the likelihood surface is asymmetric.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Towell.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
