# likelihood.model.series.md

Maximum likelihood estimation for series system parameters from masked
component failure data. Supports exact, right-censored, left-censored,
and interval-censored observations with composable observation schemes.

## Installation

From [r-universe](https://queelius.r-universe.dev):

``` r
install.packages("likelihood.model.series.md",
                 repos = "https://queelius.r-universe.dev")
```

Or from GitHub:

``` r
# install.packages("devtools")
devtools::install_github("queelius/likelihood.model.series.md")
```

## Models

Three likelihood models, all using S3 generic dispatch:

| Model                                | Parameters              | Description                                                                                    |
|--------------------------------------|-------------------------|------------------------------------------------------------------------------------------------|
| `exp_series_md_c1_c2_c3`             | m rates: (λ₁, …, λₘ)    | Exponential components. Closed-form loglik, score, and Hessian for all four observation types. |
| `wei_series_homogeneous_md_c1_c2_c3` | m+1: (k, β₁, …, βₘ)     | Weibull with shared shape. Closed-form loglik; hybrid analytical/numerical score.              |
| `wei_series_md_c1_c2_c3`             | 2m: (k₁, β₁, …, kₘ, βₘ) | Weibull with per-component shapes. Numerical integration for left/interval types.              |

Each model implements S3 methods for:
[`loglik()`](https://queelius.github.io/likelihood.model/reference/loglik.html),
[`score()`](https://queelius.github.io/likelihood.model/reference/score.html),
[`hess_loglik()`](https://queelius.github.io/likelihood.model/reference/hess_loglik.html),
[`rdata()`](https://queelius.github.io/likelihood.model/reference/rdata.html),
[`assumptions()`](https://queelius.github.io/likelihood.model/reference/assumptions.html),
[`component_hazard()`](https://queelius.github.io/likelihood.model.series.md/reference/component_hazard.md),
[`cause_probability()`](https://queelius.github.io/likelihood.model.series.md/reference/cause_probability.md),
[`conditional_cause_probability()`](https://queelius.github.io/likelihood.model.series.md/reference/conditional_cause_probability.md),
[`ncomponents()`](https://queelius.github.io/likelihood.model.series.md/reference/ncomponents.md)

## Quick Start

``` r
library(likelihood.model.series.md)

# Create model and generate data
model <- exp_series_md_c1_c2_c3()
gen <- rdata(model)
df <- gen(theta = c(1.0, 1.1, 0.95), n = 500, tau = 3, p = 0.3)

# Fit via MLE
solver <- fit(model)
mle <- solver(df, par = c(1, 1, 1))
mle$theta.hat   # estimated rates
mle$sigma       # asymptotic standard errors

# Evaluate likelihood functions at the MLE
loglik(model)(df, par = mle$theta.hat)
score(model)(df, par = mle$theta.hat)
hess_loglik(model)(df, par = mle$theta.hat)
```

## Observation Types

The package supports four observation types via composable **observation
functors** that separate the observation mechanism from the
data-generating process:

| Type              | Column `omega` | Description                               |
|-------------------|----------------|-------------------------------------------|
| Exact             | `"exact"`      | Failure time observed precisely           |
| Right-censored    | `"right"`      | System survived past observation time     |
| Left-censored     | `"left"`       | System failed before inspection time      |
| Interval-censored | `"interval"`   | Failure occurred in window `[t, t_upper]` |

``` r
# Right-censoring at tau (default, backwards-compatible)
df <- gen(theta, n = 500, tau = 5, p = 0.3)

# Periodic inspection every 0.5 time units
df <- gen(theta, n = 500, p = 0.3,
          observe = observe_periodic(delta = 0.5, tau = 5))

# Mixed monitoring: 60% continuous, 20% single inspection, 20% periodic
df <- gen(theta, n = 500, p = 0.3,
          observe = observe_mixture(
            observe_right_censor(tau = 5),
            observe_left_censor(tau = 3),
            observe_periodic(delta = 0.5, tau = 5),
            weights = c(0.6, 0.2, 0.2)
          ))
```

## Masking Conditions

The candidate set models satisfy three conditions (C1, C2, C3) that
yield a reduced likelihood depending only on observed data:

- **C1**: The failed component is always in the candidate set
- **C2**: Candidate set probabilities are symmetric across components in
  the set
- **C3**: Masking probabilities are independent of system parameters

## Data Format

| Column            | Description                                                       |
|-------------------|-------------------------------------------------------------------|
| `t`               | System lifetime (observed)                                        |
| `omega`           | Observation type: `"exact"`, `"right"`, `"left"`, or `"interval"` |
| `t_upper`         | Upper bound for interval-censored observations (NA otherwise)     |
| `x1, x2, ..., xm` | Boolean candidate set indicators                                  |

For backwards compatibility, a `delta` column (TRUE/FALSE) is also
accepted in place of `omega` for exact/right-censored data.

## Vignettes

Four tutorial vignettes with worked examples and Monte Carlo studies:

``` r
vignette("exponential_series", package = "likelihood.model.series.md")
vignette("weibull_homogeneous_series", package = "likelihood.model.series.md")
vignette("weibull_series", package = "likelihood.model.series.md")
vignette("censoring_comparison", package = "likelihood.model.series.md")
```

Browse online at
<https://queelius.github.io/likelihood.model.series.md/articles/>.

## Related Packages

- [likelihood.model](https://github.com/queelius/likelihood.model) –
  generics for likelihood models (`loglik`, `score`, `fit`, etc.)
- [algebraic.mle](https://github.com/queelius/algebraic.mle) – MLE
  objects with inference methods
- [algebraic.dist](https://github.com/queelius/algebraic.dist) –
  distribution utilities
- [md.tools](https://github.com/queelius/md.tools) – masked data
  encoding/decoding

## License

GPL (\>= 3)

# Package index

## All functions

- [`Exponential series system`](https://queelius.github.io/likelihood.model.series.md/reference/Exponential-series-system.md)
  : Exponential series systems

- [`assumptions(`*`<exp_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/assumptions.exp_series_md_c1_c2_c3.md)
  :

  Assumptions for `exp_series_md_c1_c2_c3` model.

- [`assumptions(`*`<wei_series_homogeneous_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/assumptions.wei_series_homogeneous_md_c1_c2_c3.md)
  :

  Assumptions for `wei_series_homogeneous_md_c1_c2_c3` model.

- [`assumptions(`*`<wei_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/assumptions.wei_series_md_c1_c2_c3.md)
  :

  Assumptions for `wei_series_md_c1_c2_c3` model.

- [`cause_probability()`](https://queelius.github.io/likelihood.model.series.md/reference/cause_probability.md)
  : Marginal cause-of-failure probability

- [`component_hazard()`](https://queelius.github.io/likelihood.model.series.md/reference/component_hazard.md)
  : Component hazard function

- [`conditional_cause_probability()`](https://queelius.github.io/likelihood.model.series.md/reference/conditional_cause_probability.md)
  : Conditional cause-of-failure probability

- [`cum_haz()`](https://queelius.github.io/likelihood.model.series.md/reference/cum_haz.md)
  : Cumulative hazard function for a component hazard function

- [`dexp_series()`](https://queelius.github.io/likelihood.model.series.md/reference/dexp_series.md)
  : pdf for exponential series.

- [`exp_series_md_c1_c2_c3()`](https://queelius.github.io/likelihood.model.series.md/reference/exp_series_md_c1_c2_c3.md)
  :

  Constructs a likelihood model for `exp_series_md_c1_c2_c3`.

- [`hazard_exp_series()`](https://queelius.github.io/likelihood.model.series.md/reference/hazard_exp_series.md)
  : Hazard function for exponential series.

- [`hess_loglik(`*`<exp_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/hess_loglik.exp_series_md_c1_c2_c3.md)
  :

  Hessian of log-likelihood method for `exp_series_md_c1_c2_c3` model.

- [`hess_loglik(`*`<wei_series_homogeneous_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/hess_loglik.wei_series_homogeneous_md_c1_c2_c3.md)
  :

  Hessian of log-likelihood method for
  `wei_series_homogeneous_md_c1_c2_c3`.

- [`hess_loglik(`*`<wei_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/hess_loglik.wei_series_md_c1_c2_c3.md)
  :

  Hessian of log-likelihood method for `wei_series_md_c1_c2_c3` model.

- [`loglik(`*`<exp_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/loglik.exp_series_md_c1_c2_c3.md)
  :

  Log-likelihood method for `exp_series_md_c1_c2_c3` model.

- [`loglik(`*`<wei_series_homogeneous_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/loglik.wei_series_homogeneous_md_c1_c2_c3.md)
  :

  Log-likelihood method for `wei_series_homogeneous_md_c1_c2_c3` model.

- [`loglik(`*`<wei_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/loglik.wei_series_md_c1_c2_c3.md)
  :

  Log-likelihood method for `wei_series_md_c1_c2_c3` model.

- [`md_bernoulli_cand_c1_c2_c3()`](https://queelius.github.io/likelihood.model.series.md/reference/md_bernoulli_cand_c1_c2_c3.md)
  : Bernoulli candidate set model for systems with unobserved
  components.

- [`md_boolean_matrix_to_charsets()`](https://queelius.github.io/likelihood.model.series.md/reference/md_boolean_matrix_to_charsets.md)
  : Convert Boolean candidate set columns to character set notation

- [`md_cand_sampler()`](https://queelius.github.io/likelihood.model.series.md/reference/md_cand_sampler.md)
  : Sample candidate sets for systems with unobserved components.

- [`md_encode_matrix()`](https://queelius.github.io/likelihood.model.series.md/reference/md_encode_matrix.md)
  : Encode a matrix as a data frame with prefixed column names

- [`md_series_lifetime_right_censoring()`](https://queelius.github.io/likelihood.model.series.md/reference/md_series_lifetime_right_censoring.md)
  : Masked data generation for series system lifetime data

- [`mean(`*`<exp_series>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/mean.exp_series.md)
  : Mean function for exponential series.

- [`ncomponents()`](https://queelius.github.io/likelihood.model.series.md/reference/ncomponents.md)
  : Number of components in a series system model

- [`observe_left_censor()`](https://queelius.github.io/likelihood.model.series.md/reference/observe_left_censor.md)
  : Left-censoring observation scheme (single inspection)

- [`observe_mixture()`](https://queelius.github.io/likelihood.model.series.md/reference/observe_mixture.md)
  : Mixture of observation schemes

- [`observe_periodic()`](https://queelius.github.io/likelihood.model.series.md/reference/observe_periodic.md)
  : Periodic inspection observation scheme

- [`observe_right_censor()`](https://queelius.github.io/likelihood.model.series.md/reference/observe_right_censor.md)
  : Right-censoring observation scheme

- [`pexp_series()`](https://queelius.github.io/likelihood.model.series.md/reference/pexp_series.md)
  : Cumulative distribution function for exponential series.

- [`qcomp()`](https://queelius.github.io/likelihood.model.series.md/reference/qcomp.md)
  : Quantile function for a component with custom survival function

- [`qexp_series()`](https://queelius.github.io/likelihood.model.series.md/reference/qexp_series.md)
  : Quantile function for exponential series.

- [`rcomp()`](https://queelius.github.io/likelihood.model.series.md/reference/rcomp.md)
  : Random generation for a component with custom survival function

- [`rdata(`*`<exp_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/rdata.exp_series_md_c1_c2_c3.md)
  :

  Random data generation for `exp_series_md_c1_c2_c3` model.

- [`rdata(`*`<wei_series_homogeneous_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/rdata.wei_series_homogeneous_md_c1_c2_c3.md)
  :

  Random data generation for `wei_series_homogeneous_md_c1_c2_c3` model.

- [`rdata(`*`<wei_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/rdata.wei_series_md_c1_c2_c3.md)
  :

  Random data generation for `wei_series_md_c1_c2_c3` model.

- [`rexp_series()`](https://queelius.github.io/likelihood.model.series.md/reference/rexp_series.md)
  : Random number generation for exponential series.

- [`score(`*`<exp_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/score.exp_series_md_c1_c2_c3.md)
  :

  Score method for `exp_series_md_c1_c2_c3` model.

- [`score(`*`<wei_series_homogeneous_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/score.wei_series_homogeneous_md_c1_c2_c3.md)
  :

  Score method for `wei_series_homogeneous_md_c1_c2_c3` model.

- [`score(`*`<wei_series_md_c1_c2_c3>`*`)`](https://queelius.github.io/likelihood.model.series.md/reference/score.wei_series_md_c1_c2_c3.md)
  :

  Score method for `wei_series_md_c1_c2_c3` model.

- [`surv.exp_series()`](https://queelius.github.io/likelihood.model.series.md/reference/surv.exp_series.md)
  : Survival function for exponential series.

- [`wei_series_homogeneous_md_c1_c2_c3()`](https://queelius.github.io/likelihood.model.series.md/reference/wei_series_homogeneous_md_c1_c2_c3.md)
  :

  Constructs a likelihood model for
  `wei_series_homogeneous_md_c1_c2_c3`.

- [`wei_series_md_c1_c2_c3()`](https://queelius.github.io/likelihood.model.series.md/reference/wei_series_md_c1_c2_c3.md)
  :

  Constructs a likelihood model for `wei_series_md_c1_c2_c3`.

- [`wei_series_system_scale()`](https://queelius.github.io/likelihood.model.series.md/reference/wei_series_system_scale.md)
  : System scale parameter for homogeneous Weibull series

# Articles

### Tutorials

- [Masked Data Likelihood Model: Components with Exponentially
  Distributed Lifetimes Arranged In Series
  Configuration](https://queelius.github.io/likelihood.model.series.md/articles/exponential_series.md):
- [Homogeneous Weibull Series Systems: Shared Shape
  Parameter](https://queelius.github.io/likelihood.model.series.md/articles/weibull_homogeneous_series.md):
- [Heterogeneous Weibull Series Systems: Flexible Hazard
  Shapes](https://queelius.github.io/likelihood.model.series.md/articles/weibull_series.md):
- [Censoring Types in Series System Masked
  Data](https://queelius.github.io/likelihood.model.series.md/articles/censoring_comparison.md):
